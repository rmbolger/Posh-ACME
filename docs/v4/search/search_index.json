{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Posh-ACME","text":"<p>A PowerShell module and ACME client to create publicly trusted SSL/TLS certificates from an ACME capable certificate authority such as Let's Encrypt.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>Multi-domain (SAN) and wildcard (*.example.com) certificates supported</li> <li>IP Address certificates (RFC 8738) (Requires ACME CA support)</li> <li>All-in-one command for new certs, <code>New-PACertificate</code></li> <li>Easy renewals with <code>Submit-Renewal</code></li> <li>RSA and ECDSA keys supported for accounts and certificates</li> <li>Built-in validation plugins for DNS and HTTP based challenges. (pull requests welcome)</li> <li>Support for pre-created certificate requests (CSR)</li> <li>PEM and PFX output files</li> <li>No elevated Windows privileges required (unless using <code>-Install</code> switch)</li> <li>Cross platform PowerShell support. (FAQ)</li> <li>Account key rollover support</li> <li>OCSP Must-Staple support</li> <li>DNS challenge CNAME support</li> <li>Multiple ACME accounts supported per ACME CA</li> <li>External Account Binding support for ACME CAs that require it (Guide)</li> <li>Preferred Chain support to use alternative CA trust chains (Guide)</li> <li>PowerShell SecretManagement support (Guide)</li> <li>ARI (ACME Renewal Information) support based on draft 04.</li> </ul>"},{"location":"#installation-stable","title":"Installation (Stable)","text":"<p>The latest release can found in the PowerShell Gallery or the GitHub releases page. Installing is easiest from the gallery using <code>Install-Module</code>. See Installing PowerShellGet if you run into problems with it.</p> <pre><code># install for all users (requires elevated privs)\nInstall-Module -Name Posh-ACME -Scope AllUsers\n\n# install for current user\nInstall-Module -Name Posh-ACME -Scope CurrentUser\n</code></pre> <p>Warning</p> <p>If you use PowerShell 5.1 or earlier, <code>Install-Module</code> may throw an error depending on your Windows and .NET version due to a change PowerShell Gallery made to their TLS settings. For more info and a workaround, see the official blog post.</p>"},{"location":"#installation-development","title":"Installation (Development)","text":"<p>Use the following PowerShell command to install the latest development version from the git <code>main</code> branch. This method assumes a default <code>PSModulePath</code> environment variable and installs to the CurrentUser scope.</p> <pre><code>iex (irm https://raw.githubusercontent.com/rmbolger/Posh-ACME/main/instdev.ps1)\n</code></pre> <p>You can also download the source manually from GitHub and extract the <code>Posh-ACME</code> folder to your desired module location.</p>"},{"location":"#quick-start","title":"Quick Start","text":"<p>The minimum parameters you need for a cert are the domain name and the <code>-AcceptTOS</code> flag. This uses the default <code>Manual</code> DNS plugin which requires you to manually edit your DNS server to create the TXT records required for challenge validation.</p> <pre><code>New-PACertificate example.com -AcceptTOS\n</code></pre> <p>Warning</p> <p>On Windows, you may need to set a less restrictive PowerShell execution policy before you can import the module.</p> <pre><code>Set-ExecutionPolicy RemoteSigned -Scope CurrentUser -Force\nImport-Module Posh-ACME\n</code></pre> <p>Here's a more complete example with a typical wildcard cert utilizing a hypothetical <code>FakeDNS</code> DNS plugin that also adds a contact email address to the account for expiration notifications.</p> <pre><code>$certNames = '*.example.com','example.com'\n$email = 'admin@example.com'\n$pArgs = @{\n    FDToken = (Read-Host 'FakeDNS API Token' -AsSecureString)\n}\nNew-PACertificate $certNames -AcceptTOS -Contact $email -Plugin FakeDNS -PluginArgs $pArgs\n</code></pre> <p>To learn how to use a specific plugins, check out <code>Get-PAPlugin &lt;PluginName&gt; -Guide</code>. There's also a tutorial for a more in-depth guide to using the module.</p> <p>The output of <code>New-PACertificate</code> is an object that contains various properties about the certificate you generated. Only a subset of the properties are displayed by default. To see the full list including the filesystem paths to any certificate files that were generated, pipe the original output to <code>Format-List</code> or use <code>Get-PACertificate | Format-List</code>. You can also get the path to the server's config using <code>(Get-PAServer).Folder</code>.</p>"},{"location":"#requirements-and-platform-support","title":"Requirements and Platform Support","text":"<ul> <li>Supports Windows PowerShell 5.1 (Desktop edition) with .NET Framework 4.7.1 or later</li> <li>Supports PowerShell 6.2 or later (Core edition) on all supported OS platforms.</li> <li>Requires <code>FullLanguage</code> language mode</li> </ul> <p>Note</p> <p>PowerShell 6.0-6.1 should also work, but there are known issues when using <code>SecureString</code> or <code>PSCredential</code> plugin args on non-Windows platforms.</p>"},{"location":"#changelog","title":"Changelog","text":"<p>See CHANGELOG.md</p>"},{"location":"FAQ/","title":"Frequently Asked Questions (FAQ)","text":""},{"location":"FAQ/#where-is-my-config-where-is-my-cert","title":"Where is my config? Where is my cert?","text":"<p>Unless you have changed the default, all Posh-ACME config is in your user profile depending on the OS:</p> <ul> <li>Windows: <code>%LOCALAPPDATA%\\Posh-ACME</code></li> <li>Linux: <code>$HOME/.config/Posh-ACME</code></li> <li>MacOS: <code>$HOME/Library/Preferences/Posh-ACME</code></li> </ul> <p>The full paths to all cert files for the current order is in the detailed output of <code>Get-PACertificate</code>.</p> <pre><code>Get-PACertificate | Format-List\n</code></pre>"},{"location":"FAQ/#how-do-i-upgrade-from-3x-to-4x","title":"How Do I Upgrade From 3.x to 4.x?","text":"<p>If your certificate renewals are using <code>Submit-Renewal</code>, no changes should be necessary in order to upgrade from 3.x to 4.0 unless you were using the <code>-NewKey</code> parameter which has been removed. Orders can now be configured to always generate a new private key using <code>Set-PAOrder -AlwaysNewKey</code>. For example, you can set the flag for all orders in an account like this:</p> <pre><code>Get-PAOrder -List | Set-PAOrder -AlwaysNewKey\n</code></pre> <p>For custom scripts that use more of the module's functions be aware of the following changes:</p> <ul> <li><code>Invoke-HttpChallengeListener</code> is deprecated and may be removed in a future release. Users should migrate to the <code>WebSelfHost</code> plugin.</li> <li><code>Publish/Unpublish/Save-DnsChallenge</code> functions have been renamed to <code>Publish/Unpublish/Save-Challenge</code>.</li> <li>All references to the <code>DnsPlugin</code> parameter should be replaced with <code>Plugin</code>.</li> <li><code>NewKey</code> has been removed from <code>Submit-Renewal</code>.</li> <li><code>NewKey</code>/<code>NewCertKey</code> have been replaced by <code>AlwaysNewKey</code> in <code>New-PACertificate</code> and <code>New-PAOrder</code>.</li> <li><code>AlwaysNewKey</code> has been added to <code>Set-PAOrder</code>.</li> <li><code>DnsPlugin</code>, <code>PluginArgs</code>, <code>DnsAlias</code>, <code>DnsSleep</code>, <code>ValidationTimeout</code> and <code>Account</code> parameters have been removed from <code>Submit-ChallengeValidation</code>. The account associated with the order must be the currently active account. The rest of the parameters are read directly from the order object and can be modified in advance with <code>Set-PAOrder</code> if necessary.</li> <li>The <code>NoPrefix</code> switch in <code>Publish/Unpublish-Challenge</code> has been replaced with a <code>DnsAlias</code> parameter that will override the <code>Domain</code> parameter if specified. \"_acme-challenge.\" will not be automatically added to <code>DnsAlias</code> values. For example:</li> </ul> <pre><code># Old 3.x method to publish an alias\nPublish-DnsChallenge -Domain alias.example.com -NoPrefix -DnsPlugin MyPlugin -Account (Get-PAAccount) -Token xxxx -PluginArgs $pArgs\n\n# New 4.x method to publish an alias\nPublish-DnsChallenge -Domain example.com -DnsAlias alias.example.com -Plugin MyPlugin -Account (Get-PAAccount) -Token xxxx -PluginArgs $pArgs\n</code></pre> <p>If your workflow relied on new orders automatically using the plugin args from previously configured orders, that no longer works and you will have to explicitly set the <code>-PluginArgs</code> parameter for each new order. However, you can use <code>Get-PAPluginArgs</code> to make it easier. For example:</p> <pre><code># Old 3.x method where new order uses old plugin args automatically\nNew-PACertificate www1.example.com -Plugin MyPlugin -PluginArgs @{MyArg='xxxx'}\nNew-PACertificate www2.example.com -Plugin MyPlugin\n\n# New 4.x method\nNew-PACertificate www1.example.com -Plugin MyPlugin -PluginArgs @{MyArg='xxxx'}\n$pArgs = Get-PAPluginArgs www1.example.com\nNew-PACertificate www2.example.com -Plugin MyPlugin -PluginArgs $pArgs\n</code></pre>"},{"location":"FAQ/#how-have-plugins-changed-in-4x","title":"How have Plugins changed in 4.x?","text":"<p>See the Migrating DNS Plugins from 3x to 4x section of the plugin development guide.</p>"},{"location":"FAQ/#does-posh-acme-work-cross-platform-on-powershell-core","title":"Does Posh-ACME work cross platform on PowerShell Core?","text":"<p>Yes as of 2.2.0!...with a few caveats.</p> <p>The <code>-Install</code> parameter in <code>New-PACertificate</code> is not supported on non-Windows platforms and will throw an error if used because there's no certificate store equivalent to install to.</p> <p>On non-Windows OSes, <code>[securestring]</code> and <code>[pscredential]</code> plugins are not encrypted on disk by default because the encryption APIs used on Windows aren't available. However, you can enable AES based encryption that is also portable between OSes on a per-account level. This can be done during account creation or after the fact and you can switch between native and AES encryption at any time as in the following examples:</p> <pre><code># enable AES encryption during account creation\nNew-PAAccount -AcceptTOS -Contact me@example.com -UseAltPluginEncryption\n\n# enable AES encryption on an existing account\nSet-PAAccount -UseAltPluginEncryption\n\n# switch back to OS-native encryption on an existing account\nSet-PAAccount -UseAltPluginEncryption:$false\n</code></pre>"},{"location":"FAQ/#key-not-valid-for-use-in-specified-state","title":"Key not valid for use in specified state","text":"<p>This can happen on Windows if you try to copy the Posh-ACME profile folder to a different Windows computer or a different user's profile on the same computer. The underlying APIs used to encrypt plugin parameters using <code>SecureString</code> and <code>PSCredential</code> objects are tied to both the current computer and user and are not portable. However, you can use the <code>Set-PAAccount -UseAltPluginEncryption</code> to change the encryption used for the account to a portable AES based method and then copy the profile.</p>"},{"location":"FAQ/#export-pluginargs-access-is-denied","title":"Export-PluginArgs : Access is denied","text":"<p>This may happen on Windows if you're trying to run Posh-ACME over a remote or non-interactive session. By default, Posh-ACME encrypts \"secure\" plugin parameters before saving them to disk Windows' DPAPI subsystem. This has a known limitation that requires the current user's profile to be loaded which doesn't always happen in remote or non-interactive sessions.</p> <p>If you run into this problem, try running <code>Set-PAAccount -UseAltPluginEncryption</code> to use an alternative encryption option that doesn't rely on DPAPI.</p>"},{"location":"FAQ/#the-underlying-connection-was-closed-cloud-not-establish-trust-relationship-for-the-ssltls-secure-channel","title":"The underlying connection was closed: Cloud not establish trust relationship for the SSL/TLS secure channel.","text":"<p>This shouldn't ever happen when using a publicly trusted certificate authority such as Let's Encrypt. If it does, an attacker or malware might be trying to MitM your connection.</p> <p>However if you're doing development against a test ACME server like Pebble or a private instance of Boulder, this is normal because the server is likely using a self-signed certificate. You can work around the problem by adding the <code>-SkipCertificateCheck</code> parameter to <code>Set-PAServer</code>.</p> <p>If the error seems to originate from one of the plugins, submit an issue and we can figure it out.</p>"},{"location":"FAQ/#access-is-denied","title":"Access is denied","text":"<p>The most common reason this error shows up is that you used the <code>-Install</code> parameter with <code>New-PACertificate</code> and you're not running PowerShell as an elevated process (Run as Administrator). Both the original call to <code>New-PACertificate</code> and any subsequent calls to <code>Submit-Renewal</code> need to run elevated for the module to install the resulting certificate.</p>"},{"location":"FAQ/#refer-to-sub-problems-for-more-information","title":"Refer to sub-problems for more information.","text":"<p>This is generally part of a longer error message and most often shows up when you're trying to create a certificate with multiple names. It means that the error body has additional detail that can help identify what went wrong. You can access the sub-problem data from the Exception object like this.</p> <pre><code># If you haven't caught the error in a try/catch block, it should be in the first index in the error object\n$Error[0].Exception.Data.subproblems | Format-List\n\n# If you did catch the error, it will be in the $_ object\ncatch {\n    $_.Exception.Data.subproblems | Format-List\n}\n</code></pre>"},{"location":"Functions/Complete-PAOrder/","title":"Complete-PAOrder","text":""},{"location":"Functions/Complete-PAOrder/#synopsis","title":"Synopsis","text":"<p>Exports cert files for a completed order and adds suggested renewal window to the order.</p>"},{"location":"Functions/Complete-PAOrder/#syntax","title":"Syntax","text":"<pre><code>Complete-PAOrder [[-Order] &lt;Object&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Complete-PAOrder/#description","title":"Description","text":"<p>Once an ACME order is finalized, the signed certificate and chain can be downloaded and combined with the local private key to generate the supported PEM and PFX files on disk. This function will also calculate the renewal window based on the signed certificate's expiration date and update the order object with that info. If the Install flag is set, this function will attempt to import the certificate into the Windows certificate store.</p>"},{"location":"Functions/Complete-PAOrder/#examples","title":"Examples","text":""},{"location":"Functions/Complete-PAOrder/#example-1-complete-the-current-order","title":"Example 1: Complete the current order","text":"<pre><code>Complete-PAOrder\n</code></pre>"},{"location":"Functions/Complete-PAOrder/#example-2-complete-a-specific-order","title":"Example 2: Complete a specific order","text":"<pre><code>Get-PAOrder example.com | Complete-PAOrder\n</code></pre>"},{"location":"Functions/Complete-PAOrder/#parameters","title":"Parameters","text":""},{"location":"Functions/Complete-PAOrder/#-order","title":"-Order","text":"<p>The order object to complete which must be associated with the currently active ACME account.</p> <pre><code>Type: Object\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Complete-PAOrder/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Complete-PAOrder/#inputs","title":"Inputs","text":""},{"location":"Functions/Complete-PAOrder/#poshacmepaorder","title":"PoshACME.PAOrder","text":"<p>An order object as returned by Get-PAOrder.</p>"},{"location":"Functions/Complete-PAOrder/#outputs","title":"Outputs","text":""},{"location":"Functions/Complete-PAOrder/#poshacmepacertificate","title":"PoshACME.PACertificate","text":"<p>The certificate object for the order.</p>"},{"location":"Functions/Complete-PAOrder/#related-links","title":"Related Links","text":"<p>Get-PAOrder</p> <p>New-PAOrder</p>"},{"location":"Functions/Export-PAAccountKey/","title":"Export-PAAccountKey","text":""},{"location":"Functions/Export-PAAccountKey/#synopsis","title":"Synopsis","text":"<p>Export an ACME account private key.</p>"},{"location":"Functions/Export-PAAccountKey/#syntax","title":"Syntax","text":"<pre><code>Export-PAAccountKey [[-ID] &lt;String&gt;] -OutputFile &lt;String&gt; [-Force] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Export-PAAccountKey/#description","title":"Description","text":"<p>The account key is saved as an unencrypted Base64 encoded PEM file.</p>"},{"location":"Functions/Export-PAAccountKey/#examples","title":"Examples","text":""},{"location":"Functions/Export-PAAccountKey/#example-1-export-the-current-account-key","title":"Example 1: Export the current account key","text":"<pre><code>Export-PAAccountKey -OutputFile .\\mykey.pem\n</code></pre> <p>Exports the current ACME account's key to the specified file.</p>"},{"location":"Functions/Export-PAAccountKey/#example-2-export-the-specified-account-key","title":"Example 2: Export the specified account key","text":"<pre><code>Export-PAAccountKey 12345 -OutputFile .\\mykey.pem -Force\n</code></pre> <p>Exports the specified ACME account's key to the specified file and overwrites it if necessary.</p>"},{"location":"Functions/Export-PAAccountKey/#example-3-backup-account-keys-to-the-desktop","title":"Example 3: Backup account keys to the desktop","text":"<pre><code>$fldr = Join-Path ([Environment]::GetFolderPath('Desktop')) 'AcmeAccountKeys'\nNew-Item -ItemType Directory -Force -Path $fldr | Out-Null\nGet-PAAccount -List | %{\n    Export-PAAccountKey $_.ID -OutputFile \"$fldr\\$($_.ID).key\" -Force\n}\n</code></pre> <p>Backup all account keys for this ACME server to a folder on the desktop.</p>"},{"location":"Functions/Export-PAAccountKey/#parameters","title":"Parameters","text":""},{"location":"Functions/Export-PAAccountKey/#-id","title":"-ID","text":"<p>The ACME account ID value.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases: Name\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Export-PAAccountKey/#-outputfile","title":"-OutputFile","text":"<p>The path to the file to write the key data to.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Export-PAAccountKey/#-force","title":"-Force","text":"<p>If specified and the output file already exists, it will be overwritten. Without the switch, a confirmation prompt will be presented.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Export-PAAccountKey/#-whatif","title":"-WhatIf","text":"<p>Shows what would happen if the cmdlet runs. The cmdlet is not run.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: wi\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Export-PAAccountKey/#-confirm","title":"-Confirm","text":"<p>Prompts you for confirmation before running the cmdlet.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: cf\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Export-PAAccountKey/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Export-PAAccountKey/#related-links","title":"Related Links","text":"<p>Get-PAAccount</p>"},{"location":"Functions/Get-KeyAuthorization/","title":"Get-KeyAuthorization","text":""},{"location":"Functions/Get-KeyAuthorization/#synopsis","title":"Synopsis","text":"<p>Calculate a key authorization string for a challenge token.</p>"},{"location":"Functions/Get-KeyAuthorization/#syntax","title":"Syntax","text":"<pre><code>Get-KeyAuthorization [-Token] &lt;String&gt; [[-Account] &lt;Object&gt;] [-ForDNS] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-KeyAuthorization/#description","title":"Description","text":"<p>A key authorization is a string that expresses a domain holder's authorization for a specified key to satisfy a specified challenge, by concatenating the token for the challenge with a key fingerprint.</p>"},{"location":"Functions/Get-KeyAuthorization/#examples","title":"Examples","text":""},{"location":"Functions/Get-KeyAuthorization/#example-1-specific-key-auth","title":"Example 1: Specific Key Auth","text":"<pre><code>Get-KeyAuthorization 'XxXxXxXxXxXx'\n</code></pre> <p>Get the key authorization for the specified token using the current account.</p>"},{"location":"Functions/Get-KeyAuthorization/#example-2-dns-key-auths-for-current-order","title":"Example 2: DNS Key Auths for current order","text":"<pre><code>(Get-PAOrder | Get-PAAuthorization).DNS01Token | Get-KeyAuthorization -ForDNS\n</code></pre> <p>Get all key authorizations for the DNS challenges in the current order using the current account.</p>"},{"location":"Functions/Get-KeyAuthorization/#parameters","title":"Parameters","text":""},{"location":"Functions/Get-KeyAuthorization/#-token","title":"-Token","text":"<p>The token string for an ACME challenge.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: True\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-KeyAuthorization/#-account","title":"-Account","text":"<p>The ACME account associated with the challenge.</p> <pre><code>Type: Object\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 2\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-KeyAuthorization/#-fordns","title":"-ForDNS","text":"<p>Enable this switch if you're using the key authorization value for the 'dns-01' challenge type. It will do a few additional manipulation steps on the value that are required for a DNS TXT record.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-KeyAuthorization/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Get-KeyAuthorization/#inputs","title":"Inputs","text":""},{"location":"Functions/Get-KeyAuthorization/#systemstring","title":"System.String","text":"<p>The token value from an ACME challenge object.</p>"},{"location":"Functions/Get-KeyAuthorization/#outputs","title":"Outputs","text":""},{"location":"Functions/Get-KeyAuthorization/#systemstring_1","title":"System.String","text":"<p>The key authorization value.</p>"},{"location":"Functions/Get-KeyAuthorization/#related-links","title":"Related Links","text":"<p>Get-PAAuthorization</p> <p>Submit-ChallengeValidation</p>"},{"location":"Functions/Get-PAAccount/","title":"Get-PAAccount","text":""},{"location":"Functions/Get-PAAccount/#synopsis","title":"Synopsis","text":"<p>Get ACME account details.</p>"},{"location":"Functions/Get-PAAccount/#syntax","title":"Syntax","text":""},{"location":"Functions/Get-PAAccount/#specific","title":"Specific","text":"<pre><code>Get-PAAccount [[-ID] &lt;String&gt;] [-Refresh] [-ExtraParams &lt;Object&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-PAAccount/#list","title":"List","text":"<pre><code>Get-PAAccount [-List] [-Status &lt;String&gt;] [-Contact &lt;String[]&gt;] [-KeyLength &lt;String[]&gt;] [-Refresh]\n [-ExtraParams &lt;Object&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-PAAccount/#description","title":"Description","text":"<p>Returns details such as Email, key length, and status for one or more ACME accounts previously created.</p>"},{"location":"Functions/Get-PAAccount/#examples","title":"Examples","text":""},{"location":"Functions/Get-PAAccount/#example-1-current-account","title":"Example 1: Current Account","text":"<pre><code>Get-PAAccount\n</code></pre> <p>Get cached ACME account details for the currently selected account.</p>"},{"location":"Functions/Get-PAAccount/#example-2-specific-account","title":"Example 2: Specific Account","text":"<pre><code>Get-PAAccount -ID 1234567\n</code></pre> <p>Get cached ACME account details for the specified account ID.</p>"},{"location":"Functions/Get-PAAccount/#example-3-all-accounts","title":"Example 3: All Accounts","text":"<pre><code>Get-PAAccount -List\n</code></pre> <p>Get all cached ACME account details.</p>"},{"location":"Functions/Get-PAAccount/#example-4-filter-on-contact","title":"Example 4: Filter on Contact","text":"<pre><code>Get-PAAccount -List -Contact 'user1@example.com'\n</code></pre> <p>Get cached ACME account details for all accounts that have user1@example.com as the only contact.</p>"},{"location":"Functions/Get-PAAccount/#parameters","title":"Parameters","text":""},{"location":"Functions/Get-PAAccount/#-id","title":"-ID","text":"<p>The account id value as returned by the ACME server. 'Name' is also an alias for this parameter.</p> <pre><code>Type: String\nParameter Sets: Specific\nAliases: Name\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAAccount/#-list","title":"-List","text":"<p>If specified, the details for all accounts will be returned.</p> <pre><code>Type: SwitchParameter\nParameter Sets: List\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAAccount/#-status","title":"-Status","text":"<p>A Status string to filter the list of accounts with.</p> <pre><code>Type: String\nParameter Sets: List\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAAccount/#-contact","title":"-Contact","text":"<p>One or more email addresses to filter the list of accounts with. Returned accounts must match exactly (not including the order).</p> <pre><code>Type: String[]\nParameter Sets: List\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAAccount/#-keylength","title":"-KeyLength","text":"<p>The type and size of private key to filter the list of accounts with. For RSA keys, specify a number between 2048-4096 (divisible by 128). For ECC keys, specify either 'ec-256' or 'ec-384'.</p> <pre><code>Type: String[]\nParameter Sets: List\nAliases: AccountKeyLength\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAAccount/#-refresh","title":"-Refresh","text":"<p>If specified, any account details returned will be freshly queried from the ACME server (excluding deactivated accounts). Otherwise, cached details will be returned.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAAccount/#-extraparams","title":"-ExtraParams","text":"<p>This parameter can be ignored and is only used to prevent errors when splatting with more parameters than this function supports.</p> <pre><code>Type: Object\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAAccount/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Get-PAAccount/#outputs","title":"Outputs","text":""},{"location":"Functions/Get-PAAccount/#poshacmepaaccount","title":"PoshACME.PAAccount","text":"<p>An account object.</p>"},{"location":"Functions/Get-PAAccount/#related-links","title":"Related Links","text":"<p>Set-PAAccount</p> <p>New-PAAccount</p>"},{"location":"Functions/Get-PAAuthorization/","title":"Get-PAAuthorization","text":""},{"location":"Functions/Get-PAAuthorization/#synopsis","title":"Synopsis","text":"<p>Get the authorizations associated with a particular order or set of authorization URLs.</p>"},{"location":"Functions/Get-PAAuthorization/#syntax","title":"Syntax","text":"<pre><code>Get-PAAuthorization [-AuthURLs] &lt;String[]&gt; [[-Account] &lt;Object&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-PAAuthorization/#description","title":"Description","text":"<p>Returns details such as fqdn, status, expiration, and challenges for one or more ACME authorizations.</p>"},{"location":"Functions/Get-PAAuthorization/#examples","title":"Examples","text":""},{"location":"Functions/Get-PAAuthorization/#example-1-specific-authorization","title":"Example 1: Specific Authorization","text":"<pre><code>Get-PAAuthorization https://acme.example.com/authz/1234567\n</code></pre> <p>Get the authorization for the specified URL.</p>"},{"location":"Functions/Get-PAAuthorization/#example-2-order-authorizations","title":"Example 2: Order Authorizations","text":"<pre><code>Get-PAOrder | Get-PAAuthorization\n</code></pre> <p>Get the authorizations for the current order on the current account.</p>"},{"location":"Functions/Get-PAAuthorization/#parameters","title":"Parameters","text":""},{"location":"Functions/Get-PAAuthorization/#-authurls","title":"-AuthURLs","text":"<p>One or more authorization URLs. You also pipe in one or more PoshACME.PAOrder objects.</p> <pre><code>Type: String[]\nParameter Sets: (All)\nAliases: authorizations\n\nRequired: True\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAAuthorization/#-account","title":"-Account","text":"<p>An existing ACME account object such as the output from Get-PAAccount. If no account is specified, the current account will be used.</p> <pre><code>Type: Object\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 2\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAAuthorization/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Get-PAAuthorization/#inputs","title":"Inputs","text":""},{"location":"Functions/Get-PAAuthorization/#systemstring","title":"System.String","text":"<p>The URI of the authorization object.</p>"},{"location":"Functions/Get-PAAuthorization/#outputs","title":"Outputs","text":""},{"location":"Functions/Get-PAAuthorization/#poshacmepaauthorization","title":"PoshACME.PAAuthorization","text":"<p>An authorization object.</p>"},{"location":"Functions/Get-PAAuthorization/#related-links","title":"Related Links","text":"<p>Get-PAOrder</p> <p>New-PAOrder</p>"},{"location":"Functions/Get-PACertificate/","title":"Get-PACertificate","text":""},{"location":"Functions/Get-PACertificate/#synopsis","title":"Synopsis","text":"<p>Get ACME certificate details.</p>"},{"location":"Functions/Get-PACertificate/#syntax","title":"Syntax","text":""},{"location":"Functions/Get-PACertificate/#specific","title":"Specific","text":"<pre><code>Get-PACertificate [[-MainDomain] &lt;String&gt;] [-Name &lt;String&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-PACertificate/#list","title":"List","text":"<pre><code>Get-PACertificate [-List] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-PACertificate/#description","title":"Description","text":"<p>Returns details such as Thumbprint, Subject, Validity, SANs, and file locations for one or more ACME certificates previously created.</p>"},{"location":"Functions/Get-PACertificate/#examples","title":"Examples","text":""},{"location":"Functions/Get-PACertificate/#example-1-current-certificate","title":"Example 1: Current Certificate","text":"<pre><code>Get-PACertificate\n</code></pre> <p>Get cached ACME order details for the currently selected order.</p>"},{"location":"Functions/Get-PACertificate/#example-2-specific-certificate","title":"Example 2: Specific Certificate","text":"<pre><code>Get-PACertificate example.com\n</code></pre> <p>Get cached ACME order details for the specified domain.</p>"},{"location":"Functions/Get-PACertificate/#example-3-all-certificates","title":"Example 3: All Certificates","text":"<pre><code>Get-PACertificate -List\n</code></pre> <p>Get all cached ACME order details.</p>"},{"location":"Functions/Get-PACertificate/#parameters","title":"Parameters","text":""},{"location":"Functions/Get-PACertificate/#-maindomain","title":"-MainDomain","text":"<p>The primary domain associated with the certificate. This is the domain that goes in the certificate's subject.</p> <pre><code>Type: String\nParameter Sets: Specific\nAliases:\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PACertificate/#-name","title":"-Name","text":"<p>The name of the ACME order. This can be useful to distinguish between two orders that have the same MainDomain.</p> <pre><code>Type: String\nParameter Sets: Specific\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PACertificate/#-list","title":"-List","text":"<p>If specified, the details for all completed certificates will be returned for the current account.</p> <pre><code>Type: SwitchParameter\nParameter Sets: List\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PACertificate/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Get-PACertificate/#outputs","title":"Outputs","text":""},{"location":"Functions/Get-PACertificate/#poshacmepacertificate","title":"PoshACME.PACertificate","text":"<p>A certificate object.</p>"},{"location":"Functions/Get-PACertificate/#related-links","title":"Related Links","text":"<p>New-PACertificate</p>"},{"location":"Functions/Get-PAOrder/","title":"Get-PAOrder","text":""},{"location":"Functions/Get-PAOrder/#synopsis","title":"Synopsis","text":"<p>Get ACME order details.</p>"},{"location":"Functions/Get-PAOrder/#syntax","title":"Syntax","text":""},{"location":"Functions/Get-PAOrder/#specific","title":"Specific","text":"<pre><code>Get-PAOrder [[-MainDomain] &lt;String&gt;] [-Name &lt;String&gt;] [-Refresh] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-PAOrder/#list","title":"List","text":"<pre><code>Get-PAOrder [-List] [-Refresh] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-PAOrder/#description","title":"Description","text":"<p>Returns details such as Domains, key length, expiration, and status for one or more ACME orders previously created.</p>"},{"location":"Functions/Get-PAOrder/#examples","title":"Examples","text":""},{"location":"Functions/Get-PAOrder/#example-1-current-order","title":"Example 1: Current Order","text":"<pre><code>Get-PAOrder\n</code></pre> <p>Get cached ACME order details for the currently selected order.</p>"},{"location":"Functions/Get-PAOrder/#example-2-specific-order","title":"Example 2: Specific Order","text":"<pre><code>Get-PAOrder example.com\n</code></pre> <p>Get cached ACME order details for the specified domain.</p>"},{"location":"Functions/Get-PAOrder/#example-3-all-orders","title":"Example 3: All Orders","text":"<pre><code>Get-PAOrder -List\n</code></pre> <p>Get all cached ACME order details.</p>"},{"location":"Functions/Get-PAOrder/#example-4-refresh-order-status","title":"Example 4: Refresh Order Status","text":"<pre><code>Get-PAOrder -Refresh\n</code></pre> <p>Get fresh ACME order details for the currently selected order.</p>"},{"location":"Functions/Get-PAOrder/#parameters","title":"Parameters","text":""},{"location":"Functions/Get-PAOrder/#-maindomain","title":"-MainDomain","text":"<p>The primary domain associated with the order. This is the domain that goes in the certificate's subject.</p> <pre><code>Type: String\nParameter Sets: Specific\nAliases:\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAOrder/#-name","title":"-Name","text":"<p>The name of the ACME order. This can be useful to distinguish between two orders that have the same MainDomain.</p> <pre><code>Type: String\nParameter Sets: Specific\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAOrder/#-list","title":"-List","text":"<p>If specified, the details for all orders will be returned.</p> <pre><code>Type: SwitchParameter\nParameter Sets: List\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAOrder/#-refresh","title":"-Refresh","text":"<p>If specified, any order details returned will be freshly queried from the ACME server. Otherwise, cached details will be returned.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAOrder/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Get-PAOrder/#outputs","title":"Outputs","text":""},{"location":"Functions/Get-PAOrder/#poshacmepaorder","title":"PoshACME.PAOrder","text":"<p>An order object.</p>"},{"location":"Functions/Get-PAOrder/#related-links","title":"Related Links","text":"<p>Set-PAOrder</p> <p>New-PAOrder</p>"},{"location":"Functions/Get-PAPlugin/","title":"Get-PAPlugin","text":""},{"location":"Functions/Get-PAPlugin/#synopsis","title":"Synopsis","text":"<p>Show plugin details, help, or launch the online guide.</p>"},{"location":"Functions/Get-PAPlugin/#syntax","title":"Syntax","text":""},{"location":"Functions/Get-PAPlugin/#basic-default","title":"Basic (Default)","text":"<pre><code>Get-PAPlugin [[-Plugin] &lt;String&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-PAPlugin/#params","title":"Params","text":"<pre><code>Get-PAPlugin [-Plugin] &lt;String&gt; [-Params] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-PAPlugin/#guide","title":"Guide","text":"<pre><code>Get-PAPlugin [-Plugin] &lt;String&gt; [-Guide] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-PAPlugin/#help","title":"Help","text":"<pre><code>Get-PAPlugin [-Plugin] &lt;String&gt; [-Help] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-PAPlugin/#description","title":"Description","text":"<p>With no parameters, this function will return a list of built-in validation plugins and their details.</p> <p>With a Plugin specified, this function will return that plugin's details, help, or launch the online guide depending on which switches are specified.</p>"},{"location":"Functions/Get-PAPlugin/#examples","title":"Examples","text":""},{"location":"Functions/Get-PAPlugin/#example-1-list-plugins","title":"Example 1: List Plugins","text":"<pre><code>Get-PAPlugin\n</code></pre> <p>Get the list of available validation plugins</p>"},{"location":"Functions/Get-PAPlugin/#example-2-show-plugin-parameter-sets","title":"Example 2: Show Plugin Parameter Sets","text":"<pre><code>Get-PAPlugin Route53 -Params\n</code></pre> <p>Launch the user's default web browser to the online guide for the specified plugin.</p>"},{"location":"Functions/Get-PAPlugin/#example-3-open-plugin-guide","title":"Example 3: Open Plugin Guide","text":"<pre><code>Get-PAPlugin Route53 -Guide\n</code></pre> <p>Launch the user's default web browser to the online guide for the specified plugin.</p>"},{"location":"Functions/Get-PAPlugin/#parameters","title":"Parameters","text":""},{"location":"Functions/Get-PAPlugin/#-plugin","title":"-Plugin","text":"<p>The name of a validation plugin.</p> <pre><code>Type: String\nParameter Sets: Basic\nAliases:\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre> <pre><code>Type: String\nParameter Sets: Params, Guide, Help\nAliases:\n\nRequired: True\nPosition: 1\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAPlugin/#-help","title":"-Help","text":"<p>If specified, display the help contents for the specified plugin.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Help\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAPlugin/#-guide","title":"-Guide","text":"<p>If specified, launch the default web browser to the specified plugin's online guide. This currently only works on Windows and will simply display the URL on other OSes.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Guide\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAPlugin/#-params","title":"-Params","text":"<p>If specified, returns the plugin-specific parameter sets associated with this plugin.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Params\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAPlugin/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Get-PAPlugin/#related-links","title":"Related Links","text":"<p>New-PACertificate</p> <p>Publish-Challenge</p>"},{"location":"Functions/Get-PAPluginArgs/","title":"Get-PAPluginArgs","text":""},{"location":"Functions/Get-PAPluginArgs/#synopsis","title":"Synopsis","text":"<p>Retrieve the plugin args for the current or specified order.</p>"},{"location":"Functions/Get-PAPluginArgs/#syntax","title":"Syntax","text":"<pre><code>Get-PAPluginArgs [[-MainDomain] &lt;String&gt;] [-Name &lt;String&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-PAPluginArgs/#description","title":"Description","text":"<p>An easy way to recall the plugin args used for a given order.</p>"},{"location":"Functions/Get-PAPluginArgs/#examples","title":"Examples","text":""},{"location":"Functions/Get-PAPluginArgs/#example-1-current-order-args","title":"Example 1: Current Order Args","text":"<pre><code>Get-PAPluginArgs\n</code></pre> <p>Retrieve the plugin args for the current order.</p>"},{"location":"Functions/Get-PAPluginArgs/#example-2-specific-order-args","title":"Example 2: Specific Order Args","text":"<pre><code>Get-PAOrder -Name myorder | Get-PAPluginArgs\n</code></pre> <p>Retrieve the plugin args for the specified order.</p>"},{"location":"Functions/Get-PAPluginArgs/#parameters","title":"Parameters","text":""},{"location":"Functions/Get-PAPluginArgs/#-maindomain","title":"-MainDomain","text":"<p>The primary domain for the order. For a SAN order, this was the first domain in the list when creating the order.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAPluginArgs/#-name","title":"-Name","text":"<p>The name of the ACME order. This can be useful to distinguish between two orders that have the same MainDomain.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAPluginArgs/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Get-PAPluginArgs/#outputs","title":"Outputs","text":""},{"location":"Functions/Get-PAPluginArgs/#systemcollectionshashtable","title":"System.Collections.Hashtable","text":"<p>A hashtable containing saved plugin parameters.</p>"},{"location":"Functions/Get-PAPluginArgs/#related-links","title":"Related Links","text":"<p>Gew-PAOrder</p>"},{"location":"Functions/Get-PAServer/","title":"Get-PAServer","text":""},{"location":"Functions/Get-PAServer/#synopsis","title":"Synopsis","text":"<p>Get ACME server details.</p>"},{"location":"Functions/Get-PAServer/#syntax","title":"Syntax","text":""},{"location":"Functions/Get-PAServer/#specific-default","title":"Specific (Default)","text":"<pre><code>Get-PAServer [[-DirectoryUrl] &lt;String&gt;] [-Name &lt;String&gt;] [-Refresh] [-Quiet] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-PAServer/#list","title":"List","text":"<pre><code>Get-PAServer [-List] [-Refresh] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Get-PAServer/#description","title":"Description","text":"<p>The primary use for this function is checking which ACME server is currently configured. New Account and Cert requests will be directed to this server. It may also be used to refresh server details and list additional servers that have previously been used.</p>"},{"location":"Functions/Get-PAServer/#examples","title":"Examples","text":""},{"location":"Functions/Get-PAServer/#example-1-current-server","title":"Example 1: Current Server","text":"<pre><code>Get-PAServer\n</code></pre> <p>Get cached ACME server details for the currently selected server.</p>"},{"location":"Functions/Get-PAServer/#example-2-specific-server","title":"Example 2: Specific Server","text":"<pre><code>Get-PAServer -DirectoryUrl LE_PROD\n</code></pre> <p>Get cached LetsEncrypt production server details using the short name.</p>"},{"location":"Functions/Get-PAServer/#example-3-specific-server-url","title":"Example 3: Specific Server URL","text":"<pre><code>Get-PAServer -DirectoryUrl https://myacme.example.com/directory\n</code></pre> <p>Get cached ACME server details for the specified directory URL.</p>"},{"location":"Functions/Get-PAServer/#example-4-all-servers","title":"Example 4: All Servers","text":"<pre><code>Get-PAServer -List\n</code></pre> <p>Get all cached ACME server details.</p>"},{"location":"Functions/Get-PAServer/#parameters","title":"Parameters","text":""},{"location":"Functions/Get-PAServer/#-directoryurl","title":"-DirectoryUrl","text":"<p>Either the URL to an ACME server's \"directory\" endpoint or one of the supported short names. Currently supported short names include LE_PROD (LetsEncrypt Production), LE_STAGE (LetsEncrypt Staging), BUYPASS_PROD (BuyPass.com Production), BUYPASS_TEST (BuyPass.com Testing), and ZEROSSL_PROD (Zerossl.com Production).</p> <pre><code>Type: String\nParameter Sets: Specific\nAliases: location\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAServer/#-name","title":"-Name","text":"<p>The name of the ACME server. The parameter is ignored if DirectoryUrl is specified.</p> <pre><code>Type: String\nParameter Sets: Specific\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAServer/#-list","title":"-List","text":"<p>If specified, the details for all previously used servers will be returned.</p> <pre><code>Type: SwitchParameter\nParameter Sets: List\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAServer/#-refresh","title":"-Refresh","text":"<p>If specified, any server details returned will be freshly queried from the ACME server. Otherwise, cached details will be returned.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAServer/#-quiet","title":"-Quiet","text":"<p>If specified, no warning will be thrown if a specified server is not found.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Specific\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Get-PAServer/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Get-PAServer/#outputs","title":"Outputs","text":""},{"location":"Functions/Get-PAServer/#poshacmepaserver","title":"PoshACME.PAServer","text":"<p>A server object.</p>"},{"location":"Functions/Get-PAServer/#related-links","title":"Related Links","text":"<p>Set-PAServer</p>"},{"location":"Functions/Install-PACertificate/","title":"Install-PACertificate","text":""},{"location":"Functions/Install-PACertificate/#synopsis","title":"Synopsis","text":"<p>Install a Posh-ACME certificate into a Windows certificate store.</p>"},{"location":"Functions/Install-PACertificate/#syntax","title":"Syntax","text":"<pre><code>Install-PACertificate [[-PACertificate] &lt;Object&gt;] [[-StoreLocation] &lt;String&gt;] [[-StoreName] &lt;String&gt;]\n [-NotExportable] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Install-PACertificate/#description","title":"Description","text":"<p>This can be used instead of the <code>-Install</code> parameter on <code>New-PACertificate</code> to import a certificate with additional options.</p>"},{"location":"Functions/Install-PACertificate/#examples","title":"Examples","text":""},{"location":"Functions/Install-PACertificate/#example-1-import-current-certificate","title":"Example 1: Import Current Certificate","text":"<pre><code>Install-PACertificate\n</code></pre> <p>Install the certificate for the currently selected order to the default LocalMachine\\My store.</p>"},{"location":"Functions/Install-PACertificate/#example-2-import-specific-certificate","title":"Example 2: Import Specific Certificate","text":"<pre><code>Get-PACertificate example.com | Install-PACertificate\n</code></pre> <p>Install the specified certificate to the default LocalMachine\\My store.</p>"},{"location":"Functions/Install-PACertificate/#example-3-import-with-options","title":"Example 3: Import with Options","text":"<pre><code>Install-PACertificate -StoreLocation 'CurrentUser' -NotExportable\n</code></pre> <p>Install the certificate for the currently selected order to the CurrentUser\\My store and mark the private key as not exportable.</p>"},{"location":"Functions/Install-PACertificate/#parameters","title":"Parameters","text":""},{"location":"Functions/Install-PACertificate/#-pacertificate","title":"-PACertificate","text":"<p>The PACertificate object you want to import. This can be retrieved using Get-PACertificate and is also returned from things like New-PACertificate and Submit-Renewal.</p> <pre><code>Type: Object\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Install-PACertificate/#-storelocation","title":"-StoreLocation","text":"<p>Either 'LocalMachine' or 'CurrentUser'. Defaults to 'LocalMachine'.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 2\nDefault value: LocalMachine\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Install-PACertificate/#-storename","title":"-StoreName","text":"<p>The name of the certificate store to import to. Defaults to 'My'. The store must already exist and will not be created automatically.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 3\nDefault value: My\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Install-PACertificate/#-notexportable","title":"-NotExportable","text":"<p>If specified, the private key will not be marked as Exportable.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Install-PACertificate/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Install-PACertificate/#inputs","title":"Inputs","text":""},{"location":"Functions/Install-PACertificate/#poshacmepacertificate","title":"PoshACME.PACertificate","text":"<p>A certificate object as returned by Get-PACertificate.</p>"},{"location":"Functions/Install-PACertificate/#notes","title":"Notes","text":"<p>This function only currently works on Windows OSes. A warning will be thrown on other OSes.</p>"},{"location":"Functions/Install-PACertificate/#related-links","title":"Related Links","text":"<p>Get-PACertificate</p>"},{"location":"Functions/Invoke-HttpChallengeListener/","title":"Invoke-HttpChallengeListener","text":""},{"location":"Functions/Invoke-HttpChallengeListener/#synopsis","title":"Synopsis","text":"<p>Starts a local web server to answer pending http-01 ACME challenges.</p>"},{"location":"Functions/Invoke-HttpChallengeListener/#syntax","title":"Syntax","text":"<pre><code>Invoke-HttpChallengeListener [[-MainDomain] &lt;String&gt;] [[-Name] &lt;String&gt;] [-ListenerTimeout &lt;Int32&gt;]\n [-Port &lt;Int32&gt;] [-ListenerPrefixes &lt;String[]&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Invoke-HttpChallengeListener/#description","title":"Description","text":"<p>Uses <code>System.Net.HttpListener</code> to answer http-01 ACME challenges for the current or specified order. If MainDomain is not specified, the current Order is used.</p> <p>If running on Windows with non-admin privileges, Access Denied errors may be thrown unless a URL reservation is added using <code>netsh</code> that matches the HttpListener prefix that will be used. The default wildcard prefix is <code>http://+/.well-known/acme-challenge</code> and the netsh command might look something like this:</p> <pre><code>netsh http add urlacl url=http://+/.well-known/acme-challenge/ user=Everyone\n</code></pre>"},{"location":"Functions/Invoke-HttpChallengeListener/#examples","title":"Examples","text":""},{"location":"Functions/Invoke-HttpChallengeListener/#example-1-answer-for-current-order","title":"Example 1: Answer for Current Order","text":"<pre><code>Invoke-HttpChallengeListener\n</code></pre> <p>Start listener on default port 80 for pending challenges for the current order.</p>"},{"location":"Functions/Invoke-HttpChallengeListener/#example-2-specific-order-with-options","title":"Example 2: Specific Order with Options","text":"<pre><code>Invoke-HttpChallengeListener -MainDomain 'example.com' -Port 8080 -ListenerTimeout 30\n</code></pre> <p>Start listener on port 8080 with a timeout of 30 seconds for the specified order.</p>"},{"location":"Functions/Invoke-HttpChallengeListener/#example-3-using-other-prefixes","title":"Example 3: Using Other Prefixes","text":"<pre><code>$prefixes = 'http://example.com/.well-known/acme-challenge/','http://www.example.com/.well-known/acme-challenge'\nInvoke-HttpChallengeListener -ListenerPrefixes $prefixes\n</code></pre> <p>Start listener using the specified prefixes for the current order.</p>"},{"location":"Functions/Invoke-HttpChallengeListener/#parameters","title":"Parameters","text":""},{"location":"Functions/Invoke-HttpChallengeListener/#-maindomain","title":"-MainDomain","text":"<p>The primary domain associated with an order.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases: domain, fqdn\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Invoke-HttpChallengeListener/#-name","title":"-Name","text":"<p>The name of the ACME order. This can be useful to distinguish between two orders that have the same MainDomain.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 2\nDefault value: None\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Invoke-HttpChallengeListener/#-listenertimeout","title":"-ListenerTimeout","text":"<p>The timeout in seconds for the webserver. When reached, the http listener stops regardless of challenge status.</p> <pre><code>Type: Int32\nParameter Sets: (All)\nAliases: TTL\n\nRequired: False\nPosition: Named\nDefault value: 120\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Invoke-HttpChallengeListener/#-port","title":"-Port","text":"<p>The TCP port on which the http listener is listening. 80 by default. This parameter is ignored when ListenerPrefixes is specified.</p> <pre><code>Type: Int32\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: 0\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Invoke-HttpChallengeListener/#-listenerprefixes","title":"-ListenerPrefixes","text":"<p>Overrides the default wildcard listener prefix with the specified prefixes instead. Be sure to include the port if necessary and a trailing '/' on all included prefixes. See https://docs.microsoft.com/en-us/dotnet/api/system.net.httplistener for details.</p> <pre><code>Type: String[]\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Invoke-HttpChallengeListener/#-whatif","title":"-WhatIf","text":"<p>Shows what would happen if the cmdlet runs. The cmdlet is not run.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: wi\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Invoke-HttpChallengeListener/#-confirm","title":"-Confirm","text":"<p>Prompts you for confirmation before running the cmdlet.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: cf\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Invoke-HttpChallengeListener/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Invoke-HttpChallengeListener/#outputs","title":"Outputs","text":""},{"location":"Functions/Invoke-HttpChallengeListener/#poshacmepaauthorization","title":"PoshACME.PAAuthorization","text":"<p>The authorization object associated with the order.</p>"},{"location":"Functions/Invoke-HttpChallengeListener/#notes","title":"Notes","text":"<p>Warning</p> <p>This function is deprecated and may be removed in a future major version. Please migrate your scripts to use the <code>WebSelfHost</code> plugin.</p>"},{"location":"Functions/Invoke-HttpChallengeListener/#related-links","title":"Related Links","text":"<p>Get-PAOrder</p> <p>Get-PAAuthorization</p>"},{"location":"Functions/New-PAAccount/","title":"New-PAAccount","text":""},{"location":"Functions/New-PAAccount/#synopsis","title":"Synopsis","text":"<p>Create a new account on the current ACME server.</p>"},{"location":"Functions/New-PAAccount/#syntax","title":"Syntax","text":""},{"location":"Functions/New-PAAccount/#generate-default","title":"Generate (Default)","text":"<pre><code>New-PAAccount [[-Contact] &lt;String[]&gt;] [[-KeyLength] &lt;String&gt;] [-ID &lt;String&gt;] [-AcceptTOS] [-Force]\n [-ExtAcctKID &lt;String&gt;] [-ExtAcctHMACKey &lt;String&gt;] [-ExtAcctAlgorithm &lt;String&gt;] [-UseAltPluginEncryption]\n [-ExtraParams &lt;Object&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/New-PAAccount/#importkey","title":"ImportKey","text":"<pre><code>New-PAAccount [[-Contact] &lt;String[]&gt;] -KeyFile &lt;String&gt; [-ID &lt;String&gt;] [-AcceptTOS] [-OnlyReturnExisting]\n [-Force] [-ExtAcctKID &lt;String&gt;] [-ExtAcctHMACKey &lt;String&gt;] [-ExtAcctAlgorithm &lt;String&gt;]\n [-UseAltPluginEncryption] [-ExtraParams &lt;Object&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/New-PAAccount/#description","title":"Description","text":"<p>All certificate requests require a valid account on an ACME server. An contact email address is not required for Let's Encrypt, but other CAs may require it. Without an email address, certificate expiration notices will not be sent. The account KeyLength is a personal preference and does not relate to the KeyLength of the certificates.</p>"},{"location":"Functions/New-PAAccount/#examples","title":"Examples","text":""},{"location":"Functions/New-PAAccount/#example-1-basic-account","title":"Example 1: Basic Account","text":"<pre><code>New-PAAccount -Contact 'me@example.com' -AcceptTOS\n</code></pre> <p>Create a new account with the specified email and the default key length.</p>"},{"location":"Functions/New-PAAccount/#example-2-no-contact-and-alternate-keylength","title":"Example 2: No Contact and Alternate KeyLength","text":"<pre><code>New-PAAccount -KeyLength 'ec-384' -AcceptTOS -Force\n</code></pre> <p>Create a new account with no contact email and an ECC key using P-384 curve that ignores any confirmations.</p>"},{"location":"Functions/New-PAAccount/#example-3-pre-generated-key","title":"Example 3: Pre-Generated Key","text":"<pre><code>New-PAAccount -KeyFile .\\mykey.key -AcceptTOS\n</code></pre> <p>Create a new account using a pre-generated private key file.</p>"},{"location":"Functions/New-PAAccount/#example-4-external-account-binding","title":"Example 4: External Account Binding","text":"<pre><code>$eabKID = 'xxxxxxxx'\n$eabHMAC = 'yyyyyyyy'\nNew-PAAccount -ExtAcctKID $eabKID -ExtAcctHMACKey $eabHMAC -Contact 'me@example.com' -AcceptTOS\n</code></pre> <p>Create a new account using External Account Binding (EAB) values provided by your ACME CA.</p>"},{"location":"Functions/New-PAAccount/#example-5-alternative-plugin-encryption","title":"Example 5: Alternative Plugin Encryption","text":"<pre><code>New-PAAccount -UseAltPluginEncryption -Contact 'me@example.com' -AcceptTOS\n</code></pre> <p>Create a new account configured for alternative plugin encryption which uses an OS-portable AES key instead of the OS-native libraries.</p>"},{"location":"Functions/New-PAAccount/#parameters","title":"Parameters","text":""},{"location":"Functions/New-PAAccount/#-contact","title":"-Contact","text":"<p>One or more email addresses to associate with this account. These addresses will be used by the ACME server to send certificate expiration notifications or other important account notices.</p> <pre><code>Type: String[]\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAccount/#-keylength","title":"-KeyLength","text":"<p>The type and size of private key to use. For RSA keys, specify a number between 2048-4096 (divisible by 128). For ECC keys, specify either 'ec-256' or 'ec-384'. Defaults to 'ec-256'.</p> <pre><code>Type: String\nParameter Sets: Generate\nAliases: AccountKeyLength\n\nRequired: False\nPosition: 2\nDefault value: Ec-256\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAccount/#-keyfile","title":"-KeyFile","text":"<p>The path to an existing EC or RSA private key file. This will attempt to create the account using the specified key as the ACME account key. This can be used to recover/import an existing ACME account if one is already associated with the key.</p> <pre><code>Type: String\nParameter Sets: ImportKey\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAccount/#-id","title":"-ID","text":"<p>The name of the ACME acccount.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases: Name\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAccount/#-accepttos","title":"-AcceptTOS","text":"<p>If not specified, the ACME server will throw an error with a link to the current Terms of Service. Using this switch indicates acceptance of those Terms of Service and is required for successful account creation.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAccount/#-onlyreturnexisting","title":"-OnlyReturnExisting","text":"<p>If specified, the ACME server will only return the account details if they already exist for the given private key. Otherwise, an error will be thrown. This can be useful to check whether an existing private key is associated with an ACME acount and recover the account details without creating a new account.</p> <pre><code>Type: SwitchParameter\nParameter Sets: ImportKey\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAccount/#-force","title":"-Force","text":"<p>If specified, confirmation prompts that may have been generated will be skipped.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAccount/#-extacctkid","title":"-ExtAcctKID","text":"<p>The external account key identifier supplied by the CA. This is required for ACME CAs that require external account binding.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAccount/#-extaccthmackey","title":"-ExtAcctHMACKey","text":"<p>The external account HMAC key supplied by the CA and encoded as Base64Url. This is required for ACME CAs that require external account binding.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAccount/#-extacctalgorithm","title":"-ExtAcctAlgorithm","text":"<p>The HMAC algorithm to use. Defaults to 'HS256'.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: HS256\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAccount/#-usealtpluginencryption","title":"-UseAltPluginEncryption","text":"<p>If specified, the account will be configured to use a randomly generated AES key to encrypt sensitive plugin parameters on disk instead of using the OS's native encryption methods. This can be useful if the config is being shared across systems or platforms. You can revert to OS native encryption using <code>Set-PAAccount -UseAltPluginEncryption:$false</code>.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAccount/#-extraparams","title":"-ExtraParams","text":"<p>This parameter can be ignored and is only used to prevent errors when splatting with more parameters than this function supports.</p> <pre><code>Type: Object\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAccount/#-whatif","title":"-WhatIf","text":"<p>Shows what would happen if the cmdlet runs. The cmdlet is not run.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: wi\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAccount/#-confirm","title":"-Confirm","text":"<p>Prompts you for confirmation before running the cmdlet.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: cf\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAccount/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/New-PAAccount/#outputs","title":"Outputs","text":""},{"location":"Functions/New-PAAccount/#poshacmepaaccount","title":"PoshACME.PAAccount","text":"<p>An account object.</p>"},{"location":"Functions/New-PAAccount/#related-links","title":"Related Links","text":"<p>Get-PAAccount</p> <p>Set-PAAccount</p>"},{"location":"Functions/New-PAAuthorization/","title":"New-PAAuthorization","text":""},{"location":"Functions/New-PAAuthorization/#synopsis","title":"Synopsis","text":"<p>Create a pre-authorization for an ACME identifier.</p>"},{"location":"Functions/New-PAAuthorization/#syntax","title":"Syntax","text":"<pre><code>New-PAAuthorization [-Domain] &lt;String[]&gt; [[-Account] &lt;Object&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/New-PAAuthorization/#description","title":"Description","text":"<p>Instead of creating an ACME order object and satisfying the associated authorization challenges on demand, users may choose to pre-authorize one or more identifiers in advance. When a user later creates an order with pre-authorized identifiers, it will be immediately ready to finalize.</p> <p>NOTE: Not all ACME servers support pre-authorization. The authorizations created this way also expire the same way they do when associated directly with an order.</p>"},{"location":"Functions/New-PAAuthorization/#examples","title":"Examples","text":""},{"location":"Functions/New-PAAuthorization/#example-1-auth-for-current-account","title":"Example 1: Auth for Current Account","text":"<pre><code>$auth = New-PAAuthorization example.com\n</code></pre> <p>Create a new authorization for the specified domain using the current account.</p>"},{"location":"Functions/New-PAAuthorization/#example-2-auths-for-specific-account","title":"Example 2: Auths for Specific Account","text":"<pre><code>$auths = 'example.com','www.example.com' | New-PAAuthorization -Account (Get-PAAccount 123)\n</code></pre> <p>Create new authorizations for the specified domains using the specified account.</p>"},{"location":"Functions/New-PAAuthorization/#parameters","title":"Parameters","text":""},{"location":"Functions/New-PAAuthorization/#-domain","title":"-Domain","text":"<p>One or more ACME identifiers (usually domain names).</p> <pre><code>Type: String[]\nParameter Sets: (All)\nAliases:\n\nRequired: True\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAuthorization/#-account","title":"-Account","text":"<p>An existing ACME account object such as the output from Get-PAAccount. If no account is specified, the current account will be used.</p> <pre><code>Type: Object\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 2\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAAuthorization/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/New-PAAuthorization/#inputs","title":"Inputs","text":""},{"location":"Functions/New-PAAuthorization/#systemstring","title":"System.String","text":"<p>The domain or IP address identifier to authorize.</p>"},{"location":"Functions/New-PAAuthorization/#outputs","title":"Outputs","text":""},{"location":"Functions/New-PAAuthorization/#poshacmepaauthorization","title":"PoshACME.PAAuthorization","text":"<p>An authorization object.</p>"},{"location":"Functions/New-PAAuthorization/#related-links","title":"Related Links","text":"<p>Get-PAAuthorization</p> <p>New-PAOrder</p>"},{"location":"Functions/New-PACertificate/","title":"New-PACertificate","text":""},{"location":"Functions/New-PACertificate/#synopsis","title":"Synopsis","text":"<p>Request a new certificate</p>"},{"location":"Functions/New-PACertificate/#syntax","title":"Syntax","text":""},{"location":"Functions/New-PACertificate/#fromscratch-default","title":"FromScratch (Default)","text":"<pre><code>New-PACertificate [-Domain] &lt;String[]&gt; [-Name &lt;String&gt;] [-Contact &lt;String[]&gt;] [-CertKeyLength &lt;String&gt;]\n [-AlwaysNewKey] [-AcceptTOS] [-AccountKeyLength &lt;String&gt;] [-DirectoryUrl &lt;String&gt;] [-Plugin &lt;String[]&gt;]\n [-PluginArgs &lt;Hashtable&gt;] [-LifetimeDays &lt;Int32&gt;] [-DnsAlias &lt;String[]&gt;] [-OCSPMustStaple] [-Subject &lt;String&gt;]\n [-FriendlyName &lt;String&gt;] [-PfxPass &lt;String&gt;] [-PfxPassSecure &lt;SecureString&gt;] [-UseModernPfxEncryption]\n [-Install] [-UseSerialValidation] [-Force] [-DnsSleep &lt;Int32&gt;] [-ValidationTimeout &lt;Int32&gt;]\n [-PreferredChain &lt;String&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/New-PACertificate/#fromcsr","title":"FromCSR","text":"<pre><code>New-PACertificate [-CSRPath] &lt;String&gt; [-Name &lt;String&gt;] [-Contact &lt;String[]&gt;] [-AcceptTOS]\n [-AccountKeyLength &lt;String&gt;] [-DirectoryUrl &lt;String&gt;] [-Plugin &lt;String[]&gt;] [-PluginArgs &lt;Hashtable&gt;]\n [-LifetimeDays &lt;Int32&gt;] [-DnsAlias &lt;String[]&gt;] [-UseSerialValidation] [-Force] [-DnsSleep &lt;Int32&gt;]\n [-ValidationTimeout &lt;Int32&gt;] [-PreferredChain &lt;String&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/New-PACertificate/#description","title":"Description","text":"<p>This is the primary function for this module and is capable executing the entire ACME certificate request process from start to finish without any prerequisite steps. However, utilizing the module's other functions can enable more complicated workflows and reduce the number of parameters you need to supply to this function.</p>"},{"location":"Functions/New-PACertificate/#examples","title":"Examples","text":""},{"location":"Functions/New-PACertificate/#example-1-basic-manual-certificate","title":"Example 1: Basic Manual Certificate","text":"<pre><code>New-PACertificate 'example.com','www.example.com' -AcceptTOS\n</code></pre> <p>This is the bare minimum necessary to create a certificate for a basic domain (plus the <code>www</code> alt name). It prompts you to add the required DNS TXT record manually. You can omit the <code>-AcceptTOS</code> parameter if you already have an ACME account configured.</p>"},{"location":"Functions/New-PACertificate/#example-2-wildcard-certificate-with-contact","title":"Example 2: Wildcard Certificate with Contact","text":"<pre><code>New-PACertificate '*.example.com','example.com' -Contact 'admin@example.com'\n</code></pre> <p>Wildcard certificates generally include the non-wildcard root as a SAN because the wildcard doesn't match it. The contact email address is typically used by the CA to send expiration warnings.</p>"},{"location":"Functions/New-PACertificate/#example-3-using-a-plugin","title":"Example 3: Using a plugin","text":"<pre><code>$pArgs = @{\n    FDToken = (Read-Host 'FakeDNS API Token' -AsSecureString)\n}\nNew-PACertificate 'example.com' -Plugin FakeDNS -PluginArgs $pArgs\n</code></pre> <p>Plugin parameters are passed as a basic hashtable object. Some parameters may require SecureString or PSCredential objects to protect sensitive API credentials, tokens, and keys.</p>"},{"location":"Functions/New-PACertificate/#example-4-using-multiple-plugins","title":"Example 4: Using multiple plugins","text":"<pre><code>$pArgs = @{\n    FDToken = (Read-Host 'FakeDNS API Token' -AsSecureString)\n    WSHPort = 8080\n}\nNew-PACertificate '*.example.com','example.com' -Plugin FakeDNS,WebSelfHost -PluginArgs $pArgs\n</code></pre> <p>Each name in a certificate can use a different plugin if necessary. Be sure the specified plugin order matches the order of the names they are associated with. If there are fewer plugins specified than names, the last plugin in the list will be applied to all remaining names.</p> <p>Each plugin's parameters should be combined into the same hashtable object.</p>"},{"location":"Functions/New-PACertificate/#example-5-using-a-dns-challenge-alias","title":"Example 5: Using a DNS Challenge Alias","text":"<pre><code>$pArgs = @{\n    FDToken = (Read-Host 'FakeDNS API Token' -AsSecureString)\n}\nNew-PACertificate 'example.com' -Plugin FakeDNS -PluginArgs $pArgs -DnsAlias 'acme.example.net'\n</code></pre> <p>Using <code>DnsAlias</code> tells the plugin to create the required TXT record to an alternate hostname. It requires having added a CNAME record for each name in the cert pointing to the alternate record location. In this case, <code>_acme-challenge.example.com</code> is pointing to <code>acme.example.net</code>.</p>"},{"location":"Functions/New-PACertificate/#parameters","title":"Parameters","text":""},{"location":"Functions/New-PACertificate/#-domain","title":"-Domain","text":"<p>One or more domain names to include in this order/certificate. The first one in the list will be considered the \"MainDomain\" and be set as the subject of the finalized certificate.</p> <pre><code>Type: String[]\nParameter Sets: FromScratch\nAliases:\n\nRequired: True\nPosition: 1\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-csrpath","title":"-CSRPath","text":"<p>Either the filesystem path to a certificate request (CSR) file in PEM (Base64) format or the raw string contents of such a file. If using the string version, the PEM header and footer must be separated by line breaks from the Base64 content just like they would be in a normal file. This is useful for appliances that need to generate their own keys and cert requests or when the private key is otherwise unavailable.</p> <pre><code>Type: String\nParameter Sets: FromCSR\nAliases: CSRString\n\nRequired: True\nPosition: 1\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-name","title":"-Name","text":"<p>The name of the ACME order. This can be useful to distinguish between two orders that have the same MainDomain.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-contact","title":"-Contact","text":"<p>One or more email addresses to associate with this certificate. These addresses will be used by the ACME server to send certificate expiration notifications or other important account notices.</p> <pre><code>Type: String[]\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-certkeylength","title":"-CertKeyLength","text":"<p>The type and size of private key to use for the certificate. For RSA keys, specify a number between 2048-4096 (divisible by 128). For ECC keys, specify either 'ec-256' or 'ec-384'. Defaults to '2048'.</p> <pre><code>Type: String\nParameter Sets: FromScratch\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: 2048\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-alwaysnewkey","title":"-AlwaysNewKey","text":"<p>If specified, the order will be configured to always generate a new private key during each renewal. Otherwise, the old key is re-used if it exists.</p> <pre><code>Type: SwitchParameter\nParameter Sets: FromScratch\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-accepttos","title":"-AcceptTOS","text":"<p>This switch is required when creating a new account as part of a certificate request. It implies you have read and accepted the Terms of Service for the ACME server you are connected to. The first time you connect to an ACME server, a link to the Terms of Service should have been displayed.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-accountkeylength","title":"-AccountKeyLength","text":"<p>The type and size of private key to use for the account associated with this certificate. For RSA keys, specify a number between 2048-4096 (divisible by 128). For ECC keys, specify either 'ec-256' or 'ec-384'. Defaults to 'ec-256'.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: Ec-256\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-directoryurl","title":"-DirectoryUrl","text":"<p>Either the URL to an ACME server's \"directory\" endpoint or one of the supported short names. Currently supported short names include LE_PROD (LetsEncrypt Production), LE_STAGE (LetsEncrypt Staging), BUYPASS_PROD (BuyPass.com Production), BUYPASS_TEST (BuyPass.com Testing), and ZEROSSL_PROD (Zerossl.com Production).</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases: location\n\nRequired: False\nPosition: Named\nDefault value: LE_PROD\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-plugin","title":"-Plugin","text":"<p>One or more validation plugin names to use for this order's challenges. If no plugin is specified, the DNS \"Manual\" plugin will be used. If the same plugin is used for all domains in the order, you can just specify it once. Otherwise, you should specify as many plugin names as there are domains in the order and in the same sequence as the order.</p> <pre><code>Type: String[]\nParameter Sets: (All)\nAliases: DnsPlugin\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-pluginargs","title":"-PluginArgs","text":"<p>A hashtable containing the plugin arguments to use with the specified Plugin list. So if a plugin has a -MyText string and -MyNumber integer parameter, you could specify them as <code>@{MyText='text';MyNumber=1234}</code>.</p> <pre><code>Type: Hashtable\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-dnsalias","title":"-DnsAlias","text":"<p>One or more FQDNs that DNS challenges should be published to instead of the certificate domain's zone. This is used in advanced setups where a CNAME in the certificate domain's zone has been pre-created to point to the alias's FQDN which makes the ACME server check the alias domain when validation challenge TXT records. If the same alias is used for all domains in the order, you can just specify it once. Otherwise, you should specify as many alias FQDNs as there are domains in the order and in the same sequence as the order.</p> <pre><code>Type: String[]\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-ocspmuststaple","title":"-OCSPMustStaple","text":"<p>If specified, the certificate generated for this order will have the OCSP Must-Staple flag set.</p> <pre><code>Type: SwitchParameter\nParameter Sets: FromScratch\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-subject","title":"-Subject","text":"<p>Sets the x509 \"Subject\" field in the certificate request that gets sent to the ACME server. By default, it is set to 'CN=FQDN' where 'FQDN' is the first name in the Domain parameter. For public certificate authorities issuing DV certificates, anything other than a DNS name from the list of domains will either be rejected or stripped from the finalized certificate.</p> <pre><code>Type: String\nParameter Sets: FromScratch\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-friendlyname","title":"-FriendlyName","text":"<p>Set a friendly name for the certificate. This will populate the \"Friendly Name\" field in the Windows certificate store when the PFX is imported. Defaults to the first item in the Domain parameter.</p> <pre><code>Type: String\nParameter Sets: FromScratch\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-pfxpass","title":"-PfxPass","text":"<p>Set the export password for generated PFX files. Defaults to 'poshacme'. When the PfxPassSecure parameter is specified, this parameter is ignored.</p> <pre><code>Type: String\nParameter Sets: FromScratch\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: Poshacme\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-pfxpasssecure","title":"-PfxPassSecure","text":"<p>Set the export password for generated PFX files using a SecureString value. When this parameter is specified, the PfxPass parameter is ignored.</p> <pre><code>Type: SecureString\nParameter Sets: FromScratch\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-install","title":"-Install","text":"<p>If specified, the certificate generated for this order will be imported to the local computer's Personal certificate store. Using this switch requires running the command from an elevated PowerShell session.</p> <pre><code>Type: SwitchParameter\nParameter Sets: FromScratch\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-useserialvalidation","title":"-UseSerialValidation","text":"<p>If specified, the names in the order will be validated individually rather than all at once. This can significantly increase the time it takes to process validations and should only be used for plugins that require it. The plugin's usage guide should indicate whether it is required.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-force","title":"-Force","text":"<p>If specified, a new certificate order will always be created regardless of the status of a previous order for the same primary domain. Otherwise, the previous order still in progress will be used instead.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-dnssleep","title":"-DnsSleep","text":"<p>Number of seconds to wait for DNS changes to propagate before asking the ACME server to validate DNS challenges. Default is 120.</p> <pre><code>Type: Int32\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: 120\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-validationtimeout","title":"-ValidationTimeout","text":"<p>Number of seconds to wait for the ACME server to validate the challenges after asking it to do so. Default is 60. If the timeout is exceeded, an error will be thrown.</p> <pre><code>Type: Int32\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: 60\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-preferredchain","title":"-PreferredChain","text":"<p>If the CA offers multiple certificate chains, prefer the chain with an issuer matching this Subject Common Name. If no match, the default offered chain will be used.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-lifetimedays","title":"-LifetimeDays","text":"<p>How long in days the certificate should be valid for. NOTE: Many CAs do not support this feature and have fixed lifetime values. Some may ignore the request. Others may throw an error if specified.</p> <pre><code>Type: Int32\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#-usemodernpfxencryption","title":"-UseModernPfxEncryption","text":"<p>If specified, PFX files generated from this order will use AES256 with SHA256 for the private key encryption instead of the default which is RC2-40-CBC. This can affect compatibility with some crypto libraries and tools. Most notably, OpenSSL 3.x requires the newer options to avoid using \"legacy\" mode. But it breaks compatibility with OpenSSL 1.0.x.</p> <pre><code>Type: SwitchParameter\nParameter Sets: FromScratch\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PACertificate/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/New-PACertificate/#outputs","title":"Outputs","text":""},{"location":"Functions/New-PACertificate/#poshacmepacertificate","title":"PoshACME.PACertificate","text":"<p>A certificate object.</p>"},{"location":"Functions/New-PACertificate/#related-links","title":"Related Links","text":"<p>Submit-Renewal</p> <p>Get-PAPlugin</p>"},{"location":"Functions/New-PAOrder/","title":"New-PAOrder","text":""},{"location":"Functions/New-PAOrder/#synopsis","title":"Synopsis","text":"<p>Create a new order on the current ACME account.</p>"},{"location":"Functions/New-PAOrder/#syntax","title":"Syntax","text":""},{"location":"Functions/New-PAOrder/#fromscratch-default","title":"FromScratch (Default)","text":"<pre><code>New-PAOrder [-Domain] &lt;String[]&gt; [[-KeyLength] &lt;String&gt;] [-Name &lt;String&gt;] [-Plugin &lt;String[]&gt;]\n [-PluginArgs &lt;Hashtable&gt;] [-LifetimeDays &lt;Int32&gt;] [-DnsAlias &lt;String[]&gt;] [-OCSPMustStaple] [-AlwaysNewKey]\n [-Subject &lt;String&gt;] [-FriendlyName &lt;String&gt;] [-PfxPass &lt;String&gt;] [-PfxPassSecure &lt;SecureString&gt;]\n [-UseModernPfxEncryption] [-Install] [-UseSerialValidation] [-DnsSleep &lt;Int32&gt;] [-ValidationTimeout &lt;Int32&gt;]\n [-PreferredChain &lt;String&gt;] [-Force] [-ReplacesCert &lt;String&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/New-PAOrder/#importkey","title":"ImportKey","text":"<pre><code>New-PAOrder [-Domain] &lt;String[]&gt; -KeyFile &lt;String&gt; [-Name &lt;String&gt;] [-Plugin &lt;String[]&gt;]\n [-PluginArgs &lt;Hashtable&gt;] [-LifetimeDays &lt;Int32&gt;] [-DnsAlias &lt;String[]&gt;] [-OCSPMustStaple] [-AlwaysNewKey]\n [-Subject &lt;String&gt;] [-FriendlyName &lt;String&gt;] [-PfxPass &lt;String&gt;] [-PfxPassSecure &lt;SecureString&gt;]\n [-UseModernPfxEncryption] [-Install] [-UseSerialValidation] [-DnsSleep &lt;Int32&gt;] [-ValidationTimeout &lt;Int32&gt;]\n [-PreferredChain &lt;String&gt;] [-Force] [-ReplacesCert &lt;String&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/New-PAOrder/#fromcsr","title":"FromCSR","text":"<pre><code>New-PAOrder [-CSRPath] &lt;String&gt; [-Name &lt;String&gt;] [-Plugin &lt;String[]&gt;] [-PluginArgs &lt;Hashtable&gt;]\n [-LifetimeDays &lt;Int32&gt;] [-DnsAlias &lt;String[]&gt;] [-UseSerialValidation] [-DnsSleep &lt;Int32&gt;]\n [-ValidationTimeout &lt;Int32&gt;] [-PreferredChain &lt;String&gt;] [-Force] [-ReplacesCert &lt;String&gt;] [-WhatIf] [-Confirm]\n [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/New-PAOrder/#description","title":"Description","text":"<p>Creating an ACME order is the first step of the certificate request process. To create a SAN certificate with multiple names, include them all in an array for the -Domain parameter. The first name in the list will be considered the \"MainDomain\" and will also be in the certificate subject field. Different CAs have different policies regarding the number of SANs a certificate may have.</p> <p>Be aware that new orders that share the same MainDomain as a previous order will overwrite the previous order unless the <code>Name</code> paraemter is specified and there are no other order matches for that name.</p>"},{"location":"Functions/New-PAOrder/#examples","title":"Examples","text":""},{"location":"Functions/New-PAOrder/#example-1-single-domain-order","title":"Example 1: Single Domain Order","text":"<pre><code>New-PAOrder example.com\n</code></pre> <p>Create a new order for the specified domain using the default key length.</p>"},{"location":"Functions/New-PAOrder/#example-2-multi-domain-with-plugin","title":"Example 2: Multi-Domain with Plugin","text":"<pre><code>$pArgs = @{\n    FDToken = (Read-Host 'FakeDNS API Token' -AsSecureString)\n}\n$domains = 'example.com','www.example.com','blog.example.com'\nNew-PAOrder -Domain $domains -Plugin FakeDNS -PluginArgs $pArgs\n</code></pre> <p>Create a new SAN order for the specified domains and specify plugin details.</p>"},{"location":"Functions/New-PAOrder/#example-3-ecdsa-private-key","title":"Example 3: ECDSA Private Key","text":"<pre><code>New-PAOrder example.com -KeyLength 'ec-256'\n</code></pre> <p>Create a new order for the specified domain using an ECDSA P-256 private key.</p>"},{"location":"Functions/New-PAOrder/#example-4-pre-generated-private-key","title":"Example 4: Pre-generated Private Key","text":"<pre><code>New-PAOrder example.com -KeyFile .\\mykey.key\n</code></pre> <p>Create a new order using an externally generated private key.</p>"},{"location":"Functions/New-PAOrder/#example-5-external-cert-request","title":"Example 5: External Cert Request","text":"<pre><code>New-PAOrder -CSRPath .\\myreq.csr\n</code></pre> <p>Create a new order using an externally generated certificate request.</p>"},{"location":"Functions/New-PAOrder/#parameters","title":"Parameters","text":""},{"location":"Functions/New-PAOrder/#-domain","title":"-Domain","text":"<p>One or more domain names to include in this order/certificate. The first one in the list will be considered the \"MainDomain\" and be set as the subject of the finalized certificate.</p> <pre><code>Type: String[]\nParameter Sets: FromScratch, ImportKey\nAliases:\n\nRequired: True\nPosition: 1\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-csrpath","title":"-CSRPath","text":"<p>Either the filesystem path to a certificate request (CSR) file in PEM (Base64) format or the raw string contents of such a file. If using the string version, the PEM header and footer must be separated by line breaks from the Base64 content just like they would be in a normal file. This is useful for appliances that need to generate their own keys and cert requests or when the private key is otherwise unavailable.</p> <pre><code>Type: String\nParameter Sets: FromCSR\nAliases: CSRString\n\nRequired: True\nPosition: 1\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-keylength","title":"-KeyLength","text":"<p>The type and size of private key to use. For RSA keys, specify a number between 2048-4096 (divisible by 128). For ECC keys, specify either 'ec-256' or 'ec-384'. Defaults to '2048'.</p> <pre><code>Type: String\nParameter Sets: FromScratch\nAliases:\n\nRequired: False\nPosition: 2\nDefault value: 2048\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-keyfile","title":"-KeyFile","text":"<p>The path to an existing EC or RSA private key file. This will attempt to create the order using the specified key as the certificate's private key.</p> <pre><code>Type: String\nParameter Sets: ImportKey\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-name","title":"-Name","text":"<p>The name of the ACME order. This can be useful to distinguish between two orders that have the same MainDomain. If not specified, defaults to the first domain in the order.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-plugin","title":"-Plugin","text":"<p>One or more validation plugin names to use for this order's challenges. If no plugin is specified, the DNS \"Manual\" plugin will be used. If the same plugin is used for all domains in the order, you can just specify it once. Otherwise, you should specify as many plugin names as there are domains in the order and in the same sequence as the order.</p> <pre><code>Type: String[]\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-pluginargs","title":"-PluginArgs","text":"<p>A hashtable containing the plugin arguments to use with the specified Plugin list. So if a plugin has a -MyText string and -MyNumber integer parameter, you could specify them as <code>@{MyText='text';MyNumber=1234}</code>.</p> <pre><code>Type: Hashtable\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-dnsalias","title":"-DnsAlias","text":"<p>One or more FQDNs that DNS challenges should be published to instead of the certificate domain's zone. This is used in advanced setups where a CNAME in the certificate domain's zone has been pre-created to point to the alias's FQDN which makes the ACME server check the alias domain when validation challenge TXT records. If the same alias is used for all domains in the order, you can just specify it once. Otherwise, you should specify as many alias FQDNs as there are domains in the order and in the same sequence as the order.</p> <pre><code>Type: String[]\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-ocspmuststaple","title":"-OCSPMustStaple","text":"<p>If specified, the certificate generated for this order will have the OCSP Must-Staple flag set.</p> <pre><code>Type: SwitchParameter\nParameter Sets: FromScratch, ImportKey\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-alwaysnewkey","title":"-AlwaysNewKey","text":"<p>If specified, the order will be configured to always generate a new private key during each renewal. Otherwise, the old key is re-used if it exists.</p> <pre><code>Type: SwitchParameter\nParameter Sets: FromScratch, ImportKey\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-subject","title":"-Subject","text":"<p>Sets the x509 \"Subject\" field in the certificate request that gets sent to the ACME server. By default, it is set to 'CN=FQDN' where 'FQDN' is the first name in the Domain parameter. For public certificate authorities issuing DV certificates, anything other than a DNS name from the list of domains will either be rejected or stripped from the finalized certificate.</p> <pre><code>Type: String\nParameter Sets: FromScratch, ImportKey\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-friendlyname","title":"-FriendlyName","text":"<p>Set a friendly name for the certificate. This will populate the \"Friendly Name\" field in the Windows certificate store when the PFX is imported. Defaults to the first item in the Domain parameter.</p> <pre><code>Type: String\nParameter Sets: FromScratch, ImportKey\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-pfxpass","title":"-PfxPass","text":"<p>Set the export password for generated PFX files. Defaults to 'poshacme'. When the PfxPassSecure parameter is specified, this parameter is ignored.</p> <pre><code>Type: String\nParameter Sets: FromScratch, ImportKey\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: Poshacme\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-pfxpasssecure","title":"-PfxPassSecure","text":"<p>Set the export password for generated PFX files using a SecureString value. When this parameter is specified, the PfxPass parameter is ignored.</p> <pre><code>Type: SecureString\nParameter Sets: FromScratch, ImportKey\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-install","title":"-Install","text":"<p>If specified, the certificate generated for this order will be imported to the local computer's Personal certificate store.</p> <pre><code>Type: SwitchParameter\nParameter Sets: FromScratch, ImportKey\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-useserialvalidation","title":"-UseSerialValidation","text":"<p>If specified, the names in the order will be validated individually rather than all at once. This can significantly increase the time it takes to process validations and should only be used for plugins that require it. The plugin's usage guide should indicate whether it is required.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-dnssleep","title":"-DnsSleep","text":"<p>Number of seconds to wait for DNS changes to propagate before asking the ACME server to validate DNS challenges.</p> <pre><code>Type: Int32\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: 120\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-validationtimeout","title":"-ValidationTimeout","text":"<p>Number of seconds to wait for the ACME server to validate the challenges after asking it to do so. If the timeout is exceeded, an error will be thrown.</p> <pre><code>Type: Int32\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: 60\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-preferredchain","title":"-PreferredChain","text":"<p>If the CA offers multiple certificate chains, prefer the chain with an issuer matching this Subject Common Name. If no match, the default offered chain will be used.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-force","title":"-Force","text":"<p>If specified, confirmation prompts that may have been generated will be skipped.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-whatif","title":"-WhatIf","text":"<p>Shows what would happen if the cmdlet runs. The cmdlet is not run.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: wi\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-confirm","title":"-Confirm","text":"<p>Prompts you for confirmation before running the cmdlet.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: cf\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-lifetimedays","title":"-LifetimeDays","text":"<p>How long in days the certificate should be valid for. NOTE: Many CAs do not support this feature and have fixed lifetime values. Some may ignore the request. Others may throw an error if specified.</p> <pre><code>Type: Int32\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-usemodernpfxencryption","title":"-UseModernPfxEncryption","text":"<p>If specified, PFX files generated from this order will use AES256 with SHA256 for the private key encryption instead of the default which is RC2-40-CBC. This can affect compatibility with some crypto libraries and tools. Most notably, OpenSSL 3.x requires the newer options to avoid using \"legacy\" mode. But it breaks compatibility with OpenSSL 1.0.x.</p> <pre><code>Type: SwitchParameter\nParameter Sets: FromScratch, ImportKey\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#-replacescert","title":"-ReplacesCert","text":"<p>The ARI certificate ID from the ARIId parameter on a PACertificate object returned by Get-PACertificate. This is optional and only used if the server supports the ACME Renewal Information Extension (ARI).</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/New-PAOrder/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/New-PAOrder/#outputs","title":"Outputs","text":""},{"location":"Functions/New-PAOrder/#poshacmepaorder","title":"PoshACME.PAOrder","text":"<p>An order object.</p>"},{"location":"Functions/New-PAOrder/#related-links","title":"Related Links","text":"<p>Get-PAOrder</p> <p>Set-PAOrder</p>"},{"location":"Functions/Publish-Challenge/","title":"Publish-Challenge","text":""},{"location":"Functions/Publish-Challenge/#synopsis","title":"Synopsis","text":"<p>Publish a challenge using the specified plugin.</p>"},{"location":"Functions/Publish-Challenge/#syntax","title":"Syntax","text":"<pre><code>Publish-Challenge [-Domain] &lt;String&gt; [-Account] &lt;Object&gt; [-Token] &lt;String&gt; [-Plugin] &lt;String&gt;\n [[-PluginArgs] &lt;Hashtable&gt;] [-DnsAlias &lt;String&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Publish-Challenge/#description","title":"Description","text":"<p>Based on the type of validation plugin specified, this function will publish either a DNS TXT record or an HTTP challenge file for the given domain and token value that satisfies the dns-01 or http-01 challenge specification.</p> <p>Depending on the plugin, calling <code>Save-Challenge</code> may be required to commit changes made by <code>Publish-Challenge</code>. If multiple challenges are being published, make all <code>Publish-Challenge</code> calls first. Then, <code>Save-Challenge</code> once to commit them all.</p>"},{"location":"Functions/Publish-Challenge/#examples","title":"Examples","text":""},{"location":"Functions/Publish-Challenge/#example-1-publish-a-challenge","title":"Example 1: Publish a Challenge","text":"<pre><code>$splat = @{\n    Domain = 'example.com'\n    Account = (Get-PAAccount)\n    Token = 'fake-token'\n    Plugin = 'FakeDNS'\n    PluginArgs = @{\n        FDToken = (Read-Host 'FakeDNS API Token' -AsSecureString)\n    }\n}\nPublish-Challenge @splat\n\n# if plugin requires saving\nSave-Challenge -Plugin $splat.Plugin -PluginArgs $splat.PluginArgs\n</code></pre> <p>Publish a single DNS challenge.</p>"},{"location":"Functions/Publish-Challenge/#example-2-dns-order-challenges","title":"Example 2: DNS Order Challenges","text":"<pre><code>$splat = @{\n    Account = (Get-PAAccount)\n    Plugin = 'FakeDNS'\n    PluginArgs = @{\n        FDToken = (Read-Host 'FakeDNS API Token' -AsSecureString)\n    }\n}\nGet-PAOrder | Get-PAAuthorization | ForEach-Object {\n    Publish-Challenge -Domain $_.DNSId -Token $_.DNS01Token @splat\n}\n\n# if plugin requires saving\nSave-Challenge -Plugin $splat.Plugin -PluginArgs $splat.PluginArgs\n</code></pre> <p>Publish DNS challenges for all authorizations in the current order.</p>"},{"location":"Functions/Publish-Challenge/#example-3-http-order-challenges","title":"Example 3: HTTP Order Challenges","text":"<pre><code>$splat = @{\n    Account = (Get-PAAccount)\n    Plugin = 'WebSelfHost'\n    PluginArgs = @{}\n}\nGet-PAOrder | Get-PAAuthorization | ForEach-Object {\n    Publish-Challenge -Domain $_.DNSId -Token $_.HTTP01Token @splat\n}\n\n# if plugin requires saving\nSave-Challenge -Plugin $splat.Plugin -PluginArgs $splat.PluginArgs\n</code></pre> <p>Publish HTTP challenges for all authorizations in the current order.</p>"},{"location":"Functions/Publish-Challenge/#parameters","title":"Parameters","text":""},{"location":"Functions/Publish-Challenge/#-domain","title":"-Domain","text":"<p>The domain name that the challenge will be published for. Wildcard domains should have the \"*.\" removed and can only be used with DNS based validation plugins.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: True\nPosition: 1\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Publish-Challenge/#-account","title":"-Account","text":"<p>The account object associated with the order that requires the challenge.</p> <pre><code>Type: Object\nParameter Sets: (All)\nAliases:\n\nRequired: True\nPosition: 2\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Publish-Challenge/#-token","title":"-Token","text":"<p>The token value from the appropriate challenge in an authorization object that matches the plugin type.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: True\nPosition: 3\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Publish-Challenge/#-plugin","title":"-Plugin","text":"<p>The name of the validation plugin to use. Use Get-PAPlugin to display a list of available plugins.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: True\nPosition: 4\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Publish-Challenge/#-pluginargs","title":"-PluginArgs","text":"<p>A hashtable containing the plugin arguments to use with the specified plugin. So if a plugin has a -MyText string and -MyNumber integer parameter, you could specify them as <code>@{MyText='text';MyNumber=1234}</code>.</p> <pre><code>Type: Hashtable\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 5\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Publish-Challenge/#-dnsalias","title":"-DnsAlias","text":"<p>When using DNS Alias support with DNS validation plugins, the alias domain that the TXT record will be written to. This should be the complete FQDN including the <code>_acme-challenge.</code> prefix if necessary. This field is ignored for non-DNS validation plugins.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Publish-Challenge/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Publish-Challenge/#related-links","title":"Related Links","text":"<p>Unpublish-Challenge</p> <p>Save-Challenge</p> <p>Get-PAPlugin</p>"},{"location":"Functions/Remove-PAAccount/","title":"Remove-PAAccount","text":""},{"location":"Functions/Remove-PAAccount/#synopsis","title":"Synopsis","text":"<p>Remove an ACME account and all associated orders and certificates from the local profile.</p>"},{"location":"Functions/Remove-PAAccount/#syntax","title":"Syntax","text":"<pre><code>Remove-PAAccount [-ID] &lt;String&gt; [-Deactivate] [-Force] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Remove-PAAccount/#description","title":"Description","text":"<p>This function removes the ACME account from the local profile which also removes any associated orders and certificates. It will not remove or cleanup copies of certificates that have been exported or installed elsewhere. It will not deactivate the account on the ACME server unless <code>-Deactivate</code> is specified. But you won't be able to re-use the account on another system without an export of the account's key such as the one generated with <code>Export-PAAccountKey</code>.</p>"},{"location":"Functions/Remove-PAAccount/#examples","title":"Examples","text":""},{"location":"Functions/Remove-PAAccount/#example-1-remove-account","title":"Example 1: Remove Account","text":"<pre><code>Remove-PAAccount 12345\n</code></pre> <p>Remove the specified account without deactivation.</p>"},{"location":"Functions/Remove-PAAccount/#example-2-deactivate-and-remove","title":"Example 2: Deactivate and Remove","text":"<pre><code>Get-PAAccount | Remove-PAAccount -Deactivate -Force\n</code></pre> <p>Remove the current account after deactivating it and skip confirmation prompts.</p>"},{"location":"Functions/Remove-PAAccount/#parameters","title":"Parameters","text":""},{"location":"Functions/Remove-PAAccount/#-id","title":"-ID","text":"<p>The account id value as returned by the ACME server.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases: Name\n\nRequired: True\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAAccount/#-deactivate","title":"-Deactivate","text":"<p>If specified, a request will be sent to the associated ACME server to deactivate the account. Clients may wish to do this if the account key is compromised or decommissioned.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAAccount/#-force","title":"-Force","text":"<p>If specified, interactive confirmation prompts will be skipped.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAAccount/#-whatif","title":"-WhatIf","text":"<p>Shows what would happen if the cmdlet runs. The cmdlet is not run.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: wi\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAAccount/#-confirm","title":"-Confirm","text":"<p>Prompts you for confirmation before running the cmdlet.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: cf\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAAccount/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Remove-PAAccount/#related-links","title":"Related Links","text":"<p>Get-PAAccount</p> <p>New-PAAccount</p>"},{"location":"Functions/Remove-PAOrder/","title":"Remove-PAOrder","text":""},{"location":"Functions/Remove-PAOrder/#synopsis","title":"Synopsis","text":"<p>Remove an ACME order from the local profile.</p>"},{"location":"Functions/Remove-PAOrder/#syntax","title":"Syntax","text":"<pre><code>Remove-PAOrder [[-MainDomain] &lt;String&gt;] [[-Name] &lt;String&gt;] [-RevokeCert] [-Force] [-WhatIf] [-Confirm]\n [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Remove-PAOrder/#description","title":"Description","text":"<p>This function removes the order from the local profile which also removes any associated certificate/key. It will not remove or cleanup copies of the certificate that have been exported or installed elsewhere. It will not revoke the certificate unless <code>-RevokeCert</code> is specified. The ACME server may retain a reference to the order until it decides to delete it.</p> <p>Note</p> <p>Revoking a certificate is discouraged unless the private key is known to have been compromised. Revoking certs that simply aren't being used anymore is a waste of CA resources.</p>"},{"location":"Functions/Remove-PAOrder/#examples","title":"Examples","text":""},{"location":"Functions/Remove-PAOrder/#example-1-remove-order","title":"Example 1: Remove Order","text":"<pre><code>Remove-PAOrder example.com\n</code></pre> <p>Remove the specified order without revoking the certificate.</p>"},{"location":"Functions/Remove-PAOrder/#example-2-revoke-and-remove-all","title":"Example 2: Revoke and Remove All","text":"<pre><code>Get-PAOrder -List | Remove-PAOrder -RevokeCert -Force\n</code></pre> <p>Remove all orders associated with the current account, revoke all certificates, and skip confirmation prompts.</p>"},{"location":"Functions/Remove-PAOrder/#parameters","title":"Parameters","text":""},{"location":"Functions/Remove-PAOrder/#-maindomain","title":"-MainDomain","text":"<p>The primary domain for the order. For a SAN order, this was the first domain in the list when creating the order.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAOrder/#-name","title":"-Name","text":"<p>The name of the ACME order. This can be useful to distinguish between two orders that have the same MainDomain.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 2\nDefault value: None\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAOrder/#-revokecert","title":"-RevokeCert","text":"<p>If specified and there is a currently valid certificate associated with the order, the certificate will be revoked before deleting the order. This is not required, but generally a good practice if the certificate is no longer being used.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAOrder/#-force","title":"-Force","text":"<p>If specified, interactive confirmation prompts will be skipped.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAOrder/#-whatif","title":"-WhatIf","text":"<p>Shows what would happen if the cmdlet runs. The cmdlet is not run.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: wi\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAOrder/#-confirm","title":"-Confirm","text":"<p>Prompts you for confirmation before running the cmdlet.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: cf\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAOrder/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Remove-PAOrder/#related-links","title":"Related Links","text":"<p>New-PAOrder</p> <p>Revoke-PACertificate</p>"},{"location":"Functions/Remove-PAServer/","title":"Remove-PAServer","text":""},{"location":"Functions/Remove-PAServer/#synopsis","title":"Synopsis","text":"<p>Remove an ACME server and all associated accounts, orders, and certificates from the local profile.</p>"},{"location":"Functions/Remove-PAServer/#syntax","title":"Syntax","text":"<pre><code>Remove-PAServer [[-DirectoryUrl] &lt;String&gt;] [-Name &lt;String&gt;] [-DeactivateAccounts] [-Force] [-WhatIf] [-Confirm]\n [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Remove-PAServer/#description","title":"Description","text":"<p>This function removes the ACME server from the local profile which also removes any associated accounts, orders and certificates. It will not remove or cleanup copies of certificates that have been exported or installed elsewhere. It will not revoke any certificates. It will not deactivate the accounts on the ACME server unless the <code>-DeactivateAccounts</code> switch is specified.</p>"},{"location":"Functions/Remove-PAServer/#examples","title":"Examples","text":""},{"location":"Functions/Remove-PAServer/#example-1-remove-server","title":"Example 1: Remove Server","text":"<pre><code>Remove-PAServer LE_STAGE\n</code></pre> <p>Remove the specified server without deactivating accounts.</p>"},{"location":"Functions/Remove-PAServer/#example-2-remove-and-deactivate-accounts","title":"Example 2: Remove and Deactivate Accounts","text":"<pre><code>Get-PAServer | Remove-PAServer -DeactivateAccounts -Force\n</code></pre> <p>Remove the current server and deactivates accounts without confirmation.</p>"},{"location":"Functions/Remove-PAServer/#parameters","title":"Parameters","text":""},{"location":"Functions/Remove-PAServer/#-directoryurl","title":"-DirectoryUrl","text":"<p>Either the URL to an ACME server's \"directory\" endpoint or one of the supported short names. Currently supported short names include LE_PROD (LetsEncrypt Production), LE_STAGE (LetsEncrypt Staging), BUYPASS_PROD (BuyPass.com Production), BUYPASS_TEST (BuyPass.com Testing), and ZEROSSL_PROD (Zerossl.com Production).</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases: location\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAServer/#-name","title":"-Name","text":"<p>The name of the ACME server. The parameter is ignored if DirectoryUrl is specified.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAServer/#-deactivateaccounts","title":"-DeactivateAccounts","text":"<p>If specified, an attempt will be made to deactivate the accounts in this profile before deletion. Clients may wish to do this if the account key is compromised or being decommissioned.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAServer/#-force","title":"-Force","text":"<p>If specified, interactive confirmation prompts will be skipped.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAServer/#-whatif","title":"-WhatIf","text":"<p>Shows what would happen if the cmdlet runs. The cmdlet is not run.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: wi\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAServer/#-confirm","title":"-Confirm","text":"<p>Prompts you for confirmation before running the cmdlet.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: cf\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Remove-PAServer/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Remove-PAServer/#related-links","title":"Related Links","text":"<p>Get-PAServer</p> <p>Set-PAServer</p>"},{"location":"Functions/Revoke-PAAuthorization/","title":"Revoke-PAAuthorization","text":""},{"location":"Functions/Revoke-PAAuthorization/#synopsis","title":"Synopsis","text":"<p>Revoke the authorization associated with an ACME identifier.</p>"},{"location":"Functions/Revoke-PAAuthorization/#syntax","title":"Syntax","text":"<pre><code>Revoke-PAAuthorization [-AuthURLs] &lt;String[]&gt; [[-Account] &lt;Object&gt;] [-Force] [-WhatIf] [-Confirm]\n [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Revoke-PAAuthorization/#description","title":"Description","text":"<p>Many ACME server implementations cache succesful authorizations for a certain amount of time to avoid requiring an account to re-authorize identifiers for additional orders submitted during the cache window. This can make testing authorization challenges in a client more cumbersome by having to create new orders with uncached identifiers. </p> <p>This function allows you to revoke those cached authorizations so that subsequent orders will go through the full challenge validation process.</p>"},{"location":"Functions/Revoke-PAAuthorization/#examples","title":"Examples","text":""},{"location":"Functions/Revoke-PAAuthorization/#example-1-revoke-an-authorization","title":"Example 1: Revoke an Authorization","text":"<pre><code>Revoke-PAAuthorization https://acme.example.com/authz/1234567\n</code></pre> <p>Revoke the authorization for the specified URL using the current account.</p>"},{"location":"Functions/Revoke-PAAuthorization/#example-2-revoke-order-authorizations","title":"Example 2: Revoke Order Authorizations","text":"<pre><code>Get-PAOrder | Revoke-PAAuthorization -Force\n</code></pre> <p>Revoke all authorizations for the current order on the current account without confirmation prompts.</p>"},{"location":"Functions/Revoke-PAAuthorization/#example-3-revoke-all-order-authorizations","title":"Example 3: Revoke All Order Authorizations","text":"<pre><code>Get-PAOrder -List | Revoke-PAAuthorizations\n</code></pre> <p>Revoke all authorizations for all orders on the current account.</p>"},{"location":"Functions/Revoke-PAAuthorization/#parameters","title":"Parameters","text":""},{"location":"Functions/Revoke-PAAuthorization/#-authurls","title":"-AuthURLs","text":"<p>One or more authorization URLs. You also pipe in one or more PoshACME.PAOrder objects.</p> <pre><code>Type: String[]\nParameter Sets: (All)\nAliases: authorizations\n\nRequired: True\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Revoke-PAAuthorization/#-account","title":"-Account","text":"<p>An existing ACME account object such as the output from Get-PAAccount. If no account is specified, the current account will be used.</p> <pre><code>Type: Object\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 2\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Revoke-PAAuthorization/#-force","title":"-Force","text":"<p>If specified, no confirmation prompts will be presented.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Revoke-PAAuthorization/#-whatif","title":"-WhatIf","text":"<p>Shows what would happen if the cmdlet runs. The cmdlet is not run.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: wi\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Revoke-PAAuthorization/#-confirm","title":"-Confirm","text":"<p>Prompts you for confirmation before running the cmdlet.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: cf\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Revoke-PAAuthorization/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Revoke-PAAuthorization/#inputs","title":"Inputs","text":""},{"location":"Functions/Revoke-PAAuthorization/#systemstring","title":"System.String","text":"<p>The URI of the authorization object.</p>"},{"location":"Functions/Revoke-PAAuthorization/#related-links","title":"Related Links","text":"<p>Get-PAAuthorization</p> <p>Get-PAOrder</p>"},{"location":"Functions/Revoke-PACertificate/","title":"Revoke-PACertificate","text":""},{"location":"Functions/Revoke-PACertificate/#synopsis","title":"Synopsis","text":"<p>Revoke an ACME certificate</p>"},{"location":"Functions/Revoke-PACertificate/#syntax","title":"Syntax","text":""},{"location":"Functions/Revoke-PACertificate/#maindomain-default","title":"MainDomain (Default)","text":"<pre><code>Revoke-PACertificate [[-MainDomain] &lt;String&gt;] [-Name &lt;String&gt;] [-Reason &lt;RevocationReasons&gt;] [-Force] [-WhatIf]\n [-Confirm] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Revoke-PACertificate/#certfile","title":"CertFile","text":"<pre><code>Revoke-PACertificate -CertFile &lt;String&gt; [-KeyFile &lt;String&gt;] [-Reason &lt;RevocationReasons&gt;] [-Force] [-WhatIf]\n [-Confirm] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Revoke-PACertificate/#description","title":"Description","text":"<p>Any certificate created with the current ACME account can be revoked. If you need to revoke a certificate not created with the current account, you either need to specify both <code>CertFile</code> and <code>KeyFile</code>. If you don't have the private key, you will need to go through the authorization process on this account for all names in the certificate and just specify <code>CertFile</code>.</p> <p>Note</p> <p>Revoking a certificate is discouraged unless the private key is known to have been compromised. Revoking certs that simply aren't being used anymore is a waste of CA resources.</p>"},{"location":"Functions/Revoke-PACertificate/#examples","title":"Examples","text":""},{"location":"Functions/Revoke-PACertificate/#example-1-revoke-order-cert","title":"Example 1: Revoke Order Cert","text":"<pre><code>Get-PAOrder | Revoke-PACertificate -Force\n</code></pre> <p>Revokes the certificate associated with the current order and skips the confirmation prompt.</p>"},{"location":"Functions/Revoke-PACertificate/#example-2-revoke-with-reason","title":"Example 2: Revoke with Reason","text":"<pre><code>Get-PACertificate | Revoke-PACertificate -Reason keyCompromise\n</code></pre> <p>Revokes the current certificate with the specified reason.</p>"},{"location":"Functions/Revoke-PACertificate/#example-3-revoke-external-cert","title":"Example 3: Revoke External Cert","text":"<pre><code>Revoke-PACertificate -CertFile mycert.crt -KeyFile mycert.key\n</code></pre> <p>Revokes the specified cert using the specified private key.</p>"},{"location":"Functions/Revoke-PACertificate/#parameters","title":"Parameters","text":""},{"location":"Functions/Revoke-PACertificate/#-maindomain","title":"-MainDomain","text":"<p>The primary domain associated with the certificate to be revoked.</p> <pre><code>Type: String\nParameter Sets: MainDomain\nAliases:\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Revoke-PACertificate/#-name","title":"-Name","text":"<p>The name of the ACME order. This can be useful to distinguish between two orders that have the same MainDomain.</p> <pre><code>Type: String\nParameter Sets: MainDomain\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Revoke-PACertificate/#-certfile","title":"-CertFile","text":"<p>A PEM-encoded certificate file to be revoked.</p> <pre><code>Type: String\nParameter Sets: CertFile\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: None\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Revoke-PACertificate/#-keyfile","title":"-KeyFile","text":"<p>The PEM-encoded private key associated with CertFile. If not specified, the current ACME account will be used to sign the request.</p> <pre><code>Type: String\nParameter Sets: CertFile\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Revoke-PACertificate/#-reason","title":"-Reason","text":"<p>The reason for cert revocation. This must be one of the reasons defined in RFC 5280 including keyCompromise, cACompromise, affiliationChanged, superseded, cessationOfOperation, certificateHold, removeFromCRL, privilegeWithdrawn, and aACompromise. NOTE: Some reason codes are not supported by some ACME CAs.</p> <pre><code>Type: RevocationReasons\nParameter Sets: (All)\nAliases:\nAccepted values: keyCompromise, cACompromise, affiliationChanged, superseded, cessationOfOperation, certificateHold, removeFromCRL, privilegeWithdrawn, aACompromise\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Revoke-PACertificate/#-force","title":"-Force","text":"<p>If specified, the revocation confirmation prompt will be skipped.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Revoke-PACertificate/#-whatif","title":"-WhatIf","text":"<p>Shows what would happen if the cmdlet runs. The cmdlet is not run.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: wi\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Revoke-PACertificate/#-confirm","title":"-Confirm","text":"<p>Prompts you for confirmation before running the cmdlet.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: cf\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Revoke-PACertificate/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Revoke-PACertificate/#related-links","title":"Related Links","text":"<p>New-PACertificate</p>"},{"location":"Functions/Save-Challenge/","title":"Save-Challenge","text":""},{"location":"Functions/Save-Challenge/#synopsis","title":"Synopsis","text":"<p>Commit changes made by Publish-Challenge or Unpublish-Challenge.</p>"},{"location":"Functions/Save-Challenge/#syntax","title":"Syntax","text":"<pre><code>Save-Challenge [-Plugin] &lt;String&gt; [[-PluginArgs] &lt;Hashtable&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Save-Challenge/#description","title":"Description","text":"<p>Some validation plugins require a finalization step after the Publish or Unpublish functionality to commit and make the changes live. This function should be called once after running all of the <code>Publish-Challenge</code> or <code>Unpublish-Challenge</code> commands.</p> <p>For plugins that don't require a commit step, this function may still be run without causing an error, but has no effect.</p>"},{"location":"Functions/Save-Challenge/#examples","title":"Examples","text":""},{"location":"Functions/Save-Challenge/#example-1-commit-changes","title":"Example 1: Commit Changes","text":"<pre><code>$pArgs = @{ FDToken = (Read-Host 'FakeDNS API Token' -AsSecureString) }\nSave-Challenge -Plugin FakeDNS -PluginArgs $pArgs\n</code></pre> <p>Commit changes that the specified plugin has made.</p>"},{"location":"Functions/Save-Challenge/#parameters","title":"Parameters","text":""},{"location":"Functions/Save-Challenge/#-plugin","title":"-Plugin","text":"<p>The name of the validation plugin to use. Use Get-PAPlugin to display a list of available plugins.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: True\nPosition: 1\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Save-Challenge/#-pluginargs","title":"-PluginArgs","text":"<p>A hashtable containing the plugin arguments to use with the specified plugin. So if a plugin has a -MyText string and -MyNumber integer parameter, you could specify them as <code>@{MyText='text';MyNumber=1234}</code>.</p> <pre><code>Type: Hashtable\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 2\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Save-Challenge/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Save-Challenge/#related-links","title":"Related Links","text":"<p>Publish-Challenge</p> <p>Unpublish-Challenge</p> <p>Get-PAPlugin</p>"},{"location":"Functions/Send-ChallengeAck/","title":"Send-ChallengeAck","text":""},{"location":"Functions/Send-ChallengeAck/#synopsis","title":"Synopsis","text":"<p>Notify the ACME server to try validating a challenge.</p>"},{"location":"Functions/Send-ChallengeAck/#syntax","title":"Syntax","text":"<pre><code>Send-ChallengeAck [-ChallengeUrl] &lt;String&gt; [[-Account] &lt;Object&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Send-ChallengeAck/#description","title":"Description","text":"<p>Use this after publishing the required resource for one of the challenges from an authorization object. It lets the ACME server know that it should proceed validating that challenge. For ACME servers that allow retrying challenges, this can also be used to trigger a retry.</p>"},{"location":"Functions/Send-ChallengeAck/#examples","title":"Examples","text":""},{"location":"Functions/Send-ChallengeAck/#example-1-validate-challenge","title":"Example 1: Validate Challenge","text":"<pre><code>Send-ChallengeAck https://acme.example.com/chal/1234567\n</code></pre> <p>Validate a specific challenge URL.</p>"},{"location":"Functions/Send-ChallengeAck/#example-2-validate-pending-http-challenges","title":"Example 2: Validate Pending HTTP Challenges","text":"<pre><code>$auths = Get-PAOrder | Get-PAAuthorization\n$httpUrls = ($auths | ?{ $_.status -eq 'pending' }).HTTP01Url\n$httpUrls | Send-ChallengeAck\n</code></pre> <p>Tell the ACME server to validate all pending HTTP challenges in the current order.</p>"},{"location":"Functions/Send-ChallengeAck/#parameters","title":"Parameters","text":""},{"location":"Functions/Send-ChallengeAck/#-challengeurl","title":"-ChallengeUrl","text":"<p>The URL of the challenge to be validated.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: True\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Send-ChallengeAck/#-account","title":"-Account","text":"<p>The ACME account associated with the challenge.</p> <pre><code>Type: Object\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 2\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Send-ChallengeAck/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Send-ChallengeAck/#inputs","title":"Inputs","text":""},{"location":"Functions/Send-ChallengeAck/#systemstring","title":"System.String","text":"<p>The URI of an ACME challenge object.</p>"},{"location":"Functions/Send-ChallengeAck/#related-links","title":"Related Links","text":"<p>Get-PAAuthorization</p> <p>Submit-ChallengeValidation</p>"},{"location":"Functions/Set-PAAccount/","title":"Set-PAAccount","text":""},{"location":"Functions/Set-PAAccount/#synopsis","title":"Synopsis","text":"<p>Set the current ACME account and/or update account details.</p>"},{"location":"Functions/Set-PAAccount/#syntax","title":"Syntax","text":""},{"location":"Functions/Set-PAAccount/#edit-default","title":"Edit (Default)","text":"<pre><code>Set-PAAccount [[-ID] &lt;String&gt;] [[-Contact] &lt;String[]&gt;] [-NewName &lt;String&gt;] [-UseAltPluginEncryption]\n [-ResetAltPluginEncryption] [-Deactivate] [-Force] [-NoSwitch] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Set-PAAccount/#rolloverimportkey","title":"RolloverImportKey","text":"<pre><code>Set-PAAccount [[-ID] &lt;String&gt;] [-KeyRollover] -KeyFile &lt;String&gt; [-NoSwitch] [-WhatIf] [-Confirm]\n [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Set-PAAccount/#rollover","title":"Rollover","text":"<pre><code>Set-PAAccount [[-ID] &lt;String&gt;] [-KeyRollover] [-KeyLength &lt;String&gt;] [-NoSwitch] [-WhatIf] [-Confirm]\n [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Set-PAAccount/#description","title":"Description","text":"<p>This function allows you to switch between ACME accounts on a server. It also allows you to update the contact information associated with an account, deactivate the account, or replace the account key with a new one.</p> <p>Note</p> <p>Some ACME CAs do not support all types of account modifications.</p>"},{"location":"Functions/Set-PAAccount/#examples","title":"Examples","text":""},{"location":"Functions/Set-PAAccount/#example-1-switch-accounts","title":"Example 1: Switch Accounts","text":"<pre><code>Set-PAAccount -ID 1234567\n</code></pre> <p>Switch to the specified account.</p>"},{"location":"Functions/Set-PAAccount/#example-2-update-contact-email","title":"Example 2: Update Contact Email","text":"<pre><code>Set-PAAccount -Contact 'user1@example.com','user2@example.com'\n</code></pre> <p>Set new contacts for the current account.</p>"},{"location":"Functions/Set-PAAccount/#example-3-update-all-account-contacts","title":"Example 3: Update All Account Contacts","text":"<pre><code>Get-PAAccount -List | Set-PAAccount -Contact 'user1@example.com' -NoSwitch\n</code></pre> <p>Set a new contact for all known accounts without switching from the current.</p>"},{"location":"Functions/Set-PAAccount/#example-4-deactivate-account","title":"Example 4: Deactivate Account","text":"<pre><code>Set-PAAccount -Deactivate\n</code></pre> <p>Deactivate the current account.</p>"},{"location":"Functions/Set-PAAccount/#example-5-new-account-key","title":"Example 5: New Account Key","text":"<pre><code>Set-PAAccount -KeyRollover -KeyLength ec-384\n</code></pre> <p>Replace the current account key with a new ECC key using P-384 curve.</p>"},{"location":"Functions/Set-PAAccount/#example-6-new-external-account-key","title":"Example 6: New External Account Key","text":"<pre><code>Set-PAAccount -KeyRollover -KeyFile .\\mykey.key\n</code></pre> <p>Replace the current account key with a pre-generated private key.</p>"},{"location":"Functions/Set-PAAccount/#example-7-alternative-plugin-encryption","title":"Example 7: Alternative Plugin Encryption","text":"<pre><code># enable\nSet-PAAccount -UseAltPluginEncryption\n\n# disable\nSet-PAAccount -UseAltPluginEncryption:$false\n</code></pre> <p>Enable or Disable the alternative AES plugin encryption option for orders on this account.</p>"},{"location":"Functions/Set-PAAccount/#parameters","title":"Parameters","text":""},{"location":"Functions/Set-PAAccount/#-id","title":"-ID","text":"<p>The account id value as returned by the ACME server. If not specified, the function will attempt to use the currently active account.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases: Name\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAAccount/#-contact","title":"-Contact","text":"<p>One or more email addresses to associate with this account. These addresses will be used by the ACME server to send certificate expiration notifications or other important account notices.</p> <pre><code>Type: String[]\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: 2\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAAccount/#-newname","title":"-NewName","text":"<p>The new name (id) of this ACME account.</p> <pre><code>Type: String\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAAccount/#-usealtpluginencryption","title":"-UseAltPluginEncryption","text":"<p>If specified, the account will be configured to use a randomly generated AES key to encrypt sensitive plugin parameters on disk instead of using the OS's native encryption methods. This can be useful if the config is being shared across systems or platforms. You can revert to OS native encryption using <code>-UseAltPluginEncryption:$false</code>.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAAccount/#-resetaltpluginencryption","title":"-ResetAltPluginEncryption","text":"<p>If specified, the existing AES key will be replaced with a new one and existing plugin parameters on disk will be re-encrypted with the new key. If there is no existing key, this parameter is ignored.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAAccount/#-deactivate","title":"-Deactivate","text":"<p>If specified, a request will be sent to the associated ACME server to deactivate the account. Clients may wish to do this if the account key is compromised or decommissioned.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAAccount/#-force","title":"-Force","text":"<p>If specified, confirmation prompts for account deactivation will be skipped.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAAccount/#-keyrollover","title":"-KeyRollover","text":"<p>If specified, generate a new account key and replace the current one with it. Clients may choose to do this to recover from a key compromise or proactively mitigate the impact of an unnoticed key compromise.</p> <pre><code>Type: SwitchParameter\nParameter Sets: RolloverImportKey, Rollover\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAAccount/#-keylength","title":"-KeyLength","text":"<p>The type and size of private key to use. For RSA keys, specify a number between 2048-4096 (divisible by 128). For ECC keys, specify either 'ec-256' or 'ec-384'. Defaults to 'ec-256'.</p> <pre><code>Type: String\nParameter Sets: Rollover\nAliases: AccountKeyLength\n\nRequired: False\nPosition: Named\nDefault value: Ec-256\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAAccount/#-keyfile","title":"-KeyFile","text":"<p>The path to an existing EC or RSA private key file. This will attempt to use the specified key as the new ACME account key.</p> <pre><code>Type: String\nParameter Sets: RolloverImportKey\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAAccount/#-noswitch","title":"-NoSwitch","text":"<p>If specified, the currently active account will not change. Useful primarily for bulk updating contact information across accounts. This switch is ignored if no ID is specified.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAAccount/#-whatif","title":"-WhatIf","text":"<p>Shows what would happen if the cmdlet runs. The cmdlet is not run.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: wi\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAAccount/#-confirm","title":"-Confirm","text":"<p>Prompts you for confirmation before running the cmdlet.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: cf\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAAccount/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Set-PAAccount/#related-links","title":"Related Links","text":"<p>Get-PAAccount</p> <p>New-PAAccount</p>"},{"location":"Functions/Set-PAOrder/","title":"Set-PAOrder","text":""},{"location":"Functions/Set-PAOrder/#synopsis","title":"Synopsis","text":"<p>Switch to or modify an order.</p>"},{"location":"Functions/Set-PAOrder/#syntax","title":"Syntax","text":""},{"location":"Functions/Set-PAOrder/#edit-default","title":"Edit (Default)","text":"<pre><code>Set-PAOrder [[-MainDomain] &lt;String&gt;] [-Name &lt;String&gt;] [-NoSwitch] [-Plugin &lt;String[]&gt;]\n [-PluginArgs &lt;Hashtable&gt;] [-LifetimeDays &lt;Int32&gt;] [-DnsAlias &lt;String[]&gt;] [-NewName &lt;String&gt;]\n [-Subject &lt;String&gt;] [-FriendlyName &lt;String&gt;] [-PfxPass &lt;String&gt;] [-PfxPassSecure &lt;SecureString&gt;]\n [-UseModernPfxEncryption] [-Install] [-OCSPMustStaple] [-DnsSleep &lt;Int32&gt;] [-ValidationTimeout &lt;Int32&gt;]\n [-PreferredChain &lt;String&gt;] [-AlwaysNewKey] [-UseSerialValidation] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Set-PAOrder/#revoke","title":"Revoke","text":"<pre><code>Set-PAOrder [[-MainDomain] &lt;String&gt;] [-Name &lt;String&gt;] [-RevokeCert] [-Force] [-NoSwitch] [-WhatIf] [-Confirm]\n [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Set-PAOrder/#description","title":"Description","text":"<p>Switch to a specific ACME order and edit its properties or revoke its certificate. Orders with revoked certificates are not deleted and can be re-requested using Submit-Renewal or New-PACertificate.</p>"},{"location":"Functions/Set-PAOrder/#examples","title":"Examples","text":""},{"location":"Functions/Set-PAOrder/#example-1-switch-order","title":"Example 1: Switch Order","text":"<pre><code>Set-PAOrder example.com\n</code></pre> <p>Switch to the specified domain's order.</p>"},{"location":"Functions/Set-PAOrder/#example-2-revoke-certificate","title":"Example 2: Revoke Certificate","text":"<pre><code>Set-PAOrder -RevokeCert\n</code></pre> <p>Revoke the current order's certificate.</p>"},{"location":"Functions/Set-PAOrder/#example-3-update-plugin-args","title":"Example 3: Update Plugin Args","text":"<pre><code>$pArgs = @{ FDToken = (Read-Host 'FakeDNS API Token' -AsSecureString) }\nSet-PAOrder example.com -Plugin FakeDNS -PluginArgs $pArgs\n</code></pre> <p>Reset the plugin and its arguments for the specified order.</p>"},{"location":"Functions/Set-PAOrder/#parameters","title":"Parameters","text":""},{"location":"Functions/Set-PAOrder/#-maindomain","title":"-MainDomain","text":"<p>The primary domain for the order. For a SAN order, this was the first domain in the list when creating the order.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-name","title":"-Name","text":"<p>The name of the ACME order. This can be useful to distinguish between two orders that have the same MainDomain.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-revokecert","title":"-RevokeCert","text":"<p>If specified, a request will be sent to the associated ACME server to revoke the certificate on this order. Clients may wish to do this if the certificate is decommissioned or the private key has been compromised. A warning will be displayed if the order is not currently valid or the existing certificate file can't be found.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Revoke\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-force","title":"-Force","text":"<p>If specified, confirmation prompts for certificate revocation will be skipped.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Revoke\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-noswitch","title":"-NoSwitch","text":"<p>If specified, the currently selected order will not change. Useful primarily for bulk certificate revocation. This switch is ignored if no MainDomain is specified.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-plugin","title":"-Plugin","text":"<p>One or more validation plugin names to use for this order's challenges. If no plugin is specified, the DNS \"Manual\" plugin will be used. If the same plugin is used for all domains in the order, you can just specify it once. Otherwise, you should specify as many plugin names as there are domains in the order and in the same sequence as the order.</p> <pre><code>Type: String[]\nParameter Sets: Edit\nAliases: DnsPlugin\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-pluginargs","title":"-PluginArgs","text":"<p>A hashtable containing the plugin arguments to use with the specified Plugin list. So if a plugin has a -MyText string and -MyNumber integer parameter, you could specify them as <code>@{MyText='text';MyNumber=1234}</code>.</p> <pre><code>Type: Hashtable\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-dnsalias","title":"-DnsAlias","text":"<p>One or more FQDNs that DNS challenges should be published to instead of the certificate domain's zone. This is used in advanced setups where a CNAME in the certificate domain's zone has been pre-created to point to the alias's FQDN which makes the ACME server check the alias domain when validation challenge TXT records. If the same alias is used for all domains in the order, you can just specify it once. Otherwise, you should specify as many alias FQDNs as there are domains in the order and in the same sequence as the order.</p> <pre><code>Type: String[]\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-newname","title":"-NewName","text":"<p>The new name for this ACME order.</p> <pre><code>Type: String\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-subject","title":"-Subject","text":"<p>Sets the x509 \"Subject\" field in the certificate request that gets sent to the ACME server. By default, it is set to 'CN=FQDN' where 'FQDN' is the first name in the Domain parameter. For public certificate authorities issuing DV certificates, anything other than a DNS name from the list of domains will either be rejected or stripped from the finalized certificate.</p> <pre><code>Type: String\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-friendlyname","title":"-FriendlyName","text":"<p>The friendly name for the certificate and subsequent renewals. This will populate the \"Friendly Name\" field in the Windows certificate store when the PFX is imported. Must not be an empty string.</p> <pre><code>Type: String\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-pfxpass","title":"-PfxPass","text":"<p>The PFX password for the certificate and subsequent renewals. When the PfxPassSecure parameter is specified, this parameter is ignored.</p> <pre><code>Type: String\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-pfxpasssecure","title":"-PfxPassSecure","text":"<p>The PFX password for the certificate and subsequent renewals using a SecureString value. When this parameter is specified, the PfxPass parameter is ignored.</p> <pre><code>Type: SecureString\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-install","title":"-Install","text":"<p>Enables the Install switch for the order. Use -Install:$false to disable the switch on the order. This affects whether the module will automatically import the certificate to the Windows certificate store on subsequent renewals. It will not import the current certificate if it exists. Use Install-PACertificate for that purpose.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-ocspmuststaple","title":"-OCSPMustStaple","text":"<p>If specified, the certificate generated for this order will have the OCSP Must-Staple flag set.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-dnssleep","title":"-DnsSleep","text":"<p>Number of seconds to wait for DNS changes to propagate before asking the ACME server to validate DNS challenges.</p> <pre><code>Type: Int32\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: 0\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-validationtimeout","title":"-ValidationTimeout","text":"<p>Number of seconds to wait for the ACME server to validate the challenges after asking it to do so. If the timeout is exceeded, an error will be thrown.</p> <pre><code>Type: Int32\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: 0\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-preferredchain","title":"-PreferredChain","text":"<p>If the CA offers multiple certificate chains, prefer the chain with an issuer matching this Subject Common Name. If no match, the default offered chain will be used.</p> <pre><code>Type: String\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-alwaysnewkey","title":"-AlwaysNewKey","text":"<p>If specified, the order will be configured to always generate a new private key during each renewal. Otherwise, the old key is re-used if it exists.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-useserialvalidation","title":"-UseSerialValidation","text":"<p>If specified, the names in the order will be validated individually rather than all at once. This can significantly increase the time it takes to process validations and should only be used for plugins that require it. The plugin's usage guide should indicate whether it is required.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-whatif","title":"-WhatIf","text":"<p>Shows what would happen if the cmdlet runs. The cmdlet is not run.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: wi\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-confirm","title":"-Confirm","text":"<p>Prompts you for confirmation before running the cmdlet.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases: cf\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-lifetimedays","title":"-LifetimeDays","text":"<p>How long in days the certificate should be valid for. This will only affect future renewals of this order. NOTE: Many CAs do not support this feature and have fixed lifetime values. Some may ignore the request. Use a value of 0 to revert to the CAs default lifetime.</p> <pre><code>Type: Int32\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#-usemodernpfxencryption","title":"-UseModernPfxEncryption","text":"<p>If specified, PFX files generated from this order will use AES256 with SHA256 for the private key encryption instead of the default which is RC2-40-CBC. This can affect compatibility with some crypto libraries and tools. Most notably, OpenSSL 3.x requires the newer options to avoid using \"legacy\" mode. But it breaks compatibility with OpenSSL 1.0.x.</p> <pre><code>Type: SwitchParameter\nParameter Sets: Edit\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAOrder/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Set-PAOrder/#related-links","title":"Related Links","text":"<p>Get-PAOrder</p> <p>New-PAOrder</p>"},{"location":"Functions/Set-PAServer/","title":"Set-PAServer","text":""},{"location":"Functions/Set-PAServer/#synopsis","title":"Synopsis","text":"<p>Set the current ACME server and/or its configuration.</p>"},{"location":"Functions/Set-PAServer/#syntax","title":"Syntax","text":"<pre><code>Set-PAServer [[-DirectoryUrl] &lt;String&gt;] [-Name &lt;String&gt;] [-NewName &lt;String&gt;] [-SkipCertificateCheck]\n [-DisableTelemetry] [-UseAltAccountRefresh] [-DisableARI] [-NoRefresh] [-NoSwitch] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Set-PAServer/#description","title":"Description","text":"<p>Use this function to set the current ACME server or change a server's configuration settings.</p>"},{"location":"Functions/Set-PAServer/#examples","title":"Examples","text":""},{"location":"Functions/Set-PAServer/#example-1-server-short-name","title":"Example 1: Server Short Name","text":"<pre><code>Set-PAServer LE_PROD\n</code></pre> <p>Switch to the LetsEncrypt production server using the short name.</p>"},{"location":"Functions/Set-PAServer/#example-2-server-url","title":"Example 2: Server URL","text":"<pre><code>Set-PAServer -DirectoryUrl https://myacme.example.com/directory\n</code></pre> <p>Switch to the specified ACME server using the directory URL.</p>"},{"location":"Functions/Set-PAServer/#example-3-disable-telemetry","title":"Example 3: Disable Telemetry","text":"<pre><code>Set-PAServer -DisableTelemetry\n</code></pre> <p>Disable Posh-ACME telemetry collection for activity on the current ACME server.</p>"},{"location":"Functions/Set-PAServer/#example-4-enable-telemetry","title":"Example 4: Enable Telemetry","text":"<pre><code>Set-PAServer -DisableTelemetry:$false\n</code></pre> <p>Enable Posh-ACME telemetry collection for activity on the current ACME server.</p>"},{"location":"Functions/Set-PAServer/#parameters","title":"Parameters","text":""},{"location":"Functions/Set-PAServer/#-directoryurl","title":"-DirectoryUrl","text":"<p>Either the URL to an ACME server's \"directory\" endpoint or one of the supported short names. Currently supported short names include LE_PROD (LetsEncrypt Production), LE_STAGE (LetsEncrypt Staging), BUYPASS_PROD (BuyPass.com Production), BUYPASS_TEST (BuyPass.com Testing), and ZEROSSL_PROD (Zerossl.com Production).</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases: location\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAServer/#-name","title":"-Name","text":"<p>The name of the ACME server. The parameter is ignored if DirectoryUrl is specified.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAServer/#-newname","title":"-NewName","text":"<p>The new name of this ACME server.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAServer/#-skipcertificatecheck","title":"-SkipCertificateCheck","text":"<p>If specified, disable certificate validation while using this server. This should not be necessary except in development environments where you are connecting to a self-hosted ACME server.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAServer/#-disabletelemetry","title":"-DisableTelemetry","text":"<p>If specified, telemetry data will not be sent to the Posh-ACME team for actions associated with this server. The telemetry data that gets sent by default includes Posh-ACME version, PowerShell version, and generic OS platform (Windows/Linux/MacOS).</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAServer/#-norefresh","title":"-NoRefresh","text":"<p>If specified, the ACME server will not be re-queried for updated endpoints or a fresh nonce.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAServer/#-noswitch","title":"-NoSwitch","text":"<p>If specified, the currently active ACME server will not be changed to the server being modified.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAServer/#-usealtaccountrefresh","title":"-UseAltAccountRefresh","text":"<p>Some ACME CAs do not properly support the standard method to refresh account data. If specified, the module will use an alternate method to refresh account data that seems to work with these CAs.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAServer/#-disableari","title":"-DisableARI","text":"<p>Explicitly disables ARI (ACME Renewal Information) for this server even if it claims to support the feature. While the ARI RFC is still in draft status, this should only be necessary if ACME servers move to a newer draft version that breaks compatibility with the version currently supported (draft-03).</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Set-PAServer/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Set-PAServer/#related-links","title":"Related Links","text":"<p>Get-PAServer</p>"},{"location":"Functions/Submit-ChallengeValidation/","title":"Submit-ChallengeValidation","text":""},{"location":"Functions/Submit-ChallengeValidation/#synopsis","title":"Synopsis","text":"<p>Respond to authorization challenges for an ACME order and wait for the ACME server to validate them.</p>"},{"location":"Functions/Submit-ChallengeValidation/#syntax","title":"Syntax","text":"<pre><code>Submit-ChallengeValidation [[-Order] &lt;Object&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Submit-ChallengeValidation/#description","title":"Description","text":"<p>This function encapsulates the authorization validation cycle for challenges in a given order. It takes care of publishing the challenge records according to the order's plugin configuration, notifying the ACME server to validate the records, and cleaning up the challenge records whether the validation succeeded or not.</p> <p>If everything is successful, the order object will have transitioned from the <code>pending</code> state to the <code>ready</code> state which indicates it is ready for finalization using <code>Submit-OrderFinalize</code>.</p>"},{"location":"Functions/Submit-ChallengeValidation/#examples","title":"Examples","text":""},{"location":"Functions/Submit-ChallengeValidation/#example-1-current-order","title":"Example 1: Current Order","text":"<pre><code>Submit-ChallengeValidation\n</code></pre> <p>Begin challenge validation on the current order.</p>"},{"location":"Functions/Submit-ChallengeValidation/#example-2-specific-order","title":"Example 2: Specific Order","text":"<pre><code>Get-PAOrder -Name myorder | Submit-ChallengeValidation\n</code></pre> <p>Begin challenge validation on the specified order.</p>"},{"location":"Functions/Submit-ChallengeValidation/#parameters","title":"Parameters","text":""},{"location":"Functions/Submit-ChallengeValidation/#-order","title":"-Order","text":"<p>The ACME order to perform the validations against. The order object must be associated with the currently active ACME account.</p> <pre><code>Type: Object\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Submit-ChallengeValidation/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Submit-ChallengeValidation/#inputs","title":"Inputs","text":""},{"location":"Functions/Submit-ChallengeValidation/#poshacmepaorder","title":"PoshACME.PAOrder","text":"<p>An order object.</p>"},{"location":"Functions/Submit-ChallengeValidation/#related-links","title":"Related Links","text":"<p>New-PAOrder</p> <p>Submit-OrderFinalize</p>"},{"location":"Functions/Submit-OrderFinalize/","title":"Submit-OrderFinalize","text":""},{"location":"Functions/Submit-OrderFinalize/#synopsis","title":"Synopsis","text":"<p>Finalize a certificate order</p>"},{"location":"Functions/Submit-OrderFinalize/#syntax","title":"Syntax","text":"<pre><code>Submit-OrderFinalize [[-Order] &lt;Object&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Submit-OrderFinalize/#description","title":"Description","text":"<p>An ACME order that has reached the <code>ready</code> state is ready to be finalized which involves sending the certificate request to the ACME server so it can sign the certificate and transition the order into the <code>valid</code> state.</p>"},{"location":"Functions/Submit-OrderFinalize/#examples","title":"Examples","text":""},{"location":"Functions/Submit-OrderFinalize/#example-1-current-order","title":"Example 1: Current Order","text":"<pre><code>Submit-OrderFinalize\n</code></pre> <p>Finalize the current order.</p>"},{"location":"Functions/Submit-OrderFinalize/#example-2-specific-order","title":"Example 2: Specific Order","text":"<pre><code>Get-PAOrder example.com | Submit-OrderFinalize\n</code></pre> <p>Finalize the specified order.</p>"},{"location":"Functions/Submit-OrderFinalize/#parameters","title":"Parameters","text":""},{"location":"Functions/Submit-OrderFinalize/#-order","title":"-Order","text":"<p>The ACME order to finalize. The order object must be associated with the currently active ACME account.</p> <pre><code>Type: Object\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Submit-OrderFinalize/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Submit-OrderFinalize/#inputs","title":"Inputs","text":""},{"location":"Functions/Submit-OrderFinalize/#poshacmepaorder","title":"PoshACME.PAOrder","text":"<p>An order object.</p>"},{"location":"Functions/Submit-OrderFinalize/#related-links","title":"Related Links","text":"<p>Get-PAOrder</p> <p>Submit-ChallengeValidation</p>"},{"location":"Functions/Submit-Renewal/","title":"Submit-Renewal","text":""},{"location":"Functions/Submit-Renewal/#synopsis","title":"Synopsis","text":"<p>Renew one or more certificates.</p>"},{"location":"Functions/Submit-Renewal/#syntax","title":"Syntax","text":""},{"location":"Functions/Submit-Renewal/#specific","title":"Specific","text":"<pre><code>Submit-Renewal [[-MainDomain] &lt;String&gt;] [[-Name] &lt;String&gt;] [-Force] [-NoSkipManualDns]\n [-PluginArgs &lt;Hashtable&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Submit-Renewal/#allorders","title":"AllOrders","text":"<pre><code>Submit-Renewal [-AllOrders] [-Force] [-NoSkipManualDns] [-PluginArgs &lt;Hashtable&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Submit-Renewal/#allaccounts","title":"AllAccounts","text":"<pre><code>Submit-Renewal [-AllAccounts] [-Force] [-NoSkipManualDns] [-PluginArgs &lt;Hashtable&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Submit-Renewal/#description","title":"Description","text":"<p>Technically, a renewal is just a normal new certificate order using the same parameters as a previous order. This function allows you to easily request a new certificate for any existing order</p> <p>This function allows you to renew one more more previously complete orders as long as the renewal window has been reached and plugin configuration exists to automate the challenge validation. It will also pick up and attempt to continue pending or previously failed orders. You can choose to renew a specific order, set of orders, all orders for the current account, or all orders for all accounts.</p> <p>A PACertificate object is returned for every successfully renewed order.</p>"},{"location":"Functions/Submit-Renewal/#examples","title":"Examples","text":""},{"location":"Functions/Submit-Renewal/#example-1-renew-current","title":"Example 1: Renew Current","text":"<pre><code>Submit-Renewal\n</code></pre> <p>Renew the current order on the current account.</p>"},{"location":"Functions/Submit-Renewal/#example-2-force-specific-order","title":"Example 2: Force Specific Order","text":"<pre><code>Submit-Renewal example.com -Force\n</code></pre> <p>Renew the specified order on the current account even if it hasn't reached its suggested renewal window.</p>"},{"location":"Functions/Submit-Renewal/#example-3-all-orders","title":"Example 3: All Orders","text":"<pre><code>Submit-Renewal -AllOrders\n</code></pre> <p>Renew all valid orders on the current account that have reached their suggested renewal window.</p>"},{"location":"Functions/Submit-Renewal/#example-4-all-orders-on-all-accounts","title":"Example 4: All Orders on All Accounts","text":"<pre><code>Submit-Renewal -AllAccounts\n</code></pre> <p>Renew all valid orders on all valid accounts that have reached their suggested renewal window.</p>"},{"location":"Functions/Submit-Renewal/#example-5-update-pluginargs","title":"Example 5: Update PluginArgs","text":"<pre><code>$pArgs = @{ (Read-Host 'FakeDNS API Token' -AsSecureString) }\nSubmit-Renewal -PluginArgs $pArgs\n</code></pre> <p>Renew the current order using updated plugin args that will also be saved for subsequent renewals.</p>"},{"location":"Functions/Submit-Renewal/#parameters","title":"Parameters","text":""},{"location":"Functions/Submit-Renewal/#-maindomain","title":"-MainDomain","text":"<p>The primary domain associated with an order. This is the domain that goes in the certificate's subject.</p> <pre><code>Type: String\nParameter Sets: Specific\nAliases:\n\nRequired: False\nPosition: 1\nDefault value: None\nAccept pipeline input: True (ByPropertyName, ByValue)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Submit-Renewal/#-name","title":"-Name","text":"<p>The name of the ACME order. This can be useful to distinguish between two orders that have the same MainDomain.</p> <pre><code>Type: String\nParameter Sets: Specific\nAliases:\n\nRequired: False\nPosition: 2\nDefault value: None\nAccept pipeline input: True (ByPropertyName)\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Submit-Renewal/#-allorders","title":"-AllOrders","text":"<p>If specified, renew all valid orders on the current account. Orders that have not reached the renewal window will be skipped unless -Force is used.</p> <pre><code>Type: SwitchParameter\nParameter Sets: AllOrders\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Submit-Renewal/#-allaccounts","title":"-AllAccounts","text":"<p>If specified, renew all valid orders on all valid accounts in this profile. Orders that have not reached the renewal window will be skipped unless -Force is used.</p> <pre><code>Type: SwitchParameter\nParameter Sets: AllAccounts\nAliases:\n\nRequired: True\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Submit-Renewal/#-force","title":"-Force","text":"<p>If specified, an order that hasn't reached its renewal window will not throw an error and will not be skipped when using either of the -All parameters.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Submit-Renewal/#-noskipmanualdns","title":"-NoSkipManualDns","text":"<p>If specified, orders that utilize the Manual DNS plugin will not be skipped and user interaction may be required to complete the process. Otherwise, orders that utilize the Manual DNS plugin will be skipped.</p> <pre><code>Type: SwitchParameter\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: False\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Submit-Renewal/#-pluginargs","title":"-PluginArgs","text":"<p>A hashtable containing an updated set of plugin arguments to use with the renewal. So if a plugin has a <code>MyText</code> string and <code>MyNumber</code> integer parameter, you could specify them as <code>@{MyText='text';MyNumber=1234}</code>.</p> <pre><code>Type: Hashtable\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Submit-Renewal/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Submit-Renewal/#outputs","title":"Outputs","text":""},{"location":"Functions/Submit-Renewal/#poshacmepacertificate","title":"PoshACME.PACertificate","text":"<p>A certificate object.</p>"},{"location":"Functions/Submit-Renewal/#notes","title":"Notes","text":"<p>Certificate objects are only returned for orders that were actually renewed successfully. Any orders that have not reached the suggested renewal window are skipped unless <code>-Force</code> is specified.</p>"},{"location":"Functions/Submit-Renewal/#related-links","title":"Related Links","text":"<p>New-PACertificate</p> <p>Get-PAOrder</p>"},{"location":"Functions/Unpublish-Challenge/","title":"Unpublish-Challenge","text":""},{"location":"Functions/Unpublish-Challenge/#synopsis","title":"Synopsis","text":"<p>Unpublish a challenge using the specified plugin.</p>"},{"location":"Functions/Unpublish-Challenge/#syntax","title":"Syntax","text":"<pre><code>Unpublish-Challenge [-Domain] &lt;String&gt; [-Account] &lt;Object&gt; [-Token] &lt;String&gt; [-Plugin] &lt;String&gt;\n [[-PluginArgs] &lt;Hashtable&gt;] [-DnsAlias &lt;String&gt;] [&lt;CommonParameters&gt;]\n</code></pre>"},{"location":"Functions/Unpublish-Challenge/#description","title":"Description","text":"<p>Based on the type of validation plugin specified, this function will unpublish either a DNS TXT record or an HTTP challenge file for the given domain and token value that satisfies the dns-01 or http-01 challenge specification.</p> <p>Depending on the plugin, calling <code>Save-Challenge</code> may be required to commit changes made by <code>Unpublish-Challenge</code>. If multiple challenges are being unpublished, make all <code>Unpublish-Challenge</code> calls first. Then, <code>Save-Challenge</code> once to commit them all.</p>"},{"location":"Functions/Unpublish-Challenge/#examples","title":"Examples","text":""},{"location":"Functions/Unpublish-Challenge/#example-1-unpublish-a-challenge","title":"Example 1: Unpublish a Challenge","text":"<pre><code>$splat = @{\n    Domain = 'example.com'\n    Account = (Get-PAAccount)\n    Token = 'fake-token'\n    Plugin = 'FakeDNS'\n    PluginArgs = @{\n        FDToken = (Read-Host 'FakeDNS API Token' -AsSecureString)\n    }\n}\nUnpublish-Challenge @splat\n\n# if plugin requires saving\nSave-Challenge -Plugin $splat.Plugin -PluginArgs $splat.PluginArgs\n</code></pre> <p>Unpublish a single DNS challenge.</p>"},{"location":"Functions/Unpublish-Challenge/#example-2-dns-order-challenges","title":"Example 2: DNS Order Challenges","text":"<pre><code>$splat = @{\n    Account = (Get-PAAccount)\n    Plugin = 'FakeDNS'\n    PluginArgs = @{\n        FDToken = (Read-Host 'FakeDNS API Token' -AsSecureString)\n    }\n}\nGet-PAOrder | Get-PAAuthorization | ForEach-Object {\n    Unpublish-Challenge -Domain $_.DNSId -Token $_.DNS01Token @splat\n}\n\n# if plugin requires saving\nSave-Challenge -Plugin $splat.Plugin -PluginArgs $splat.PluginArgs\n</code></pre> <p>Unpublish DNS challenges for all authorizations in the current order.</p>"},{"location":"Functions/Unpublish-Challenge/#example-3-http-order-challenges","title":"Example 3: HTTP Order Challenges","text":"<pre><code>$splat = @{\n    Account = (Get-PAAccount)\n    Plugin = 'WebRoot'\n    PluginArgs = @{ WRPath = 'C:\\inetpub\\wwwroot' }\n}\nGet-PAOrder | Get-PAAuthorization | ForEach-Object {\n    Unpublish-Challenge -Domain $_.DNSId -Token $_.HTTP01Token @splat\n}\n\n# if plugin requires saving\nSave-Challenge -Plugin $splat.Plugin -PluginArgs $splat.PluginArgs\n</code></pre> <p>Unpublish HTTP challenges for all authorizations in the current order.</p>"},{"location":"Functions/Unpublish-Challenge/#parameters","title":"Parameters","text":""},{"location":"Functions/Unpublish-Challenge/#-domain","title":"-Domain","text":"<p>The domain name that the challenge will be unpublished for. Wildcard domains should have the \"*.\" removed and can only be used with DNS based validation plugins.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: True\nPosition: 1\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Unpublish-Challenge/#-account","title":"-Account","text":"<p>The account object associated with the order that required the challenge.</p> <pre><code>Type: Object\nParameter Sets: (All)\nAliases:\n\nRequired: True\nPosition: 2\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Unpublish-Challenge/#-token","title":"-Token","text":"<p>The token value from the appropriate challenge in an authorization object that matches the plugin type.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: True\nPosition: 3\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Unpublish-Challenge/#-plugin","title":"-Plugin","text":"<p>The name of the validation plugin to use. Use Get-PAPlugin to display a list of available plugins.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: True\nPosition: 4\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Unpublish-Challenge/#-pluginargs","title":"-PluginArgs","text":"<p>A hashtable containing the plugin arguments to use with the specified plugin. So if a plugin has a -MyText string and -MyNumber integer parameter, you could specify them as <code>@{MyText='text';MyNumber=1234}</code>.</p> <pre><code>Type: Hashtable\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: 5\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Unpublish-Challenge/#-dnsalias","title":"-DnsAlias","text":"<p>When using DNS Alias support with DNS validation plugins, the alias domain that the TXT record will be removed from. This should be the complete FQDN including the <code>_acme-challenge.</code> prefix if necessary. This field is ignored for non-DNS validation plugins.</p> <pre><code>Type: String\nParameter Sets: (All)\nAliases:\n\nRequired: False\nPosition: Named\nDefault value: None\nAccept pipeline input: False\nAccept wildcard characters: False\n</code></pre>"},{"location":"Functions/Unpublish-Challenge/#commonparameters","title":"CommonParameters","text":"<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see about_CommonParameters.</p>"},{"location":"Functions/Unpublish-Challenge/#related-links","title":"Related Links","text":"<p>Publish-Challenge</p> <p>Save-Challenge</p> <p>Get-PAPlugin</p>"},{"location":"Guides/","title":"Guides and Deep Dives","text":"<p>This section contains a variety of guides that explain some lesser known or more complicated features of Posh-ACME. It may also contain info about the general ACME ecosystem.</p>"},{"location":"Guides/ACME-CA-Comparison/","title":"ACME CA Comparison","text":"<p>As more public certificate authorities hop on the ACME bandwagon, it is important to understand the details and limitations of their implementations. This page will attempt to keep track of that data.</p>"},{"location":"Guides/ACME-CA-Comparison/#acme-ca-info","title":"ACME CA Info","text":"Let's\u00a0Encrypt BuyPass ZeroSSL SSL.com Google Free SAN Limit 100 names 5 names 100+ names 1 name + www 100+ names Free Wildcards Free Lifetime 90 days 180 days 90 days 90 days 1*-90 days IDN Support Chain Info Chains Roots \"Go SSL\" RSA Iss1/Iss2/RootECC Iss1/Iss2/Root RSA Iss/RootECC Iss/Root Iss/Root Rate Limits Policy Policy ?? ?? Policy Notes Service StatusStaging Environment Test Environment See Notes below See Warning below Staging EndpointQuick Start <ul> <li>Wildcard names (if supported) count towards Subject Alternative Name (SAN) limits.</li> <li><code>1 name + www</code> means one domain name plus its www name variant such as <code>example.com</code> and <code>www.example.com</code></li> <li>Using Let's Encrypt's ECDSA-only chain currently requires your ACME account be added to an allow-list. Otherwise, your ECDSA cert will be signed by the RSA chain.</li> <li>ZeroSSL supports a custom REST API that some clients use instead of pure ACME.</li> <li>SSL.com Warning: If your SSL.com account has funds available, you will be charged for a paid 1-year certificate instead of a free 90-day certificate. There is no known way to request only a free certificate.</li> <li>Google certs have a 90 day lifetime by default but can be requested for shorter lifetimes down to 1 day if supported by your ACME client. The recommended minimum lifetime is 3 days.</li> </ul>"},{"location":"Guides/ACME-CA-Comparison/#acme-spec-and-feature-support","title":"ACME Spec and Feature Support","text":"<p>Some of the features in the ACME protocol are optional. Others are mandatory but not yet supported by some implementations. Here is the status of those various features in each CA.</p> <p>Note</p> <p>Multi-perspective validation is not part of the ACME protocol but is an important security feature for the integrity of domain validation. SXG Support is also not part of the ACME protocol but is a notable feature among free ACME CAs.</p> Feature Let's\u00a0Encrypt BuyPass ZeroSSL SSL.com Google (EAB) ExternalAccount Binding n/a n/a Required Required Required* Multi-perspectiveValidation AccountKey Rollover * AccountDeactivation AccountOrders (Planned) * IP AddressIdentifiers (Planned) * Pre-Authorization AuthorizationDeactivation CertRevocation (Only using account key) ChallengeRetrying (Client must request retry) (Client must request retry) Variable Cert Lifetime SXG Support * ACME Renewal Information (ARI) draft-03 draft-03 <ul> <li> = Feature supported</li> <li> = Feature unsupported</li> <li> = Feature partially supported.</li> <li> = Support unknown or untested</li> <li>SSL.com throws \"Missing Authentication Token\" errors when making some calls against Account endpoints which is why those features are labeled Unsupported.</li> <li>SSL.com requires an email address in the ACME account contact field, but doesn't enforce it on creation time. Instead, it throws an \"badCSR\" error when you try to finalize an order from an account with an empty address.</li> <li>ZeroSSL does support IP address based certificates, but not via the ACME protocol.</li> <li>Google's EAB credentials can only be used once to establish a new ACME account and expire after 7 days if not used. Creating additional accounts requires generating new EAB credentials.</li> <li>For Google SXG Certificates, you must use a different ACME directory endpoint. https://dv-sxg.acme-v02.api.pki.goog/directory</li> </ul>"},{"location":"Guides/Custom-Challenge-Validation/","title":"Custom Challenge Validation","text":""},{"location":"Guides/Custom-Challenge-Validation/#intro","title":"Intro","text":"<p>The beauty of the ACME protocol is that it's an open standard. And while Posh-ACME primarily targets users who want to avoid understanding all of the protocol complexity, it also exposes functions that allow you to do things a bit closer to the protocol level than just running <code>New-PACertificate</code> and <code>Submit-Renewal</code>. This can enable more advanced automation scenarios such as supporting challenge types that the module doesn't directly support yet or responding to authorization challenges in a way not directly supported by existing plugins. This guide will walk through the ACME certificate request process and demonstrate how to manage the validation of authorization challenges.</p> <p>At a high level, the ACME conversation looks more or less like this:</p> <ul> <li>Create an account</li> <li>Create a certificate order</li> <li>Prove control of the \"identifiers\" (DNS names or IP addresses) in the requested cert by answering challenges.</li> <li>Finalize the order by submitting an certificate request (CSR)</li> <li>Download the signed certificate and chain</li> </ul> <p>Warning</p> <p>IP Address identifiers (RFC 8738) are supported by Posh-ACME. But they're not yet supported by any ACME-compatible public certificate authorities that I'm aware of. If you want to test them, you'll have to use Pebble.</p> <p>If you're curious about what's going on under the hood during this guide, add <code>-Verbose</code> to your commands or run <code>$VerbosePreference = 'Continue'</code>. If you really want to get deep, you can also turn on debug logging by running <code>$DebugPreference = 'Continue'</code> which will also display the raw JSON requests and responses. The defaults for both of those preferences are <code>SilentlyContinue</code> if you want to change them back later.</p>"},{"location":"Guides/Custom-Challenge-Validation/#server-selection","title":"Server Selection","text":"<p>While testing code, you should not use the production Let's Encrypt server. The staging server is the easiest alternative, but still has some rate limits that you can run afoul of if your code goes crazy. There is also Pebble which is a tiny ACME server you can self-host and is built for testing code against. For simplicity, we'll select the Let's Encrypt staging server.</p> <pre><code>Set-PAServer LE_STAGE\n</code></pre>"},{"location":"Guides/Custom-Challenge-Validation/#account-setup","title":"Account Setup","text":"<p>Requesting a certificate always starts with creating an account on the ACME server which is basically just a public/private key pair that is used to sign the protocol messages you send to the server along with some metadata like one or more email addresses to send expiration notifications to. If you've been previously using the module against the staging server, you likely already have an account. If so, you can either skip this section or create a second account which is also supported.</p> <pre><code>New-PAAccount -AcceptTOS -Contact 'me@example.com'\n</code></pre> <p>Warning</p> <p>If you're using Pebble as your ACME server, it doesn't save accounts or order details when you shut it down. So you'll have to re-create accounts and orders if you exit and restart it.</p>"},{"location":"Guides/Custom-Challenge-Validation/#create-an-order","title":"Create an Order","text":"<p>The only required parameter for a new order is the set of names you want included in the certificate. Optional parameters include things like <code>-KeyLength</code> to change the private key type/size, <code>-Install</code> which tells Posh-ACME to automatically store the signed cert in the Windows certificate store (requires local admin), and <code>-PfxPass</code> which lets you set the decryption password for the certificate PFX file. If we were using plugins, this is also where you could set which plugin to use and the parameters associated with it.</p> <p>In this example, we'll create a typical wildcard cert that contains a root domain and the wildcard version of it. Keep in mind that wildcard names require using DNS challenge validation. So if you're testing HTTP challenge validation, either leave that one out or add a different non-wildcard name.</p> <pre><code>$domains = 'example.com','*.example.com'\nNew-PAOrder $domains\n</code></pre> <p>Assuming you didn't use names that were previously validated on this account, you should get output that looks something like this where the status is <code>pending</code>. If the status is <code>ready</code>, create an order with different names that haven't been previously validated.</p> <pre><code>Name        MainDomain  status  KeyLength SANs            CertExpires Plugin\n----        ----------  ------  --------- ----            ----------- ------\nexample.com example.com pending 2048      {*.example.com}             {Manual}\n</code></pre>"},{"location":"Guides/Custom-Challenge-Validation/#authorizations-and-challenges","title":"Authorizations and Challenges","text":"<p>The distinction between an order, authorization, and challenge can be confusing if you're not familiar with the ACME protocol. So let's clarify first. An order is a request for a certificate that contains one or more \"identifiers\" (a name like <code>example.com</code>). Each identifier in an order has an authorization object associated with it that indicates whether the account that created the order is authorized to get a cert for that name. New authorizations start in a pending state awaiting the client to complete a challenge associated with that authorization. Each authorization can have multiple different challenges (DNS, HTTP, ALPN, etc) that indicate the different methods the ACME server will accept to prove ownership of the name. You only need to complete one of the offered challenges in order to satisfy an authorization.</p> <p>Note</p> <p>Different types of identifiers may only allow a subset of challenge types. For instance, wildcard DNS names can only be validated by a DNS challenge and IP addresses can only be validated by HTTP or ALPN challenges.</p> <p><code>Get-PAAuthorization</code> can be used with the output of <code>Get-PAOrder</code> to retrieve the current set of authorizations (and their challenges) for an order. So lets put those details into a variable and display them.</p> <pre><code>$auths = Get-PAOrder | Get-PAAuthorization\n$auths\n</code></pre> <p>This should give an output that looks something like this. The first status column is the overall status of the authorization. The last two columns are the status of the <code>dns-01</code> and <code>http-01</code> challenges. Normally the challenge specific details are buried a bit deeper in a <code>challenges</code> property, but Posh-ACME tries to help by surfacing the commonly used challenge details on the root object. Notice also how the wildcard name has no <code>HTTP01Status</code> because it was not offered as a valid challenge type for that identifier.</p> <pre><code>fqdn          status  Expires               DNS01Status HTTP01Status\n----          ------  -------               ----------- ------------\nexample.com   pending 12/24/2020 7:14:33 PM pending     pending\n*.example.com pending 12/24/2020 7:14:33 PM pending\n</code></pre> <p>Let's take a look at the full details of one of the authorization objects by running <code>$auths[0] | Format-List</code>. You should get an output like this:</p> <pre><code>identifier   : @{type=dns; value=example.com}\nstatus       : pending\nexpires      : 2020-12-25T16:52:23Z\nchallenges   : {@{type=dns-01; status=pending; url=https://acme-staging-v02.api.letsencrypt.org/acme/challenge/&lt;AUTH_ID&gt;/&lt;DNS_CHAL_ID&gt;; token=&lt;DNS_TOKEN&gt;},\n               @{type=http-01; status=pending; url=https://acme-staging-v02.api.letsencrypt.org/acme/challenge/&lt;AUTH_ID&gt;/&lt;HTTP_CHAL_ID&gt;; token=&lt;HTTP_TOKEN&gt;},\n               @{type=tls-alpn-01; status=pending; url=https://acme-staging-v02.api.letsencrypt.org/acme/challenge/&lt;AUTH_ID&gt;/&lt;ALPN_CHAL_ID&gt;; token=&lt;ALPN_TOKEN&gt;}}\nDNSId        : example.com\nfqdn         : example.com\nlocation     : https://acme-staging-v02.api.letsencrypt.org/acme/authz/&lt;AUTH_ID&gt;\nDNS01Status  : pending\nDNS01Url     : https://acme-staging-v02.api.letsencrypt.org/acme/challenge/&lt;AUTH_ID&gt;/&lt;DNS_CHAL_ID&gt;\nDNS01Token   : &lt;DNS_TOKEN&gt;\nHTTP01Status : pending\nHTTP01Url    : https://acme-staging-v02.api.letsencrypt.org/acme/challenge/&lt;AUTH_ID&gt;/&lt;HTTP_CHAL_ID&gt;\nHTTP01Token  : &lt;HTTP_TOKEN&gt;\n</code></pre> <p>For this identifier, the ACME server has offered all three challenge types: <code>http-01</code>, <code>dns-01</code>, and <code>tls-alpn-01</code>. In addition to the type, each challenge contains a <code>status</code>, <code>url</code> and <code>token</code> property. For HTTP and DNS challenges, these can also be read from the root authorization object using the <code>HTTP01xxx</code> and <code>DNS01xxx</code> properties. We'll go over how to use the tokens in the next couple sections about publishing challenges.</p>"},{"location":"Guides/Custom-Challenge-Validation/#publishing-an-http-challenge","title":"Publishing an HTTP Challenge","text":"<p>For an HTTP challenge, the ACME server must be able send an HTTP GET request to a particular URL on port 80 and receive a key authorization value which is based on the token value in the challenge and the public key thumbprint of your account key. You can build the URL using the following template:</p> <pre><code>$url = 'http://{0}/.well-known/acme-challenge/{1}' -f $auths[0].DNSId,$auths[0].HTTP01Token\n</code></pre> <p>Note</p> <p>Most ACME servers will follow HTTP 3xx redirect responses, but the initial request will always be non-TLS to port 80. So you must not block port 80 on your web server if you want to use HTTP challenges.</p> <p>The key authorization can be generated using <code>Get-KeyAuthorization</code> like this.</p> <pre><code>$keyauth = Get-KeyAuthorization $auths[0].HTTP01Token\n</code></pre> <p>Now it's up to you to setup your web server so it responds with the key authorization value when the URL is queried from the Internet. If it's only queryable from your internal LAN, the challenge validation will fail.</p> <p>Note</p> <p>If you're using PowerShell functions to create the challenge files, make sure to specify ASCII/ANSI file encoding. Line endings shouldn't matter, but the encoding does in my testing. So if you're using <code>Out-File</code>, add <code>-Encoding ascii</code>.</p>"},{"location":"Guides/Custom-Challenge-Validation/#publishing-a-dns-challenge","title":"Publishing a DNS Challenge","text":"<p>For a DNS challenge, the ACME server must be able send an TXT record query for a particular record name and receive a key authorization value in the response which is similar to the value it wants for an HTTP challenge. You can build the record name using the following template:</p> <pre><code>$recName = '_acme-challenge.{0}' -f $auths[1].DNSId\n</code></pre> <p>The key authorization can be generated using <code>Get-KeyAuthorization</code> like this. Note the extra <code>-ForDNS</code> parameter compared to the HTTP challenge and the reference to <code>DNS01Token</code> instead of <code>HTTP01Token</code>. Each challenge type within an authorization has a unique token value.</p> <pre><code>$keyauth = Get-KeyAuthorization $auths[1].DNS01Token -ForDNS\n</code></pre> <p>The astute reader may have realized that in our example, this means the name of the TXT record would be the same for both identifiers, <code>example.com</code> and <code>*.example.com</code>. They both translate to <code>_acme-challenge.example.com</code>. This tends to confuse people at first, but it's really no different than having multiple A records pointing to different IPs for a website. The ACME validation server is smart enough to check all of the returned results and find the one it cares about.</p> <p>Now it's up to you to publish the record on your DNS server that is queryable from the Internet. Depending on your DNS provider and its replication topology, it may take anywhere from seconds to minutes for the records you create to be queryable from the Internet. Make sure you either know how long it's supposed to take and wait that long before proceeding, or query your authoritative external nameservers directly until they return the expected results.</p> <p>Warning</p> <p>In DNS providers that use anycast even if you successfully query the nameserver for your record from your location, it may still fail from other locations in the world due to propagation delays. Some providers have an API you can query to know when it is fully propagated. Others don't and you just have to wait longer.</p> <p>Note</p> <p>ACME validation servers will also follow CNAME records to validate challenges. This can be useful if your primary DNS server has no API or the security posture of your organization doesn't allow an automated process such as an ACME client to have write access to the zone you need to create TXT records within. If you know this will be the case, you can create a permanent CNAME record for the <code>_acme-challenge.&lt;FQDN&gt;</code> name that points to another FQDN somewhere else. Then write your TXT record to that other target and as long as that zone is still Internet-facing, the validation will succeed.</p>"},{"location":"Guides/Custom-Challenge-Validation/#publishing-a-tls-alpn-challenge","title":"Publishing a TLS-ALPN Challenge","text":"<p>At the time of this writing, I don't know enough about ALPN to authoritatively write a section on how to use it. But I know it's dependent on the web server software you're using. Here is Let's Encrypt's documentation on the subject.</p>"},{"location":"Guides/Custom-Challenge-Validation/#notify-the-acme-server","title":"Notify the ACME Server","text":"<p>Now that you've published all of your key validations for all of your challenges, you're ready to ask the ACME server to check them. The requires the <code>url</code> property from the challenge you published which for HTTP/DNS challenges can also be read from <code>HTTP01Url</code> or <code>DNS01Url</code> on the root authorization object. Use the <code>Send-ChallengeAck</code> function like this.</p> <pre><code># if all of your challenges were published using the same challenge type such as HTTP\n$auths.HTTP01Url | Send-ChallengeAck\n\n# if you published challenges of different types, make sure to use the specific URLs associated with them\n$auths[0].HTTP01Url | Send-ChallengeAck\n$auths[1].DNS01Url | Send-ChallengeAck\n</code></pre> <p>The challenges are usually validated quickly. But there may be a delay if the ACME server is overloaded. You can poll the status of your authorizations by re-running <code>Get-PAOrder | Get-PAAuthorization</code>. Eventually, the status for each one will either be \"valid\" or \"invalid\". Good output should look something like this. Notice how the overall status for each challenge is <code>valid</code> while the individual challenge status is only valid for the specific challenge types we published.</p> <pre><code>fqdn          status  Expires               DNS01Status HTTP01Status\n----          ------  -------               ----------- ------------\nexample.com   valid   12/24/2020 7:14:33 PM             valid\n*.example.com valid   12/24/2020 7:14:33 PM valid\n</code></pre> <p>Note</p> <p>Some ACME CAs other than Let's Encrypt support the ability to re-validate authorizations that previously failed validation. In these cases, the status of those authorizations will remain <code>pending</code> instead of becoming <code>invalid</code>. Some CAs may periodically retry validation on their own. Others require you to run <code>Send-ChallengeAck</code> again to re-request validation.</p>"},{"location":"Guides/Custom-Challenge-Validation/#finishing-up","title":"Finishing Up","text":"<p>Now that you have all of your identifiers authorized, your order status should now be \"ready\" which you can check with <code>Get-PAOrder -Refresh</code>. It should look something like this.</p> <pre><code>Name        MainDomain  status  KeyLength SANs            CertExpires Plugin\n----        ----------  ------  --------- ----            ----------- ------\nexample.com example.com ready   2048      {*.example.com}             {Manual}\n</code></pre> <p>The next step is \"finalization\" in which you send a the actual x509 certificate request (CSR) to the ACME server. Run the following:</p> <pre><code>Submit-OrderFinalize\n</code></pre> <p>If you run <code>Get-PAOrder -Refresh</code> again, your order status should now be <code>valid</code> which means you're ready to download the final signed certificate. Run the following to let Posh-ACME take care of that and build the various combinations of PEM/PFX files.</p> <pre><code>Complete-PAOrder\n</code></pre> <p>This will also output the final certificate details that should look something like this.</p> <pre><code>Subject         NotAfter             KeyLength Thumbprint                               AllSANs\n-------         --------             --------- ----------                               -------\nCN=example.com  3/15/2021 4:37:37 PM 2048      XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX {example.com, *.example.com}\n</code></pre> <p>It is also the same output you get from <code>Get-PACertificate</code>. Run <code>Get-PACertificate | Format-List</code> to get a full list of cert properties including the filesystem paths where the files are stored.</p>"},{"location":"Guides/Custom-Challenge-Validation/#debugging-challenge-failures","title":"Debugging Challenge Failures","text":"<p>If for some reason one or more of your challenge validations failed, you can retrieve the error details from the ACME server like this.</p> <pre><code>(Get-PAOrder | Get-PAAuthorization).challenges.error | Format-List\n</code></pre>"},{"location":"Guides/Custom-Challenge-Validation/#revoking-authorizations","title":"Revoking Authorizations","text":"<p>Let's Encrypt and other ACME CAs will generally cache authorizations associated with an account for a period of time. Let's Encrypt caches them for around 30 days which means that if you request another cert in that timeframe with an identifier/name that you've already authorized, the authorization objects won't need to be re-validated. Their status will be immediately valid.</p> <p>This can be annoying if you're trying to test your challenge validation automation. However, you can revoke your existing authorizations for a given order like this:</p> <pre><code># NOTE: Without -Force, there will be a confirmation prompt for each name being revoked.\nGet-PAorder | Revoke-PAAuthorization -Force\n</code></pre> <p>This process does not revoke the certificate. It only revokes the authorizations so that you need to re-validate those names when you request a new certificate that contains them.</p>"},{"location":"Guides/Custom-Challenge-Validation/#renewals","title":"Renewals","text":"<p>The concept of a renewal doesn't actually exist in the ACME protocol. What most clients call a renewal is just a new order with the same parameters as last time. So the only thing extra you need to deal with is knowing when to renew. When you successfully complete a certificate order, Posh-ACME will attach a <code>RenewAfter</code> property to the order object which you can use to calculate whether it's time to renew or not. The property is an ISO 8601 date/time string which can be parsed and checked with <code>DateTimeOffset</code> like this.</p> <pre><code>$renewAfter = [DateTimeOffset]::Parse((Get-PAOrder).RenewAfter)\nif ([DateTimeOffset]::Now -gt $renewAfter) {\n    # time to renew\n}\n</code></pre> <p>Note</p> <p>The RenewAfter value is just a suggestion based on the lifetime of the certificate. Technically, you can renew whenever you want. But if you renew the same certificate too often, you might run into rate limits with your CA.</p>"},{"location":"Guides/Environment-Variable-Reference/","title":"Environment Variable Reference","text":"<p>Posh-ACME supports a few environment variables that can change the module's behavior. Some must be defined prior to the initial import of the module into your PowerShell session. If the module is already loaded when you set them, you can force a reload using <code>Import-Module Posh-ACME -Force</code>.</p> <p>Here is a reference for what is currently supported.</p> Name MinimumPosh-ACME Version Required atModule Load Description POSHACME_HOME 3.2.0 Change the default config location. (Guide) POSHACME_PLUGINS 4.7.0 Load custom plugins. (Guide) POSHACME_SHOW_PROGRESS 4.11.0 Show progress bar during DNS propagation delay timer. Must exist as any non-null or empty value. POSHACME_VAULT_NAME 4.11.0 SecretManagement Vault Name to store Posh-ACME secrets. (Guide) POSHACME_VAULT_PASS 4.11.0 (Optional) Password required to unlock the vault specified by POSHACME_VAULT_NAME. POSHACME_VAULT_SECRET_TEMPLATE 4.11.0 (Optional) Template used to name the Posh-ACME created secrets. Default is <code>poshacme-{0}-sskey</code> and <code>{0}</code> is replaced by a per-account vault GUID."},{"location":"Guides/External-Account-Binding/","title":"External Account Binding","text":"<p>Some ACME certificate authorities such as ZeroSSL and ssl.com have an existing account management system separate from ACME accounts. In order to create a new ACME account with these providers you must register with some extra information in order to link the new ACME account with the external account. This is known as External Account Binding (EAB).</p>"},{"location":"Guides/External-Account-Binding/#get-eab-credentials","title":"Get EAB Credentials","text":"<p>You will obviously need to have or sign up for an account with the CA first in order to bind your ACME account to it. These providers will usually have some sort of API management page to generate or view EAB credentials for ACME use. Searching \"ACME\" in their support site is a good way to find it.</p> <p>The credentials will include at least two values. The first is a \"Key\" or \"Key ID\" that could be any string value. The second is \"HMAC\" or \"HMAC Key\" that is a Base64 encoded value. Rarely, they may also provide an HMAC algorithm identifier such as <code>HS256</code> or <code>HMAC with SHA-256</code>.</p> <p>Note</p> <p>Some providers allow you to re-use EAB credentials to create multiple ACME accounts. Others require a new set of EAB credentials be generated for each ACME account.</p>"},{"location":"Guides/External-Account-Binding/#creating-the-acme-account","title":"Creating the ACME Account","text":"<p>EAB parameters are only supported on <code>New-PAAccount</code>, so you won't be able to use <code>New-PACertificate</code> until you create the account separately. Here's an example.</p> <pre><code>$eabKID = 'xxxxxxxx'\n$eabHMAC = 'yyyyyyyy'\nNew-PAAccount -ExtAcctKID $eabKID -ExtAcctHMACKey $eabHMAC -Contact 'me@example.com' -AcceptTOS\n</code></pre> <p>If they provided an algorithm identifier other than <code>HS256</code>, you would specify it using <code>-ExtAcctAlgorithm</code>. Posh-ACME supports <code>HS256</code>, <code>HS384</code> and <code>HS512</code>.</p> <p>Once the account is created, you can proceed to create new orders and certificates as normal. You won't need the EAB credentials again unless you're creating a new account or possibly recovering an existing account on another system.</p>"},{"location":"Guides/External-Articles/","title":"External Articles","text":"<p>Using Let's Encrypt for Active Directory Domain Controller Certificates</p> <p>Using Let\u2019s Encrypt certificates with Windows Admin Center</p> <p>Connect to a Windows server with RD Gateway using a Let's Encrypt certificate</p> <p>Certificates in the time of Let's Encrypt</p> <p>Let\u2019s Encrypt, IIS Central Cert Store and Powershell</p> <p>Generate LetsEncrypt signed certificates and upload to Azure Key Vault</p> <p>Automating certificate management with Azure and Let\u2019s Encrypt</p> <p>How to use Azure Automation to issue Let's Encrypt certificates</p> <p>Automate the Installation and Renewal of Let\u2019s Encrypt SSL Certificates in Azure</p> <p>Securing VMware Horizon UAGs with Let\u2019s Encrypt SSL certificates</p> <p>Automate Free SSL Certificate Replacement for vCenter 7</p> <p>Automate SSL Certificates in Veeam Cloud Connect</p>"},{"location":"Guides/Find-Deprecated-PluginArgs/","title":"Find Deprecated PluginArgs","text":"<p>Posh-ACME 4.8 has deprecated the old \"insecure\" plugin parameter sets that used to be necessary on non-Windows machines running early versions of PowerShell 6. This means that when Posh-ACME 5.0 is eventually released, certificate orders renewing with those parameter sets will stop working if they haven't been replaced by a \"secure\" parameter set. So it would be wise to update those parameters sooner rather than later.</p> <p>In most cases, migrating to a secure parameter set is just a matter of using a SecureString version of a token, key, or password instead of a standard String object. It might also mean using a PSCredential object instead of separate Username and Password parameters. The usage guide for each plugin will detail exactly what to use.</p> <p>If you have a lot of accounts or orders, particularly if they use different plugins, it may be a tedious process to find the orders that are using the deprecated parameters. Here's a function to help find those orders more easily.</p> <p>Warning</p> <p>The function assumes you've already installed Posh-ACME 4.8 or later which may also be required in order to migrate to the secure parameter sets that were added in 4.8.</p> <pre><code>function Find-DeprecatedPluginArgs {\n    [CmdletBinding()]\n    param()\n\n    # build a list of parameter names that we know are deprecated\n    $badParams = @(\n        'AKClientSecretInsecure'\n        'AliSecretInsecure'\n        'AutoDNSPasswordInsecure'\n        'AZPfxPass'\n        'AZAppPasswordInsecure'\n        'BlueCatPassword'\n        'CFAuthKey'\n        'CFTokenInsecure'\n        'CDPasswordInsecure'\n        'DSTokenInsecure'\n        'DMESecretInsecure'\n        'DSTokenInsecure'\n        'DNSPodKeyTokenInsecure'\n        'DOToken'\n        'DomOffTokenInsecure'\n        'DomeneshopSecretInsecure'\n        'DreamhostApiKey'\n        'DuckTokenInsecure'\n        'DynuSecret'\n        'EDKey'\n        'FDPassword'\n        'GandiTokenInsecure'\n        'GDSecret'\n        'HetznerTokenInsecure'\n        'HEPassword'\n        'IBMKey'\n        'IBPassword'\n        'InfomaniakTokenInsecure'\n        'LITokenInsecure'\n        'LoopiaPassInsecure'\n        'LuaPassword'\n        'NCApiKeyInsecure'\n        'NameComToken'\n        'NameSiloKeyInsecure'\n        'NS1KeyInsecure'\n        'OVHAppSecretInsecure'\n        'OVHConsumerKeyInsecure'\n        'PDKeyInsecure'\n        'RSApiKeyInsecure'\n        'RegRuPwdInsecure'\n        'DDNSKeyValueInsecure'\n        'R53SecretKeyInsecure'\n        'SelectelAdminTokenInsecure'\n        'SdnsPassword'\n        'SimplyAPIKeyInsecure'\n        'YDAdminTokenInsecure'\n        'ZonomiApiKey'    \n    )\n\n    $results = foreach ($server in (Get-PAServer -List)) {\n        Write-Verbose \" Server: $($server.Name)\"\n        try { $server | Set-PAServer }\n        catch {\n            Write-Warning \"Failed to set server $($server.Name)\"\n            continue \n        }\n\n        foreach ($acct in (Get-PAAccount -List)) {\n            Write-Verbose \"Account: $($acct.id)\"\n            try { $acct | Set-PAAccount }\n            catch {\n                Write-Warning \"Failed to set account $($acct.id)\"\n                continue\n            }\n\n            foreach ($order in (Get-PAOrder -List)) {\n                $paNames = ($order | Get-PAPluginArgs).Keys | ForEach-Object {$_}\n                if (-not $paNames) { continue }\n\n                if ($badMatches = Compare-Object $paNames $badParams -ExcludeDifferent -IncludeEqual) {\n                    [pscustomobject]@{\n                        ServerName = $server.Name\n                        AccountID = $acct.id\n                        OrderName = $order.Name\n                        Plugin = $order.Plugin\n                        DeprecatedParams = $badMatches.InputObject -join ','\n                    }\n                }\n            }\n        }\n    }\n    $results\n}\n</code></pre>"},{"location":"Guides/Troubleshooting-DNS-Validation/","title":"Troubleshooting DNS Validation","text":""},{"location":"Guides/Troubleshooting-DNS-Validation/#overview","title":"Overview","text":"<p>One of the more common problems using DNS challenge validation with ACME is when the server thinks your TXT records either don't exist or are invalid. There are a number of reasons why this might be the case and in this guide, we'll go over some of the possibilities. But first, let's review how to query TXT records.</p>"},{"location":"Guides/Troubleshooting-DNS-Validation/#querying-txt-records","title":"Querying TXT records","text":"<p><code>nslookup</code> is the primary tool most people use to do DNS queries from Windows because it's installed by default and available on every Windows OS since basically forever. PowerShell has <code>Resolve-DnsName</code> but only since Windows 8/2012. So we'll focus on <code>nslookup</code> for now.</p> <pre><code>C:\\&gt;nslookup -q=txt _acme-challenge.example.com.\n</code></pre> <p>Don't forget the final <code>.</code> on the domain name.</p> <p>This is the basic command that will query your local DNS server. But it's usually wise to specifically query a public DNS resolver like Google (8.8.8.8) or CloudFlare (1.1.1.1) in case you're in a split-brain DNS environment. However, some businesses are starting to deploy firewalls that block outbound DNS requests like this. So make sure you are able to query a known good record before tearing your hair out troubleshooting the record you're having trouble with. Here's how to explicitly query an external resolver.</p> <pre><code>C:\\&gt;nslookup -q=txt _acme-challenge.example.com. 1.1.1.1\n</code></pre> <p>If the query was successful, the output might look something like this:</p> <pre><code>Server:  1dot1dot1dot1.cloudflare-dns.com\nAddress:  1.1.1.1\n\nNon-authoritative answer:\n_acme-challenge.example.com    text =\n\n        \"asdfa7sdcv6qn4klav7127134\"\n</code></pre> <p>Otherwise, it will be more like this: <pre><code>Server:  1dot1dot1dot1.cloudflare-dns.com\nAddress:  1.1.1.1\n\n*** 1dot1dot1dot1.cloudflare-dns.com can't find _acme-challenge.example.com: Non-existent domain\n</code></pre></p>"},{"location":"Guides/Troubleshooting-DNS-Validation/#dns-propagation-delays","title":"DNS Propagation Delays","text":"<p>In many environments, the DNS server you are adding records to is not the same server that the Internet is sending queries to. Depending on the server and the DNS architecture, there may be both database replication delays and DNS zone transfer delays to slave servers.</p> <p>By default, Posh-ACME sleeps for 2 minutes after writing TXT records for a certificate before it asks the ACME server to validate them. But 2 minutes might not be long enough for your particular environment. In that case, use the <code>-DnsSleep</code> parameter to modify the default sleep time. It takes a value in seconds. So if you needed 5 minutes, you'd use <code>-DnsSleep 300</code>.</p> <p>And rather than just blindly increasing the delay when you're having a problem, it's a good idea to actually measure instead.</p> <ul> <li>Manually create a record</li> <li>Start a timer</li> <li>Query the record every few seconds until you see the change</li> <li>Make a note of the total time</li> <li>Add a 30 second buffer or so and use that value for <code>-DnsSleep</code></li> </ul> <p>If you never see the change, it's possible you're having a different problem.</p>"},{"location":"Guides/Troubleshooting-DNS-Validation/#internal-vs-external-dns","title":"Internal vs External DNS","text":"<p>Particularly in business environments, it is common to have a split-brain DNS architecture which basically means there might be two different \"views\" of a particular zone, one internal and one external. The internal view might resolve <code>example.com</code> to an internal IP like <code>10.0.0.50</code>. But the external view for the same name might resolve to public IP like <code>203.0.113.50</code>.</p> <p>Make sure that you only add your DNS challenge TXT records to the External view because that's the one the ACME server will be able to see.</p>"},{"location":"Guides/Troubleshooting-DNS-Validation/#caa-record-issues","title":"CAA Record Issues","text":"<p>CAA is a relatively new type of DNS record that allows site owners to specify which Certificate Authorities (CAs) are allowed to issue certificates containing their domain names. Let's Encrypt, being a well behaved CA, tries to validate CAA records before issuing a certificate for a domain. So if you have a CAA record that is not correctly set to to allow Let's Encrypt, your challenge validation would fail. But there are a number of reasons why it might fail even if you are not using CAA records in your zone. Check Let's Encrypt's CAA document for more information.</p>"},{"location":"Guides/Using-Alternate-Trust-Chains/","title":"Using Alternate Trust Chains","text":"<p>The ACME protocol allows for a CA to offer alternate trust chains in order to accommodate the natural lifecycle of Root and Issuing certificates. As of this writing, the only public ACME CA that currently offers alternate trust chains is Let's Encrypt. But the instructions in this guide should work for any ACME CA.</p>"},{"location":"Guides/Using-Alternate-Trust-Chains/#lets-encrypt-options","title":"Let's Encrypt Options","text":"<p>To understand why Let's Encrypt is offering multiple trust chains and why you as a site/service operator would choose one or the other, it is helpful to read the following posts:</p> <ul> <li>DST Root CA X3 Expiration (September 2021)</li> <li>Extending Android Device Compatibility for Let's Encrypt Certificates</li> <li>Production Chain Changes</li> <li>Shortening the Let's Encrypt Chain of Trust</li> </ul> <p>Your default choice is currently the longer chain that builds to the expired <code>DST Root CA X3</code> self-signed certificate which should be compatible with almost all Android devices until 2024. The alternate choice is the shorter chain that builds to the <code>ISRG Root X1</code> self-signed certificate which doesn't expire until 2035.</p> <p>Ultimately, your choice should depend on the clients that are connecting to your service. But if you don't know, it's probably safest to just leave the default. Let's Encrypt also has a Certificate Compatibility page that can help.</p> <p>It is also a perfectly valid option to switch to a different public ACME CA either permanently or until the dust settles on the DST Root expiration.</p>"},{"location":"Guides/Using-Alternate-Trust-Chains/#picking-an-alternate-chain","title":"Picking an Alternate Chain","text":"<p><code>New-PACertificate</code>, <code>New-PAOrder</code>, and <code>Set-PAOrder</code> all have a <code>-PreferredChain</code> parameter that work the same way. You provide the common name of a certificate in the chain you want to select. For Let's Encrypt, that would be <code>ISRG Root X1</code> even though it exists in both chains. The alternate chain wins because that cert is closer to the root (it is the root) than the default chain.</p> <p>Here's an example of getting a new cert with the alternate chain using splatting.</p> <pre><code>$certParams = @{\n    Domain = '*.example.com','example.com'\n    AcceptTOS = $true\n    Contact = 'admin@example.com'\n    Plugin = 'FakeDNS'\n    PluginArgs = @{\n        FDToken = (Read-Host 'FakeDNS API Token' -AsSecureString)\n    }\n    PreferredChain = 'ISRG Root X1'\n}\nNew-PACertificate @certParams\n</code></pre> <p>You can also modify an existing order to use the alternate chain which will change both the current certificate files (if they exist) and future renewals.</p> <pre><code>Set-PAOrder -Name 'example.com' -PreferredChain 'ISRG Root X1'\n</code></pre> <p>Warning</p> <p>Changing the chain on an existing certificate will only update the files in the Posh-ACME order folder. Even if the order has the <code>Install</code> property set to <code>$true</code>, it will not re-import the current certificate to the Windows certificate store. It will only do that on the next renewal.</p>"},{"location":"Guides/Using-Alternate-Trust-Chains/#serving-the-alternate-chain-from-windows","title":"Serving the Alternate Chain from Windows","text":"<p>Warning</p> <p>As of February 2023, the instructions in this section no longer work on up-to-date Windows instances because Microsoft issued a trust store update that explicitly disallows the system to use the expired <code>DST Root CA X3</code> cert. However, the instructions will remain for future reference and historical purposes.</p> <p>While the <code>-PreferredChain</code> option will make Posh-ACME download the alternate chain for the files in your config, you may notice that on Windows your website/application is still serving the default chain. Unlike many Linux applications that have explicit configuration options for chain configuration, applications that use the Windows certificate store usually rely on the underlying operating system to decide what chain to serve with the leaf certificate.</p> <p>There does not seem to be a way to differentiate the chains being served based on application. All websites and applications using leaf certs from the same Intermediate CA will serve the same chain. But it is possible to influence which chain based on the by manipulating the contents of the various Windows trust stores.</p> <p>The default chain that Windows picks for an LE cert following the expiration of <code>DST Root CA X3</code> is actually Let's Encrypt's shorter \"alternate\" chain which does not include the cross-signed copy of <code>ISRG Root X1</code> needed for old Android compatibility. Convincing Windows to serve Let's Encrypt's longer \"default\" chain that does support old Android devices currently requires a hack that involves un-trusting the legitimate self-signed <code>ISRG Root X1</code> on the user account hosting your service. In the case of IIS, that usually means the local SYSTEM account.</p> <p>There are a number of different ways to make the modifications, but generally speaking the following needs to happen in the cert stores associated with the user running the service.</p> <ul> <li>Add the self-signed ISRG Root X1 certificate to <code>Untrusted Certificates</code>.</li> <li>Add the cross-signed ISRG Root X1 certificate to <code>Intermediate Certification Authorities</code>.</li> <li>Add the current R3 certificate to <code>Intermediate Certification Authorities</code>. (This one may already exist here)</li> </ul> <p>Warning</p> <p>This process is an unsupported hack and will partially break certificate validation against sites/services using Let's Encrypt certificates when accessed by software or web browsers on this user account. It should not affect validation for other users on the system.</p>"},{"location":"Guides/Using-Alternate-Trust-Chains/#option-1-manually-using-psexec","title":"Option 1: Manually using PsExec","text":"<ul> <li>Download the 3 certificates linked above (2 versions of ISRG Root X1 and a copy of R3)</li> <li>Download Microsoft's PsExec utility and run the following from an admin prompt to open the Certificate Manager for the SYSTEM user.</li> </ul> <pre><code>psexec.exe -i -s certmgr.msc\n</code></pre> <ul> <li>Navigate to <code>Untrusted Certificates</code> and expand</li> <li>Right click it, select <code>All Tasks</code> - <code>Import</code></li> <li>Browse to the self-signed ISRG Root X1 you downloaded and complete the wizard to import it</li> <li>Navigate to <code>Intermediate Certification Authorities</code> and expand</li> <li>Right click it, select <code>All Tasks</code> - <code>Import</code></li> <li>Browse to the cross-signed ISRG Root X1 you downloaded and complete the wizard to import it</li> <li>Look for an existing copy of <code>R3</code> issued by <code>ISRG Root X1</code> and expiring in 2025. (It's okay if there are multiple copies listed)</li> <li>If it doesn't exist, import it the same way you did for the cross-signed ISRG Root X1</li> </ul>"},{"location":"Guides/Using-Alternate-Trust-Chains/#option-2-import-via-registry-file","title":"Option 2: Import via Registry File","text":"<p>Many find it easier to import a registry file containing the necessary cert changes. Here are two that allow you to switch back and forth between the \"default\" and \"alternate\" chain configurations.</p> <ul> <li>LetsEncrypt-DefaultChain-SYSTEM.reg</li> <li>LetsEncrypt-AltChain-SYSTEM.reg</li> </ul> <p>The first one imports the 3 certs as described in the manual method. The second one deletes them. Download the one you want, remove the <code>.txt</code> extension so it becomes <code>.reg</code>, and double-click to import it.</p>"},{"location":"Guides/Using-Alternate-Trust-Chains/#trigger-cert-chain-rebuild","title":"Trigger Cert Chain Rebuild","text":"<p>In order for the cert changes to take effect, the most reliable method is to reboot the server. If you are unable or don't want to reboot, you may also be able to trigger a chain rebuild by causing IIS to rebind the certificate on your site.</p> <p>On Windows Server 2012 R2 or newer, you can use the following command to rebind the cert as long as you know the certificate thumbprint.  From PowerShell:</p> <pre><code>&amp; $env:SystemRoot\\system32\\inetsrv\\appcmd.exe renew binding /oldcert:THUMBPRINT /newcert:THUMBPRINT\n</code></pre> <p>On earlier OSes, you can try modifying the binding from IIS Manager or just delete and re-create it. But again, the most reliable way is a reboot.</p>"},{"location":"Guides/Using-Alternate-Trust-Chains/#verify-the-chain-being-served","title":"Verify the Chain Being Served","text":"<p>If your website is exposed to the Internet, you can use a number of web based SSL checkers to verify which chain is being served by your site. Here are a couple popular ones:</p> <ul> <li>Qualys SSL Labs</li> <li>Namecheap SSL Checker</li> </ul> <p>If your website or service is only listening on your internal network, the most common way to check the chain is using OpenSSL. It's usually pre-installed on Linux and MacOS. But you'll have to download and install it for Windows. A popular distribution is available from Shining Light Productions. All you should need is the \"Light\" Win64 version of whatever is the latest build.</p> <p>Run the following to check your site where <code>SERVER</code> is the hostname or IP of your server.</p> <pre><code>openssl s_client -connect SERVER:443\n</code></pre> <p>If your server requires using an SNI hostname, you can use this alternative:</p> <pre><code>openssl s_client -connect SERVER:443 -servername HOSTNAME\n</code></pre> <p>The output will be quite long and you may need to Ctrl-C to cancel the command. But the output you're looking for should be within the first 10 lines of output. There will be a block of text between two sets of <code>---</code> characters that should look like either of these:</p> <p>Default/Long Chain:</p> <pre><code>---\nCertificate chain\n 0 s:CN = example.com\n   i:C = US, O = Let's Encrypt, CN = R3\n 1 s:C = US, O = Let's Encrypt, CN = R3\n   i:C = US, O = Internet Security Research Group, CN = ISRG Root X1\n 2 s:C = US, O = Internet Security Research Group, CN = ISRG Root X1\n   i:O = Digital Signature Trust Co., CN = DST Root CA X3\n---\n</code></pre> <p>Alternate/Short Chain:</p> <pre><code>---\nCertificate chain\n 0 s:CN = example.com\n   i:C = US, O = Let's Encrypt, CN = R3\n 1 s:C = US, O = Let's Encrypt, CN = R3\n   i:C = US, O = Internet Security Research Group, CN = ISRG Root X1\n---\n</code></pre>"},{"location":"Guides/Using-Custom-Plugins/","title":"Using Custom Plugins","text":"<p>Since version 4.7.0, you can optionally have Posh-ACME load plugins from a secondary location using the <code>POSH_ACMEPLUGINS</code> environment variable. This is useful because when the module is updated, you no longer need to re-deploy you custom plugins to the module's default Plugins folder.</p> <p>Set the environment variable to the folder path where the custom plugin(s) live. The environment variable must exist when the module is first loaded. So if it has already been loaded in the current session, re-import it with the <code>-Force</code> parameter.</p> <pre><code>$env:POSHACME_PLUGINS = 'C:\\my\\plugin\\path'\nImport-Module Posh-ACME -Force\n</code></pre> <p>Warning</p> <p>Make sure your plugin's name doesn't conflict with the name of a buit-in plugin. If it does, a warning will be thrown and that plugin will be skipped.</p>"},{"location":"Guides/Using-DNS-Challenge-Aliases/","title":"Using DNS Challenge Aliases","text":""},{"location":"Guides/Using-DNS-Challenge-Aliases/#background","title":"Background","text":"<p>There are two relatively common issues that come up when people try to automate ACME certs using DNS challenges. The first is that the DNS provider hosting the zone either doesn't have an API or the ACME client doesn't have a plugin to support it. The second is that for security reasons, the business may not want to save API credentials for their critical DNS zone on an internet-facing web server.</p> <p>The workaround for both of these involves using a CNAME record to redirect challenge requests to another DNS zone. When the ACME server goes to validate the challenges, it will follow the CNAME and check the challenge token from the redirected record. If the original problem was no API or no plugin, you'd put the redirected zone on a provider with an API and a supported plugin. If the original problem was security related, you'd make the redirected zone a less important one. The downside is the extra manual step required to add the CNAME for each new cert or name in a cert. But you only have to do that once ever for each name.</p>"},{"location":"Guides/Using-DNS-Challenge-Aliases/#creating-cnames","title":"Creating CNAMEs","text":"<p>So how do we do that? First, you have to understand how the ACME protocol chooses what record to query for each name in a certificate. Non-wildcard names have <code>_acme-challenge.</code> prepended to them. Wildcard names use the same prefix but it replaces the <code>*.</code> prefix. So for example:</p> Cert Name Challenge Record example.com _acme-challenge.example.com *.example.com _acme-challenge.example.com sub1.example.com _acme-challenge.sub1.example.com *.sub1.example.com _acme-challenge.sub1.example.com www.sub1.sub2.example.com _acme-challenge.www.sub1.sub2.example.com <p>You may have noticed that a wildcard name and a non-wildcard for the same root domain have the same challenge record. That's not a mistake and the ACME server does actually expect to get two different values for the same TXT record. What it means for you though is that you only have one CNAME to create for both types of names.</p> <p>Where do you point the CNAMEs to? It doesn't really matter as long as the ACME server can query it from the Internet and Posh-ACME can create the necessary records there. Some choose to use the same <code>_acme-challenge.</code> prefix for clarity. Some use a different prefix because their provider doesn't allow names to start with a <code>_</code> character. Some just point all of their CNAMEs to the exact same place. Examples:</p> Challenge Record CNAME Target _acme-challenge.example.com _acme-challenge.example.net _acme-challenge.example.com acme.example.net _acme-challenge.example.com _acme-challenge.validation.example.net _acme-challenge.example.com_acme-challenge.sub1.example.com_acme-challenge.sub2.example.com acme.example.net _acme-challenge.example.com example.net <p>Warning</p> <p>Don't point too many CNAMES at the same target. Let's Encrypt's ACME implementation can only deal with DNS responses up to 4096 bytes which is roughly 60-70 TXT records depending on your DNS server and query parameters. If your record is too big, the validations will fail.</p>"},{"location":"Guides/Using-DNS-Challenge-Aliases/#testing","title":"Testing","text":"<p>You should verify your CNAME was created correctly before you try and use it. If you're inside a business with a split-horizon DNS infrastructure, you might need to explicitly query a public external resolver like CloudFlare's 1.1.1.1. However, some modern firewalls can be configured to prevent this ability. So make sure you can successfully query a known-good external record first. There are also web-based resolvers such as digwebinterface.com if necessary.</p> <pre><code>C:\\&gt;nslookup -q=CNAME _acme-challenge.example.com. 1.1.1.1\nServer:  1dot1dot1dot1.cloudflare-dns.com\nAddress:  1.1.1.1\n\nNon-authoritative answer:\n_acme-challenge.example.com  canonical name = acme.example.net\n</code></pre>"},{"location":"Guides/Using-DNS-Challenge-Aliases/#using-the-challenge-alias","title":"Using the Challenge Alias","text":"<p>Now that your CNAMEs are all setup, you just have to add one more parameter to your certificate request command, <code>-DnsAlias</code>. It works just like <code>-Plugin</code> as an array that should have one element for each domain in the request. But if all of your CNAMEs point to the same place, you can just specify the alias once and it will use that alias for all the names.</p> <pre><code>$certParams = @{\n    Domain = '*.example.com','example.com'\n    AcceptTOS = $true\n    Contact = 'me@example.com'\n    Plugin = 'FakeDNS'\n    PluginArgs = @{\n        FDToken = (Read-Host 'FakeDNS API Token' -AsSecureString)\n    }\n    DnsAlias = 'acme.example.net'\n    Verbose = $true\n}\nNew-PACertificate @certParams\n</code></pre>"},{"location":"Guides/Using-SecretManagement/","title":"Using SecretManagement","text":"<p>The alternative plugin encryption option added in Posh-ACME 4.0 allows for encrypting secure plugin arguments on disk with better config portability between users/systems and improves the encryption available on non-Windows platforms. The only downside to the feature is that the encryption key was stored with the main config which enables anyone with read access to the files the ability to decrypt the plugin parameters.</p> <p>In Posh-ACME 4.11.0, you can now utilize the Microsoft SecretManagement module to store the encryption key in a variety of local, on-prem, and cloud secret stores using supported vault extensions.</p> <p>Warning</p> <p>Some vault extensions are read-only and don't allow for creation of new secrets. The vault extensions supported by Posh-ACME must allow for secret creation using arbitrary name values.</p>"},{"location":"Guides/Using-SecretManagement/#prerequisites","title":"Prerequisites","text":"<p>In order to use the SecretManagement feature, you must install both the Microsoft.PowerShell.SecretManagement module and an appropriate vault extension module to interface with your preferred secret store.</p> <p>You will also need to register a new vault and make note of the vault name. It will be provided to Posh-ACME using the <code>POSHACME_VAULT_NAME</code> environment variable.</p>"},{"location":"Guides/Using-SecretManagement/#vault-password","title":"Vault Password","text":"<p>Some vaults can be configured with a password such that retrieving a secret requires first unlocking the vault with the password. In order to use a vault with Posh-ACME, you have three options.</p> <ul> <li>Configure the vault so a password is not required.</li> <li>Provide the vault password using the <code>POSHACME_VAULT_PASS</code> environment variable.</li> <li>Prior to calling Posh-ACME functions, unlock or pre-authenticate to the vault so Posh-ACME can call <code>Set-Secret</code> and <code>Get-Secret</code> without error.</li> </ul>"},{"location":"Guides/Using-SecretManagement/#secret-names-and-customization","title":"Secret Names and Customization","text":"<p>Each account configured to use alternative plugin encryption will store a single secret in the vault. The name of each secret will use the following template:</p> <p><code>poshacme-{0}-sskey</code></p> <p>The <code>{0}</code> is replaced with a unique GUID value generated for each account the first time the feature is used and stored as a property called <code>VaultGuid</code> on the account object. This ensures that using the same vault for multiple accounts does not result in secret naming conflicts.</p> <p>You may optionally create an environment variable called <code>POSHACME_VAULT_SECRET_TEMPLATE</code> to override the default template. Be sure to include <code>{0}</code> in your template string to make sure there are no conflicts between accounts. Also, be aware that some vaults have restrictions on the characters allowed in a secret name.</p>"},{"location":"Guides/Using-SecretManagement/#using-a-vault","title":"Using a Vault","text":""},{"location":"Guides/Using-SecretManagement/#enable-vault-key-storage","title":"Enable Vault Key Storage","text":"<p>Ensure the appropriate environment variables are set based on the prerequisites listed above. Then specify the <code>UseAltPluginEncryption</code> switch with either <code>New-PAAccount</code> for new accounts or <code>Set-PAAccount</code> for existing accounts.</p> <pre><code># create a new account using vault key storage\nNew-PAAccount -AcceptTOS -Contact 'me@example.com' -UseAltPluginEncryption -Verbose\n\n# migrate an existing account to use vault key storage\nSet-PAAccount -UseAltPluginEncryption -Verbose\n</code></pre> <p>Warning</p> <p>If <code>UseAltPluginEncryption</code> was already enabled for an existing account, you will need to disable it before re-enabling it in order to use vault key storage.</p> <p>The verbose output should indicate the name of the secret that was added to the vault specified by your environment variables. You should also be able to list all the secrets associated with Posh-ACME by running the following:</p> <pre><code># change the search string if you're using a custom template\nGet-SecretInfo -Vault $env:POSHACME_VAULT_NAME -Name '*poshacme*'\n</code></pre> <p>If there was a problem accessing the vault, an warning is thrown and the module falls back to storing the key with the account object. You can verify the current configuration for an account by checking the <code>VaultGuid</code> and <code>sskey</code> properties on account objects like this:</p> <pre><code>Get-PAAccount -List | Select-Object id,sskey,VaultGuid\n</code></pre> <p>When <code>sskey</code> is null or empty, the account is currently configured to use OS-native encryption. When <code>sskey</code> is set to <code>VAULT</code> and <code>VaultGuid</code> is not empty, the account is configured to use vault key storage. When <code>sskey</code> is any other value, the key is being stored with the account object.</p>"},{"location":"Guides/Using-SecretManagement/#disable-vault-key-storage","title":"Disable Vault Key Storage","text":"<p>To disable vault key storage, use the standard process to disable alternative plugin encryption.</p> <pre><code>Set-PAAccount -UseAltPluginEncryption:$false\n</code></pre> <p>If you still want to use alternative plugin encryption but without storing the key in a vault, remove your vault related environment variables and then re-enable alternative plugin encryption.</p>"},{"location":"Guides/Using-SecretManagement/#additional-considerations","title":"Additional Considerations","text":""},{"location":"Guides/Using-SecretManagement/#losing-the-vault-key","title":"Losing the Vault Key","text":"<p>If the module is unable to retrieve the key from the vault, it will be unable to decrypt SecureString and PSCredential based plugin arguments and renewals will likely fail. If the key or vault was deleted or is otherwise no longer accessible, you will need to re-configure the plugin arguments for each order associated with the account using <code>Set-PAOrder</code>. </p> <p>If the vault access disruption is only temporary, the module will be able to continue processing renewals after access is restored. However, new orders or order modifications that configure new plugin arguments will reset the account's config with a new encryption key stored on the account object. It would be difficult to recover the existing plugin arguments on other orders without tedious manual intervention. So this should be avoided if possible.</p>"},{"location":"Guides/Using-SecretManagement/#rotating-the-vault-key","title":"Rotating the Vault Key","text":"<p>If you believe the encryption key may have been compromised, you can rotate it by using the <code>ResetAltPluginEncryption</code> switch on <code>Set-PAAccount</code>.</p> <pre><code>Set-PAAccount -ResetAltPluginEncryption\n</code></pre> <p>Using <code>ResetAltPluginEncryption</code> is also an easy way to migrate from storing the key on the account to storing it in a vault.</p>"},{"location":"Guides/Using-SecretManagement/#sharing-configs-and-vaults","title":"Sharing Configs and Vaults","text":"<p>In some environments, the Posh-ACME config may be copied to multiple systems. Be wary when doing this using vault key storage. If the systems also share the same remote vault and you rotate the encryption key on one system, it will break the ability to decrypt plugin arguments on the other systems because the other systems won't have re-encrypted their copy of the plugin arguments with the new key. You will need to re-sync the config onto the other systems in order to fix it.</p>"},{"location":"Guides/Using-an-Alternate-Config-Location/","title":"Using an Alternate Config Location","text":"<p>Since version 3.2.0, you can configure Posh-ACME to use a different config location than the default path in the current user's profile folder. To do so, set an environment variable called <code>POSHACME_HOME</code> prior to running <code>Import-Module</code> or calling your first function. This can be done directly in the PowerShell session or any other standard way of setting environment variables in your OS or config management system. If the module was already imported before setting the environment variable, re-import with the <code>-Force</code> parameter to pick up the new location.</p> <pre><code>$env:POSHACME_HOME = 'C:\\my\\path'\nImport-Module Posh-ACME -Force\n</code></pre>"},{"location":"Guides/Using-an-Alternate-Config-Location/#why-bother","title":"Why Bother?","text":"<p>The default config location is specific to the OS the module is running on.</p> <ul> <li>Windows: <code>%LOCALAPPDATA%\\Posh-ACME</code></li> <li>Linux: <code>$HOME/.config/Posh-ACME</code></li> <li>MacOS: <code>$HOME/Library/Preferences/Posh-ACME</code></li> </ul> <p>While the default config location is fine for most standard use-cases, there are legitimate reasons to host the config in a more central location. A common one is to enable multiple different users to manage certificates. Another might simply be easier integration with the application using the certificate.</p>"},{"location":"Guides/Using-an-Alternate-Config-Location/#important-encrypted-plugin-parameters","title":"IMPORTANT: Encrypted Plugin Parameters","text":"<p>On Windows OSes, most DNS plugins default to using \"secure\" versions of various plugin parameters like passwords and API tokens. When saved to disk, these secure parameters are encrypted so only the current user on the current computer can decrypt them. If you are using an alternate config location so that multiple users on the system can manage certificates, this can cause errors if a user tries to decrypt something that was encrypted by another user.</p> <p>In Posh-ACME 4.x, you have a few options to workaround this limitation.</p> <ol> <li> <p>On each ACME account, use portable AES encryption instead of the OS native encryption with the <code>-UseAltPluginEncryption</code> switch on either <code>New-PAAccount</code> or <code>Set-PAAccount</code>.</p> </li> <li> <p>Don't use any plugin parameters that are <code>[SecureString]</code> or <code>[PSCredential]</code> types. Most plugins have \"Insecure\" versions of the normally secure arguments that are not encrypted on disk. However, these insecure parameter sets are deprecated and may be removed in a future major version of the module.</p> </li> <li> <p>Have each user on the system create their own ACME account that only they will use. This will technically prevent the errors as long as people don't try to accidentally renew or create new order from the wrong account. But it's not recommended.</p> </li> </ol> <p>In Posh-ACME 3.x and earlier, you must either use option 2 or 3.</p>"},{"location":"Plugins/","title":"Supported Plugins","text":""},{"location":"Plugins/#dns-plugins","title":"DNS Plugins","text":"<p>To request support for a particular DNS provider, please submit an issue. Pull requests for new plugins are also welcome and appreciated. See the plugin development guide for more info.</p> <p>If you are running Posh-ACME on PowerShell Core from a non-Windows OS, check the <code>PS Core Compatible</code> column to make sure the plugin is supported. Also check the usage guide for non-Windows specific instructions.</p> <p>Note</p> <p>Some of the provider links below are affiliate links which help reduce my out of pocket costs maintaining these plugins. I would be most grateful if you use them when signing up for new service.</p>"},{"location":"Plugins/#released","title":"Released","text":"Plugin Provider Guide PS Core Compatible AcmeDns acme-dns Usage Guide Active24 Active24 Usage Guide AddrTools addr.tools Usage Guide Akamai Akamai Edge DNS Usage Guide Aliyun Aliyun (Alibaba Cloud) Usage Guide All-Inkl All-Inkl Usage Guide Aurora PCExtreme Usage Guide AutoDNS AutoDNS XML Gateway Usage Guide Azure Microsoft Azure DNS Usage Guide Beget Beget.com Usage Guide BlueCat BlueCat Address Manager Usage Guide Bunny Bunny.net Usage Guide Cloudflare Cloudflare DNS Usage Guide ClouDNS ClouDNS Usage Guide Combell Combell Usage Guide Constellix Constellix Usage Guide CoreNetworks Core Networks Usage Guide DeSEC DeSEC DNS Usage Guide DMEasy DNS Made Easy Usage Guide DNSimple DNSimple DNS Usage Guide DNSPod DNSPod Usage Guide DOcean Digital Ocean Usage Guide DomainOffensive Domain Offensive Usage Guide Domeneshop Domeneshop DNS Usage Guide Dreamhost Dreamhost DNS Usage Guide DuckDNS Duck DNS Usage Guide Dynu Dynu DNS Usage Guide EasyDNS EasyDNS Usage Guide Easyname easyname.com Usage Guide EuroDNSReseller EuroDNS + Resellers Usage Guide FreeDNS Free DNS Usage Guide Gandi Gandi LiveDNS Usage Guide GCloud Google Cloud DNS Usage Guide Google Domains Google Domains Usage Guide GoDaddy GoDaddy Usage Guide Hetzner Hetzner Usage Guide HostingDe Hosting.de Usage Guide HurricaneElectric Hurricane Electric DNS Usage Guide HurricaneElectricDyn Hurricane Electric DNS Usage Guide IBMSoftLayer IBM Cloud DNS Usage Guide Infoblox Infoblox NIOS Usage Guide Infomaniak Infomaniak Usage Guide INWX INWX Usage Guide IONOS IONOS Usage Guide ISPConfig ISPConfig Usage Guide LeaseWeb LeaseWeb Usage Guide Linode Linode DNS Usage Guide Loopia LoopiaDNS Usage Guide LuaDns LuaDns Usage Guide Manual Manual Record Creation Namecheap Namecheap FreeDNS Usage Guide NameCom Name.com Usage Guide NS1 NS1 DNS Usage Guide OnlineNet Online.net/Scaleway Usage Guide OVH OVH.com Usage Guide PointDNS PointDNS Usage Guide Porkbun Porkbun Usage Guide PortsManagement PortsManagement Usage Guide PowerDNS PowerDNS Usage Guide Rackspace Rackspace Cloud DNS Usage Guide Regru Reg.ru and Reg.com Usage Guide RFC2136 RFC 2136 Usage Guide Route53 AWS Route53 Usage Guide Selectel Selectel.ru Usage Guide SimpleDNSPlus Simple DNS Plus Usage Guide Simply Simply.com (deprecated) Usage Guide SimplyCom Simply.com (formerly UnoEuro) Usage Guide SSHProxy Custom SSH Script Usage Guide TencentDNS TencentDNS Usage Guide TotalUptime TotalUptime Usage Guide UKFast UKFast Usage Guide WebsupportSK Websupport.sk Usage Guide WEDOS WEDOS Usage Guide Windows Microsoft Windows DNS Usage Guide Windows-Only<sup>1</sup> Yandex Yandex DNS Usage Guide Zilore Zilore Usage Guide ZoneEdit ZoneEdit Usage Guide Zonomi Zonomi DNS Usage Guide"},{"location":"Plugins/#notes","title":"Notes","text":"<ul> <li>1: When using the Windows DNS plugin on Windows from PowerShell Core, you must be on PowerShell 7+ to use the DnsServer module via implicit remoting.</li> </ul>"},{"location":"Plugins/#http-plugins","title":"HTTP Plugins","text":"<p>HTTP plugins were added in Posh-ACME 4.x. To request support for a particular web server or provider, please submit an issue. Pull requests for new plugins are also welcome and appreciated. See the plugin development guide for more info.</p>"},{"location":"Plugins/#released_1","title":"Released","text":"Plugin Notes Guide WebRoot Copies challenge files to a location on the filesystem. Usage Guide WebSelfHost Runs a self-hosted web server to answer challenge requests Usage Guide"},{"location":"Plugins/AcmeDns/","title":"How To Use the AcmeDns Plugin","text":"<p>This plugin works against acme-dns which is limited DNS server implementation designed specifically to handle DNS challenges for the ACME protocol. It will also work against acme-dns compatible APIs such as Certify DNS. It is useful when the DNS provider for your domain doesn't have a supported plugin or security policies/limitations in your environment don't allow you to use a supported plugin. Initial certificate generation requires some manual steps, but renewals can be automated just like other plugins.</p>"},{"location":"Plugins/AcmeDns/#setup","title":"Setup","text":"<p>While there is a publicly accessible acme-dns instance that you can use to test with at https://auth.acme-dns.io, it is not recommended for production use. Instead, you should run your own instance using the install instructions on the project page or sign up for a commercial service such as Certify DNS.</p> <p>Once you have your instance running, it needs to be accessible via HTTPS to your client and via standard DNS (port 53) to ACME servers on the Internet.</p>"},{"location":"Plugins/AcmeDns/#using-the-plugin","title":"Using the Plugin","text":"<p>If your acme-dns instance is using the default configuration running with TLS on port 443, the only required parameter for the plugin is <code>ACMEServer</code> which is the hostname of your instance. If you are not using TLS, using an alternate port, or require additional uri path segments, you will need to specify the full URI using <code>ACMEUri</code> instead.</p> <p>It's possible to configure acme-dns to require additonal Basic authentication which is also the case with some commercial acme-dns implementations. If that is true for your instance, you may pass the credentials using <code>ACMECredential</code> or embedded within the <code>ACMEUri</code> value.</p> <p>Warning</p> <p>It is recommended to use <code>ACMECredential</code> instead of embedding the credentials in the <code>ACMEUri</code> parameter because the URI value is not encrypted when saved to disk.</p> <p>There is also an optional <code>ACMEAllowFrom</code> parameter which takes an array of strings with networks specified in CIDR notation. If included, these networks will be the only ones that can send TXT record updates to the server for the registrations that get created as part of the certificate request. In some environments, it may make more sense to control network access via standard firewalls.</p> <p>This plugin is ultimately using CNAME aliases for DNS challenges under the hood. The first time you use it, you will be prompted to create the necessary CNAME records for each new name included in a cert.</p> <pre><code>PS C:\\&gt; New-PACertificate example.com -Plugin AcmeDns -PluginArgs @{ACMEServer='auth.acme-dns.io'}\n\nPlease create the following CNAME records:\n------------------------------------------\n_acme-challenge.example.com -&gt; xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.auth.acme-dns.io\n------------------------------------------\n\nPress any key to continue.:\n</code></pre> <p>For each CNAME in the list, you need to create the associated record on your DNS server before continuing. Assuming the records get created properly, the process should complete successfully. Future renewals will complete without additional prompting as long as no new names are added to the cert.</p>"},{"location":"Plugins/AcmeDns/#advanced-pre-registration-and-cname-creation","title":"(Advanced) Pre-registration and CNAME creation","text":"<p>Some organizations may want to pre-create the acme-dns registrations and add the necessary CNAME records to their DNS infrastructure prior to working with Posh-ACME. In this case, you can avoid the first-run interactive prompts by passing the necessary registration object(s) in a hashtable using the <code>ACMERegistration</code> parameter.</p> <p>For example, a cert that contains <code>example.com</code> and <code>www.example.com</code> will have two acme-dns registrations created (one for each name). Each registration contains four values: subdomain, username, password, and full domain. Creating the registration objects and creating the certificate might look something like this:</p> <pre><code>$reg = @{\n    '_acme-challenge.example.com' = @(\n        # the array order of these values is important\n        '9aa5ce59-635e-440c-b2ca-12ee3503ddee'                        # subdomain\n        '1b5cce3b-255d-4ffb-a81f-a9e27167ac7a'                        # username\n        'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'                         # password\n        '9aa5ce59-635e-440c-b2ca-12ee3503ddee.acmedns.example.com'    # full domain\n    )\n    '_acme-challenge.www.example.com' = @(\n        'ec6ec1f4-836e-462e-b577-b2f4e04d7291'\n        'aeb00c77-852b-465e-9b27-984bc6cb12f5'\n        'yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy'\n        'ec6ec1f4-836e-462e-b577-b2f4e04d7291.acmedns.example.com'\n    )\n}\n\n$pArgs = @{\n    ACMEServer = 'acmedns.example.com'\n    ACMERegistration = $reg\n}\n\nNew-PACertificate example.com,www.example.com -Plugin AcmeDns -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Active24/","title":"How To Use the Active24 DNS Plugin","text":"<p>This plugin works against the Active24 DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/Active24/#setup","title":"Setup","text":"<p>First, login to your account. Tokens are placed at  <code>Customer data edit</code> page, in <code>Tokens management</code>. There is need to type in your password again to manage the tokens.</p>"},{"location":"Plugins/Active24/#detailed-walk-through","title":"Detailed walk through:","text":"<ul> <li>Using your login information log in to Customer center.</li> <li>Click on the user name in the upper right corner or you may use direct link to the API management.</li> <li>You may Enter to the API management at the bottom of this page. </li> <li>Use the Create a new token button to setup new API token. </li> <li>The Comment is not mandatory, it simply helps to manage created tokens.</li> <li>The expiration date is also optional.</li> <li>In the Access restrictions can be specified the IP address of the device that can work with the token. If the device with a different IP address used functional token, it will not perform any requests - the requests cannot be authorized.</li> <li>Once you fill everything you need, you can Create a new token. There is a password confirmation required.</li> </ul>"},{"location":"Plugins/Active24/#using-the-plugin","title":"Using the Plugin","text":"<p>With your token value, you'll need to set the <code>A24Token</code> SecureString parameter.</p> <pre><code>$pArgs = @{\n    A24Token = (Read-Host \"Active24 Token\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Active24 -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/AddrTools/","title":"How To Use the AddrTools DNS Plugin","text":"<p>This plugin works against challenges.addr.tools which is a specialized provider purpose built for validating dns-01 challenges using CNAME aliases. It is part of the larger addr.tools open source project which means you can self-host your own instance. But the default configuration works against the author's public instance.</p>"},{"location":"Plugins/AddrTools/#setup","title":"Setup","text":"<p>It may help to read the Using DNS Challenge Aliases guide to better understand how CNAME records work with ACME challenges. Most importantly, there will be a one-time CNAME record creation for each name in the certificate you are requesting.</p> <p>There is a helper function in the plugin to help determine which CNAME records to create. It uses the same parameters that the AddrTools plugin uses. So use the following code to create an appropriate <code>$pArgs</code> variable and a <code>$domains</code> variable that contains the list of domains in your certificate.</p> <pre><code>$pArgs = @{\n    AddrToolsSecret = Read-Host -Prompt \"Enter Secret\" -AsSecureString\n    AddrToolsHost = 'challenges.addr.tools' # optional unless self-hosting\n}\n$domains = 'example.com','www.example.com'\n</code></pre> <p>Now run the following to load and run the helper function that will tell you what CNAME records to create.</p> <pre><code>Import-Module Posh-ACME\n. (Join-Path (Get-Module Posh-ACME).ModuleBase \"Plugins\\AddrTools.ps1\")\nGet-AddrToolsCNAME $domains @pArgs\n</code></pre> <p>The output will look similar to this depending on how many unique domains you have:</p> <pre><code>FQDN                            Target\n----                            ------\n_acme-challenge.example.com     7870508034f01f4a28d86812fa7bd10a03cb7e7e6ddda0ddb95ff771.challenges.addr.tools\n_acme-challenge.www.example.com 7870508034f01f4a28d86812fa7bd10a03cb7e7e6ddda0ddb95ff771.challenges.addr.tools\n</code></pre>"},{"location":"Plugins/AddrTools/#using-the-plugin","title":"Using the Plugin","text":"<p>Once all necessary CNAME records are created, you can use the same <code>$pArgs</code> value from setup with the plugin. <code>AddrToolsSecret</code> is always required and <code>AddrToolsHost</code> is only required if you're self-hosting your own instance at a different domain.</p> <p>You'll also need to use the <code>-DnsAlias</code> parameter from New-PACertificate with the Target value from the CNAME records.</p> <pre><code># set this to the CNAME Target value from setup\n$target = 'xxxxxxxxxxxxxxxxxx.challenges.addr.tools'\n\n$pArgs = @{\n    AddrToolsSecret = (Read-Host 'Access Token' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin AddrTools -PluginArgs $pArgs -DnsAlias $target\n</code></pre>"},{"location":"Plugins/Akamai/","title":"How To Use the Akamai Plugin","text":"<p>This plugin works against the Akamai Edge DNS provider (formerly known as Fast DNS). It is assumed that you already have an account and one or more primary zones hosted.</p>"},{"location":"Plugins/Akamai/#setup","title":"Setup","text":"<p>You will need a set of tokens associated with what Akamai calls an \"API Client\". If you are a Control Center administrator, you should be able to create this for yourself in the Identity Management section using the instructions here. You will need Read/Write access to DNS Zones and Records.</p> <p>The end of this process should generate a set of four values: <code>host</code>, <code>client_token</code>, <code>client_secret</code>, and <code>access_token</code>. If you are not the Control Center administrator, your administrator should be able to provide these values to you after creating an API client on your behalf.</p> <p>Depending on how you want to use the plugin, you can either add the values to a <code>.edgerc</code> file and reference that file path with the plugin or just reference the values directly. Details on those options are provided below.</p>"},{"location":"Plugins/Akamai/#using-the-plugin","title":"Using the Plugin","text":"<p>Akamai is one of the few DNS providers with an API to check whether changes have propagated to the authoritative nameservers for your zones and this plugin will use it automatically. What this means is that if all of the names in your certificate are using the Akamai plugin, you may want to decrease the default <code>DNSSleep</code> parameter from 120 seconds down to something small like 10 seconds because the changes should be propagated by the time the sleep timer would normally start. The examples below will demonstrate.</p>"},{"location":"Plugins/Akamai/#explicit-api-options","title":"Explicit API Options","text":"<p>Specify API values individually using <code>AKHost</code>, <code>AKClientToken</code>, and <code>AKAccessToken</code> as string values and <code>AKClientSecret</code> as a SecureString value</p> <p>Warning</p> <p>The <code>AKClientSecretInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    AKHost = 'myhost.akamaiapis.net'\n    AKClientToken = 'xxxxxxxxxxxx'\n    AKClientSecret = (Read-Host \"Client Secret\" -AsSecureString)\n    AKAccessToken = 'yyyyyyyyyyyy'\n}\nNew-PACertificate example.com -Plugin Akamai -PluginArgs $pArgs -DNSSleep 10\n</code></pre>"},{"location":"Plugins/Akamai/#edgerc-options","title":".edgerc Options","text":"<p>If your API client values are stored in a <code>.edgerc</code> file, you can use the <code>AKUseEdgeRC</code> parameter rather than specifying all the values explicitly. Use the <code>AKEdgeRCFile</code> and <code>AKEdgeRCSection</code> parameters if your file is not in the default <code>~\\.edgerc</code> location or the <code>[default]</code> section. Make sure the user who will be running the commands has read access to this file.</p> <pre><code># default location and section\nNew-PACertificate example.com -Plugin Akamai -PluginArgs @{AKUseEdgeRC=$true} -DNSSleep 10\n</code></pre> <pre><code># alternate location and section\n$pArgs = @{\n    AKUseEdgeRC= $true\n    AKEdgeRCFile = 'C:\\ProgramData\\.edgerc'\n    AKEdgeRCSection = 'poshacme'\n}\nNew-PACertificate example.com -Plugin Akamai -PluginArgs $pArgs -DNSSleep 10\n</code></pre>"},{"location":"Plugins/Aliyun/","title":"How To Use the Aliyun (Alibaba Cloud) DNS Plugin","text":"<p>This plugin works against the Aliyun (Alibaba Cloud) DNS provider. It is assumed that you have already setup an account and registered the domains or zones you will be working against.</p>"},{"location":"Plugins/Aliyun/#setup","title":"Setup","text":"<p>First, login to your account and go to the Security Management page. Click the <code>Create Access Key</code> link and make a note of the Key ID and Secret values.</p> <p>Note</p> <p>It is also supported recommended to use RAM (Resource Access Management) users with more limited privileges instead of your root account key. More information about creating RAM users can be found here.</p>"},{"location":"Plugins/Aliyun/#using-the-plugin","title":"Using the Plugin","text":"<p>The Key ID is specified as a string using <code>AliKeyId</code> and the secret is specified as a SecureString using <code>AliSecret</code>.</p> <p>Warning</p> <p>The <code>AliSecretInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$secret = Read-Host \"Secret\" -AsSecureString\n$pArgs = @{\n    AliKeyId = 'asdf1234'\n    AliSecret = $secret\n}\nNew-PACertificate example.com -Plugin Aliyun -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/All-Inkl/","title":"How To Use the All-Inkl KAS DNS Plugin","text":"<p>This plugin works against the All-Inkl KAS DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/All-Inkl/#setup","title":"Setup","text":"<p>Using the All-Inkl KAS API only requires your accounts username and password.</p>"},{"location":"Plugins/All-Inkl/#using-the-plugin","title":"Using the Plugin","text":"<p>In any case you have to provide the username with the <code>KasUsername</code> parameter.\\ In addition you can provide the password as SecureString in plain text by using the <code>KasPwd</code> parameter or as sha1 hash by using the <code>KasPwdHash</code> parameter. In both cases this plugin only sends a sha1 hash of your password to the All-Inkl KAS API.</p> <p>Alternatively you can handle the authentication yourself and provide a valid session id by specifying the <code>KasSession</code> parameter as SecureString.</p> <pre><code>$pArgs = @{\n    KasUsername = 'myusername'\n    KasPwd = (Read-Host \"KAS Password\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin All-Inkl -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Aurora/","title":"How To Use the Aurora DNS Plugin","text":"<p>This plugin works against the PCExtreme provider, Aurora DNS. It is assumed that you already have an account and at least one Managed zone you will be working against.</p>"},{"location":"Plugins/Aurora/#setup","title":"Setup","text":"<p>If you haven't done it already, you need to generate API Credentials for your account from the DNS - Health Checks Users page. When you open the user details, you should be provided with an <code>API URL</code>, <code>Key</code> and <code>Secret</code> value. These are what we will use with the plugin.</p>"},{"location":"Plugins/Aurora/#using-the-plugin","title":"Using the Plugin","text":"<p>The API Key and Secret are passed as the username and password in a PSCredential object to the <code>AuroraCredential</code> parameter.</p> <p>There is also an optional <code>AuroraApi</code> parameter for the hostname provided in API URL which defaults to <code>api.auroradns.eu</code>. So if your API URL is the same, you can ignore that parameter.</p> <pre><code>$pArgs = @{\n    AuroraCredential = (Get-Credential))\n}\nNew-PACertificate example.com -Plugin Aurora -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/AutoDNS/","title":"How To Use the AutoDNS DNS Plugin","text":"<p>This plugin works against any DNS provider that utilizes the AutoDNS XML API from InternetX. Schlundtech is an example of a registrar who uses this API. It is assumed that you have already setup an account and registered the domains or zones you will be working against.</p>"},{"location":"Plugins/AutoDNS/#setup","title":"Setup","text":"<p>In addition to your username and password, you will also need a \"Context\" value for your account. This is typically a number and varies per provider. The plugin defaults to <code>4</code>. If you are not using InternetX directly, you will also need the XML gateway URL. The plugin defaults to <code>gateway.autodns.com</code>.</p>"},{"location":"Plugins/AutoDNS/#using-the-plugin","title":"Using the Plugin","text":"<p><code>AutoDNSUser</code>, <code>AutoDNSContext</code>, and <code>AutoDNSGateway</code> are specified using regular string values. <code>AutoDNSPassword</code> is a SecureString value.</p> <p>Warning</p> <p>The <code>AutoDNSPasswordInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    AutoDNSUser = 'myusername'\n    AutoDNSPassword = (Read-Host -Prompt \"Password\" -AsSecureString)\n    AutoDNSContext = '4'\n    AutoDNSGateway = 'gateway.autodns.com'\n}\nNew-PACertificate example.com -Plugin AutoDNS -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Azure/","title":"How To Use the Azure DNS Plugin","text":"<p>This plugin works against the Azure DNS provider. It is assumed that you already have an active subscription with at least one DNS zone, associated Resource Group, and an account with access to create roles and app registrations. The setup commands used in this guide will also make use of the Az module. But it is not required to use the plugin normally.</p>"},{"location":"Plugins/Azure/#setup","title":"Setup","text":"<p>This plugin has three distinct methods for authentication against Azure. The first involves specifying a Tenant ID and credentials for an account or app registration. The second requires an existing OAuth 2.0 access token which would generally be used for short lived services or environments where Azure authentication is being handled externally to the Posh-ACME module. The last is for systems running within Azure that have a Managed Service Identity (MSI) and utilizes the Instance Metadata Service (IMDS) to request an access token.</p> <p>All methods require that the identity being used to authenticate has been given access to modify TXT records in the specified Azure subscription. If you have already done that, you can skip most of the following setup.</p>"},{"location":"Plugins/Azure/#connect-to-azure","title":"Connect to Azure","text":"<p>Using an account with access to create roles and app registrations, connect to Azure with the following commands. We'll be saving the resulting Subscription and Tenant ID values for later.</p> <pre><code># On Windows, this will pop up a web-GUI to login with. On other OSes,\n# it will ask you to open a browser separately with a code for logging in.\n$az = Connect-AzAccount\n\n# Save the subscription/tentant ID for later\n$subscriptionID = $az.Context.Subscription.Id\n$tenantID = $az.Context.Subscription.TenantId\n</code></pre>"},{"location":"Plugins/Azure/#create-a-custom-role","title":"Create a Custom Role","text":"<p>We're going to create a custom role that is limited to modifying TXT records in whatever resource group it is assigned to. It will be based on the default <code>DNS Zone Contributor</code> role.</p> <pre><code>$roleDef = Get-AzRoleDefinition -Name \"DNS Zone Contributor\"\n$roleDef.Id = $null\n$roleDef.Name = \"DNS TXT Contributor\"\n$roleDef.Description = \"Manage DNS TXT records only.\"\n$roleDef.Actions.RemoveRange(0,$roleDef.Actions.Count)\n$roleDef.Actions.Add(\"Microsoft.Network/dnsZones/TXT/*\")\n$roleDef.Actions.Add(\"Microsoft.Network/dnsZones/read\")\n$roleDef.Actions.Add(\"Microsoft.Authorization/*/read\")\n$roleDef.Actions.Add(\"Microsoft.Insights/alertRules/*\")\n$roleDef.Actions.Add(\"Microsoft.ResourceHealth/availabilityStatuses/read\")\n$roleDef.Actions.Add(\"Microsoft.Resources/deployments/read\")\n$roleDef.Actions.Add(\"Microsoft.Resources/subscriptions/resourceGroups/read\")\n$roleDef.AssignableScopes.Clear()\n$roleDef.AssignableScopes.Add(\"/subscriptions/$($az.Context.Subscription.Id)\")\n\n$role = New-AzRoleDefinition $roleDef\n$role\n</code></pre>"},{"location":"Plugins/Azure/#optional-create-a-service-principal-app-registration","title":"(Optional) Create a Service Principal / App Registration","text":"<p>If you're using Posh-ACME from outside Azure and not using an existing access token, it is wise to create a dedicated service principal limited to modifying TXT records. Service Principals are tied to App Registrations in Azure AD and creating the former will automatically create the latter (though it's technically possible to create them separately).</p> <p>Service Principals are associated with one or more Credentials which can be password or certificated based. Certificates can be a bit trickier to setup particularly on non-Windows OSes, but Microsoft recommends them over passwords. We'll go over both methods below. Both also have configurable expiration values that default to 1 year and we'll be setting ours to 5 years, but you can choose whatever you like.</p> <pre><code>$notBefore = Get-Date\n$notAfter = $notBefore.AddYears(5)\n</code></pre>"},{"location":"Plugins/Azure/#password-based-principal","title":"Password Based Principal","text":"<p>The <code>New-AzADServicePrincipal</code> function will generate a password for us, so all we have to do is give it a name and specify our expiration dates.</p> <pre><code>$spParams = @{\n    DisplayName = 'PoshACME'\n    StartDate = $notBefore\n    EndDate = $notAfter\n}\n$sp = New-AzADServicePrincipal @spParams\n</code></pre> <p>You'll use your new credential with the <code>AZAppCred</code> plugin parameter. The username is in the <code>AppId</code> property and the password is in <code>PasswordCredentials.SecretText</code>. Here's how to create the credential object for later.</p> <pre><code>$spPass = $sp.PasswordCredentials.SecretText | ConvertTo-SecureString -AsPlainText -Force\n$appCred = [pscredential]::new($sp.AppId,$spPass)\n</code></pre>"},{"location":"Plugins/Azure/#certificate-based-principal-on-windows","title":"Certificate Based Principal on Windows","text":"<p>Before we can create a certificate based credential, we have to actually create a certificate to use with it. Self-signed certs are fine here because we're only using them to sign data and Azure just needs to verify the signature using the public key we will associate with the principal.</p> <p>Note</p> <p>New-SelfSignedCertificate is only available on Windows 10/2016 or later. Check this document for instructions on earlier OSes.</p> <p>Note</p> <p>If you plan on using an existing certificate, make sure it is being stored using the legacy CSP called \"Microsoft Enhanced RSA and AES Cryptographic Provider\" that supports the SHA256 hashing algorithm. PowerShell doesn't yet support retrieving private key values from newer KSP based providers.</p> <pre><code># Keep in mind that this certificate will be created in the current user's certificate\n# store. If you intend to use it from another account, you will need to either create it\n# there or export it and re-import it there.\n$certParams = @{\n    CertStoreLocation = 'Cert:\\CurrentUser\\My'\n    Subject = 'CN=Azure App PoshACME'\n    HashAlgorithm = 'SHA256'\n    Provider = 'Microsoft Enhanced RSA and AES Cryptographic Provider'\n    NotBefore = $notBefore\n    NotAfter = $notAfter\n}\n$cert = New-SelfSignedCertificate @certParams\n\n$certData = [System.Convert]::ToBase64String($cert.GetRawCertData())\n\n$spParams = @{\n  DisplayName = 'PoshACME'\n  CertValue = $certData\n  StartDate = $cert.NotBefore\n  EndDate = $cert.NotAfter\n}\n$sp = New-AzADServicePrincipal @spParams\n</code></pre> <p>You'll use your new credential with the <code>AZAppUsername</code> and <code>AZCertThumbprint</code> plugin parameters. Here's how to save a reference to them for later.</p> <pre><code>$appUser = $sp.AppId\n$thumbprint = $cert.Thumbprint\n</code></pre>"},{"location":"Plugins/Azure/#certificate-based-principal-on-non-windows","title":"Certificate Based Principal on non-Windows","text":"<p>Before we can create a certificate based credential, we have to actually create a certificate to use with it. As of PowerShell 6.2.3, the non-Windows support for .NET's certificate store abstraction is still not great. So we need to create the cert with OpenSSL and reference a PFX file directly rather than using the thumbprint value like on Windows. Self-signed certs are fine here because we're only using them to sign data and Azure just needs to verify the signature using the public key we will associate with the principal.</p> <pre><code># Depending on your OpenSSL config, this may prompt you for certificate details\n# like Country, Organization, etc. None of the details matter for the purposes of\n# authentication and can be set to anything you like.\nopenssl req -x509 -nodes -sha256 -days 1826 -newkey rsa:2048 -keyout poshacme.key -out poshacme.crt\n\n# change the export password to whatever you want, but remember what it is so you can\n# provide it as part of the plugin parameters\nopenssl pkcs12 -export -in poshacme.crt -inkey poshacme.key -CSP \"Microsoft Enhanced RSA and AES Cryptographic Provider\" -out poshacme.pfx -passout \"pass:poshacme\"\n\n$cert = [Security.Cryptography.X509Certificates.X509Certificate2]::new((Resolve-Path './poshacme.crt'))\n$certData = [Convert]::ToBase64String($cert.GetRawCertData())\n\n$spParams = @{\n    DisplayName = 'PoshACMELinux'\n    CertValue = $certData\n    StartDate = $cert.NotBefore\n    EndDate = $cert.NotAfter\n}\n$sp = New-AzADServicePrincipal @spParams\n\n# (optional) delete the PEM files we don't need for plugin purposes\nrm poshacme.crt poshacme.key\n\n# IMPORTANT: Anyone who can read the crt/key or pfx files may be able to impersonate this\n# service principal. So make sure to move and/or change permissions on the files so\n# that only the process running Posh-ACME can read them.\n</code></pre> <p>You'll use your new credential with the <code>AZAppUsername</code>, <code>AZCertPfx</code>, and <code>AZPfxPassSecure</code> plugin parameters. Here's how to save a reference to them for later.</p> <pre><code>$appUser = $sp.AppId\n# modify the path and/or password as appropriate\n$certPfx = (Resolve-Path './poshacme.pfx').ToString()\n# remember to use the password you used with openssl\n$pfxPass = ConvertToSecureString 'poshacme' -AsPlainText -Force\n</code></pre>"},{"location":"Plugins/Azure/#assign-permissions-to-the-service-principal","title":"Assign Permissions to the Service Principal","text":"<p>Now we'll tie everything together by assigning the service principal we created to the custom Role we created and the Resource Group that contains our DNS zones. If your zones are in more than one resource group, just repeat this for each one. If you used your own method for creating a service princpal, just use <code>Get-AzAdServicePrincipal</code> to get a reference to it first.</p> <pre><code># modify the ResourceGroupName as appropriate for your environment\n$raParams = @{\n    ApplicationId = $sp.AppId\n    ResourceGroupName = 'MyZones'\n    RoleDefinitionName = 'DNS TXT Contributor'\n}\nNew-AzRoleAssignment @raParams\n</code></pre>"},{"location":"Plugins/Azure/#optional-using-a-managed-service-identity-msi","title":"(Optional) Using a Managed Service Identity (MSI)","text":"<p>When using a Managed Service Identity (MSI), we need the security principal ID of the VM or Service to assign permissions to. This example will query a VM.</p> <pre><code># NOTE: The VM must have a managed identity associated with it for this to work\n$spID = (Get-AzVM -ResourceGroupName '&lt;VM Resource Group&gt;' -Name '&lt;VM Name&gt;').Identity.PrincipalId\n$raParams = @{\n    ObjectId = $spID\n    ResourceGroupName = 'MyZones'\n    RoleDefinitionName = 'DNS TXT Contributor'\n}\nNew-AzRoleAssignment @raParams\n</code></pre> <p>In addition to the <code>AZSubscriptionId</code> plugin parameter that all auth methods must provide, the only plugin parameter you'll need is the <code>AZUseIMDS</code> switch.</p>"},{"location":"Plugins/Azure/#optional-using-an-existing-access-token","title":"(Optional) Using An Existing Access Token","text":"<p>Any existing user, application, or managed service principal should work as long as it has been assigned permissions to manage DNS TXT records in the zones you're requesting certificates for.</p> <p>Here is how to get the token for the context you are currently logged in with using with Powershell. The method depends on what version of the <code>Az.Accounts</code> module you're using.</p> <pre><code># Az.Accounts 1.9.x or earlier\n$ctx = Get-AzContext\n$token = ($ctx.TokenCache.ReadItems() | ?{\n    $_.TenantId -eq $ctx.Subscription.TenantId -and $_.Resource -eq \"https://management.core.windows.net/\"\n} | Select-Object -First 1).AccessToken\n\n# Az.Accounts 2.0.x or later\n$token = (Get-AzAccessToken -ResourceUrl \"https://management.core.windows.net/\" -TenantId $tenantId).Token\n</code></pre> <p>Here's a similar method using Azure CLI 2.0. <pre><code># show all subscriptions - the one marked as \"isDefault\": true will be used to create the token\naz account list\n$token = (az account get-access-token --resource 'https://management.core.windows.net/' | ConvertFrom-Json).accessToken\n</code></pre></p> <p>To get a token for the MSI when running in a VM, Azure Function or App Service - please refer to the following documentation. Remember to pass in the correct resource uri: https://management.core.windows.net/</p> <ul> <li>Getting a token for an MSI-enabled VM</li> <li>Getting a token for an MSI-enabled App Service or Function</li> </ul>"},{"location":"Plugins/Azure/#using-the-plugin","title":"Using the Plugin","text":"<p>All authentication methods require specifying <code>AZSubscriptionId</code> which is the subscription that contains the DNS zones to modify. Password and Certificate based credentials also require <code>AZTenantId</code> which is the Azure AD tenant guid. Additional parameters are outlined in each section below.</p> <p>Note</p> <p>The plugin defaults to using the primary public Azure Cloud. But country and government specific Azure clouds are also supported by specifying the <code>AZEnvironment</code> parameter. Supported environments include <code>AzureCloud</code> (Default), <code>AzureUSGovernment</code>, <code>AzureGermanCloud</code>, and <code>AzureChinaCloud</code>.</p>"},{"location":"Plugins/Azure/#password-credential","title":"Password Credential","text":"<p>Subscription and Tenant values are passed as standard strings using <code>AZSubscriptionId</code> and <code>AZTenantId</code>. The credential is passed as a PSCredential object using <code>AZAppCred</code>. PSCredential objects require a username and password. For a service principal, the username is the its <code>ApplicationId</code> guid and the password is whatever was originally set for it. If you've been following the setup instructions, you may have <code>$subscriptionID</code>, <code>$tenantID</code>, and <code>$appCred</code> variables you can use instead of the sample values below.</p> <p>Warning</p> <p>The <code>AZAppUsername</code> and <code>AZAppPasswordInsecure</code> parameters are deprecated and will be removed in the next major module version. If you are using them, please migrate to a secure parameter set.</p> <pre><code>$pArgs = @{\n    AZSubscriptionId = 'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'\n    AZTenantId = 'yyyyyyyy-yyyy-yyyy-yyyy-yyyyyyyyyyyy'\n    AZAppCred = (Get-Credential)\n}\nNew-PACertificate example.com -Plugin Azure -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Azure/#certificate-credential","title":"Certificate Credential","text":"<p>As of PowerShell 6.2.3 (November 2019), support for the certificate store abstractions only really works on Windows. So there are separate instructions for Windows and non-Windows OSes.</p>"},{"location":"Plugins/Azure/#windows-certificate","title":"Windows Certificate","text":"<p>You'll need to specify the service principal username which is its <code>ApplicationId</code> guid and the certificate thumbprint value. If you've been following the setup instructions, you may have <code>$subscriptionID</code>, <code>$tenantID</code>, <code>$appUser</code>, and <code>$thumbprint</code> variables you can use instead of the sample values below.</p> <pre><code>$pArgs = @{\n    AZSubscriptionId = 'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'\n    AZTenantId = 'yyyyyyyy-yyyy-yyyy-yyyy-yyyyyyyyyyyy'\n    AZAppUsername = 'zzzzzzzz-zzzz-zzzz-zzzz-zzzzzzzzzzzz'\n    AZCertThumbprint = '1A2B3C4D5E6F1A2B3C4D5E6F1A2B3C4D5E6F1A2B'\n}\nNew-PACertificate example.com -Plugin Azure -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Azure/#non-windows-certificate","title":"Non-Windows Certificate","text":"<p>You'll need to specify the service principal username which is its <code>ApplicationId</code> guid, the path to the PFX file, and the PFX password as a SecureString. If you've been following the setup instructions, you may have <code>$subscriptionID</code>, <code>$tenantID</code>, <code>$appUser</code>, <code>$certPfx</code>, and <code>$pfxPass</code> variables you can use instead of the sample values below.</p> <p>Warning</p> <p>The <code>AZPfxPass</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to a secure parameter set.</p> <pre><code>$pArgs = @{\n    AZSubscriptionId = 'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'\n    AZTenantId = 'yyyyyyyy-yyyy-yyyy-yyyy-yyyyyyyyyyyy'\n    AZAppUsername = 'zzzzzzzz-zzzz-zzzz-zzzz-zzzzzzzzzzzz'\n    AZCertPfx = '/home/certuser/poshacme.pfx'\n    AZPfxPassSecure = (ConvertTo-SecureString 'poshacme' -AsPlainText -Force)\n}\nNew-PACertificate example.com -Plugin Azure -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Azure/#existing-access-token","title":"Existing Access Token","text":"<p>Only the subscription guid and the access token you previously retrieved are required for this method.</p> <pre><code>$pArgs = @{\n    AZSubscriptionId = 'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'\n    AZAccessToken = $token\n}\nNew-PACertificate example.com -Plugin Azure -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Azure/#instance-metadata-service-imds","title":"Instance Metadata Service (IMDS)","text":"<p>Only the subscription guid and the <code>AZUseIMDS</code> switch are required for this method.</p> <pre><code>$pArgs = @{\n    AZSubscriptionId = 'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'\n    AZUseIMDS = $true\n}\nNew-PACertificate example.com -Plugin Azure -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Azure/#workaround-for-duplicate-public-zones","title":"Workaround for Duplicate Public Zones","text":"<p>In rare cases, a subscription may have two or more public copies of the same zone in different resource groups. When this happens, the plugin will throw an error such as:</p> <p>2 public copies of example.com zone found. Please use 'poshacme' tag on the live copy.</p> <p>To workaround this problem, there are two main options. The easiest is to add an Azure Tag called <code>poshacme</code> on the live copy of the zone. The tag value doesn't matter as long as the name is <code>poshacme</code>. The plugin will recognize this tag and ignore the other copies of the zone. (Note: This requires version 3.2.1 of the module or later)</p> <p>The other solution is to remove permissions from the Azure account being used with Posh-ACME so it can only see the resource group that contains the live copy of the zone. But this may not be feasible depending on what else is in the resource group and what else the Azure account is being used for.</p>"},{"location":"Plugins/Beget/","title":"How To Use the Beget DNS Plugin","text":"<p>This plugin works against the Beget.com provider. It is assumed that you already have an account and at least one domain you will be working against.</p>"},{"location":"Plugins/Beget/#setup","title":"Setup","text":"<p>It is possible to use this plugin using the same credentials that are used to login to the web control panel. However, it is recommended to setup a separate password for API access and also limit the permissions.</p> <p>To do this, go to your Beget API settings and select \"Use separate password\". After setting the password, uncheck all of the Permitted Methods except for \"DNS management\" and click the <code>Apply</code> button.</p> <p>Warning</p> <p>There are some limitations with how the Beget API works that make it risky to use when using DNS Challenge Aliases. If you need to use this plugin with challenge aliases, the value for the DnsAlias must not contain any other record types or TXT values because they will likely be deleted when the plugin attempts to create the TXT records.</p>"},{"location":"Plugins/Beget/#using-the-plugin","title":"Using the Plugin","text":"<p>Your Beget credentials are passed as the username and password in a PSCredential object to the <code>BegetCredential</code> parameter.</p> <pre><code>$pArgs = @{\n    BegetCredential = (Get-Credential -Message \"Beget Credentials\")\n}\nNew-PACertificate example.com -Plugin Beget -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/BlueCat/","title":"How To Use the BlueCat DNS Plugin","text":"<p>This plugin works against the BlueCat Address Manager DNS provider. It is assumed that you have already have an account that is an \"API User\" and have created the DNS zone(s) you will be working against. This plugin has been tested against version 8.1.1.</p>"},{"location":"Plugins/BlueCat/#using-the-plugin","title":"Using the Plugin","text":"<p>Due to the potentially short lifetime of a BAM auth token you must pass the username and password as a PSCredential object using the <code>BlueCatCredential</code> parameter. You also need to provide the API uri as <code>BlueCatUri</code>. In addition you must also pass the Configuration name as <code>BlueCatConfig</code>, the DNS View name as <code>BlueCatView</code>, and the list of DNS servers to deploy as <code>BlueCatDeployTargets</code>.</p> <p>Warning</p> <p>The <code>BlueCatUsername</code> and <code>BlueCatPassword</code> parameters are deprecated and will be removed in the next major module version. If you are using them, please migrate to the Secure parameter set.</p> <pre><code>$BlueCatParams = @{\n    BlueCatUsername='xxxxxxxx'\n    BlueCatPassword='xxxxxxxx'\n    BlueCatUri='https://FQDN//Services/API'\n    BlueCatConfig='foobar'\n    BlueCatView='foobaz'\n    BlueCatDeployTargets=@('FQDN1', 'FQDN2', 'FQDN3')\n}\nNew-PACertificate example.com -Plugin BlueCat -PluginArgs $BlueCatParams\n</code></pre>"},{"location":"Plugins/Bunny/","title":"How To Use the Bunny.net DNS Plugin","text":"<p>This plugin works against the Bunny.net DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/Bunny/#setup","title":"Setup","text":"<p>First, login to your account. Your API Key (Access Key) is available under the Account section.</p>"},{"location":"Plugins/Bunny/#using-the-plugin","title":"Using the Plugin","text":"<p>Use your account API Key as the <code>BunnyAccessKey</code> SecureString parameter.</p> <pre><code>$pArgs = @{\n    BunnyAccessKey = (Read-Host \"Bunny Access Key\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Bunny -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/ClouDNS/","title":"How To Use the ClouDNS DNS Plugin","text":"<p>This plugin works against the ClouDNS provider. It is assumed that you have already setup an account and registered the domains or zones you will be working against.</p> <p>Note</p> <p>This provider does not allow API Access on its free account tier. If you sign up for a premium plan trial and let it expire, the plugin will stop working unless you upgrade your account to premium again. Their premium plans are reasonably priced and if you are a new customer, you can help me maintain this plugin by using this affiliate link when you sign up.</p>"},{"location":"Plugins/ClouDNS/#setup","title":"Setup","text":"<p>First, login to your account and go to the API Settings page. Click the <code>Add new user</code> link and set a password and optional IP whitelist. After saving, make note of the <code>auth-id</code> value for this user.</p>"},{"location":"Plugins/ClouDNS/#optional-sub-users-and-zone-delegation","title":"(Optional) Sub Users and Zone Delegation","text":"<p>The standard API users have complete access to your account. But for a bit more security, you can create sub-users that only have access to a subset of zones on your account. Click the <code>Add new sub-user</code> link from the API Settings page. Set a password and set the <code>DNS Zones</code> value to the number of zones you'll be delegating the user to. The rest of the fields are either optional or can be set to 0.</p> <p>After the user is created, click the text link in the DNS Zones column for the user that should be something like \"0 / X\" where X is the number of zone you configured for delegation. This will pop up a dialog box and let you add the specific zones you are delegating.</p> <p>Make a note of the <code>sub-auth-id</code> or <code>sub-auth-user</code> name you set for later.</p>"},{"location":"Plugins/ClouDNS/#using-the-plugin","title":"Using the Plugin","text":"<p>The <code>CDUserType</code> parameter must be set to either <code>auth-id</code>, <code>sub-auth-id</code>, or <code>sub-auth-user</code> depending on the type of credential you are using. The <code>CDUsername</code> parameter should be set to the ID or username of the user. The password is set using <code>CDPassword</code> as a SecureString value.</p> <p>Warning</p> <p>The <code>CDPasswordInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <p>By default the plugin assumes Posh-ACME's default DNS propagation delay mechanics will be used. But ClouDNS also supports a polling API to check whether record changes have propagated to the nameservers. To use this instead of the default mechanics, add a <code>CDPollPropagation = $true</code> parameter to your plugin args. By default, it will timeout after 5 minutes if the polling API never returns a success. You can override the timeout value with <code>CDPollTimeout</code> in seconds. When using CDPollPropagation, you should also set Posh-ACME's <code>DNSSleep</code> parameter to 0 unless you are using additional plugins that don't support their own form of propagation polling.</p>"},{"location":"Plugins/ClouDNS/#standard-propagation-delay","title":"Standard Propagation Delay","text":"<pre><code>$pArgs = @{\n    CDUserType = 'auth-id'\n    CDUsername = '12345'\n    CDPassword = (Read-Host \"Password\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin ClouDNS -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/ClouDNS/#cloudns-propagation-polling","title":"ClouDNS Propagation Polling","text":"<pre><code>$pArgs = @{\n    CDUserType = 'auth-id'\n    CDUsername = '12345'\n    CDPassword = (Read-Host \"Password\" -AsSecureString)\n    CDPollPropagation = $true\n}\nNew-PACertificate example.com -Plugin ClouDNS -PluginArgs $pArgs -DnsSleep 0\n</code></pre>"},{"location":"Plugins/Cloudflare/","title":"How To Use the Cloudflare DNS Plugin","text":"<p>This plugin works against the Cloudflare DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/Cloudflare/#setup","title":"Setup","text":"<p>There are two choices for authentication against the Cloudflare API. The old way uses your account email address and a \"Global API Key\" that has complete access to your account. Cloudflare also supports API Tokens that can be limited to only certain permissions within the account. This is the recommended method to use. Open the API Tokens page to get started.</p>"},{"location":"Plugins/Cloudflare/#api-token","title":"API Token","text":"<p>The API token will need <code>Zone - DNS - Edit</code> permissions on the zone(s) you will be requesting a certificate for. Many find it easiest to use <code>All zones</code> or <code>All zones from an account</code> in the Zone Resources section. But you may also limit the token to a subset of the account's zones using one or more instances of <code>Specific zone</code>.</p> <ul> <li>Click <code>Create Token</code></li> <li>Find the <code>Edit zone DNS</code> token template and click <code>Use template</code></li> <li>(Optional) Click the pencil icon to rename the token</li> <li>The Permissions list should already contain Zone - DNS - Edit</li> <li>Set Zone Resources to Include - All zones (or whatever alternative scope you like)</li> <li>(Optional) Add IP address filtering to limit where API requests can come from for this token</li> <li>(Optional) Set a TTL Start/End date. NOTE: Setting a TTL will require generating a new token when it expires and updating your Posh-ACME config with the new value.</li> <li>Click <code>Continue to summary</code></li> <li>Click <code>Create Token</code></li> <li>Copy the token value from the summary screen  because it can't be retrieved after leaving this page. You must generate a new value if you forget or lose the old one.</li> </ul>"},{"location":"Plugins/Cloudflare/#global-api-key","title":"Global API Key","text":"<ul> <li>In the API Keys section, click <code>View</code> for the \"Global API Key\"</li> <li>You may need to re-enter the account password and answer a CAPTCHA.</li> <li>Copy the key value for later.</li> </ul>"},{"location":"Plugins/Cloudflare/#using-the-plugin","title":"Using the Plugin","text":"<p>If you're using the newer API Token method, you'll use it with the <code>CFToken</code> SecureString parameter. If you're using the Global API Key method, you'll need to use the <code>CFAuthEmail</code> and <code>CFAuthKeySecure</code> parameters with the account's email address as a string and previously retrieved Global API Key as a SecureString.</p> <p>Warning</p> <p>The <code>CFTokenInsecure</code> and <code>CFAuthKey</code> parameters are deprecated and will be removed in the next major module version. If you are using them, please migrate to one of the Secure parameter sets.</p>"},{"location":"Plugins/Cloudflare/#api-token_1","title":"API Token","text":"<pre><code>$pArgs = @{\n    CFToken = (Read-Host 'API Token' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Cloudflare -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Cloudflare/#global-api-key_1","title":"Global API Key","text":"<pre><code>$pArgs = @{\n    CFAuthEmail = 'xxxx@example.com'\n    CFAuthKeySecure = (Read-Host 'Global API Key' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Cloudflare -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Combell/","title":"How To Use the Combell DNS Plugin","text":"<p>Combell NV is a hosting provider based in Belgium. Besides offering hosting solutions, Combell NV is an  ICANN Accredited Registrar under IANA number 1467.</p> <p>This plugin works with the Combell DNS provider by using the Combell Reseller API.</p> <p>Warning</p> <p>The Combell Reseller API (also referred to as the Combell API), is only available for reseller accounts, which are more expensive than normal accounts. A free trial is available - see reseller hosting for more information. |</p> <p>The remainder of this document assumes you have a reseller account and have created the DNS domain zone(s) you'll be working with.</p>"},{"location":"Plugins/Combell/#setup","title":"Setup","text":"<p>The Combell API can be activated for any administrator in the Combell reseller account.</p> <p>To add administrators, navigate to Dashboard / Settings / Administrators, and click the Invite administrator button to add an administrator.</p> <p>Click the Permissions button next to an administrator's name, and ensure the administrator's permssions is configured as All rights (\"User  has access to all the products in this customer account\"). <p>Next, navigate to Dashboard / Settings / API / Users and activate the API key for the required administrator(s): - Click the API key button next to the administrator's user name; - Click the Activate the API key button (\"Activate an API key for this user.\");</p> <p>The API key and API secret will now appear. You'll need them in the next section Using the Plugin.</p>"},{"location":"Plugins/Combell/#ip-address-whitelisting","title":"IP address whitelisting","text":"<p>The Combell API can only be accessed from registered IP addresses.</p> <p>Navigate to Dashboard / Settings / API / IP restrictions and add your public IP address(es) to the whitelist.</p>"},{"location":"Plugins/Combell/#using-the-plugin","title":"Using the Plugin","text":"<p>The API Key and Secret and used with the <code>CombellApiKey</code> and <code>CombellApiSecret</code> parameters as SecureString values. Using SecureString ensures the values are saved to disk in encrypted form by Posh-ACME for later renewals.</p> <pre><code>$pArgs = @{\n    CombellApiKey = (Read-Host \"Combell API key\" -AsSecureString)\n    CombellApiSecret = (Read-Host \"Combell API secret\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Combell -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Combell/#external-links","title":"External links","text":"<ul> <li>Combell.com.</li> <li>Combell API Documentation.</li> </ul>"},{"location":"Plugins/Constellix/","title":"How To Use the Constellix Plugin","text":"<p>This plugin works against the Constellix DNS provider. It is assumed that you already have an account and at least one managed zone already configured.</p>"},{"location":"Plugins/Constellix/#setup","title":"Setup","text":"<p>While you can use an account with the \"Admin\" role, it is not recommended for security reasons. Instead, you should create an account from the User Management Console with the \"User\" role and limit it to the DNS service on the account. Then, go to the DNS Users Console and modify the <code>Domains</code> permissions to include:</p> <ul> <li>(Optional) New domain permissions on creation: <code>Read/Write/Commit</code>. If you leave this on <code>None</code>, you will need to manually give permissions to future domains when they are created.</li> <li>Uncheck \"Add Domains\"</li> <li>Uncheck \"Delete Domains\"</li> <li><code>Read/Write/Commit</code> on either \"All Domains\" or a selected subset of domains you will be using Posh-ACME with.</li> </ul> <p>Now login to the management console as the user who will be using Posh-ACME and go to Edit My Info. Click the <code>Generate API Keys</code> button and record the values for \"API Key\" and \"Secret Key\". This is the only time they will be displayed.</p>"},{"location":"Plugins/Constellix/#using-the-plugin","title":"Using the Plugin","text":"<p>The API key will used with the <code>ConstellixKey</code> parameter as a string value. The API secret will be used with the <code>ConstellixSecret</code> parameter as a SecureString value.</p> <pre><code>$pArgs = @{\n    ConstellixKey = 'xxxxxxxxxxxx'\n    ConstellixSecret = (Read-Host 'API Secret' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Constellix -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/CoreNetworks/","title":"How To Use the Core Networks DNS Plugin","text":"<p>This plugin works against the Core Networks DNS provider. It is assumed that you have already setup an (API)Account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/CoreNetworks/#setup","title":"Setup","text":"<p>On your account profile page, click <code>Add Access</code>. Give it custom a username and a strong password. Record the value to use later. You won't be able to go back and look it up after leaving the page.</p> <p>At the moment, no Internationalized Domain Name (IDN) are supported.</p>"},{"location":"Plugins/CoreNetworks/#using-the-plugin","title":"Using the Plugin","text":"<p>Your username and password are used with the <code>CoreNetworksCred</code> PSCredential parameter. There is also an optional <code>CoreNetworksApiRoot</code> parameter that currently defaults to <code>https://beta.api.core-networks.de</code>. Unless Core Networks changes that URL when the API is out of beta, you won't need to worry about it.</p> <pre><code>$pArgs = @{\n    CoreNetworksCred = (Get-Credential)\n}\nNew-PACertificate example.com -Plugin CoreNetworks -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/DMEasy/","title":"How To Use the DMEasy DNS Plugin","text":"<p>This plugin works against the DNS Made Easy provider. It is assumed that you already have an account and at least one Managed zone you will be working against.</p>"},{"location":"Plugins/DMEasy/#setup","title":"Setup","text":"<p>If you haven't done it already, you need to generate API Credentials for your account from the Account Information page. You should end up with an <code>API Key</code> and <code>Secret Key</code> value. These are what we will use with the plugin.</p>"},{"location":"Plugins/DMEasy/#using-the-plugin","title":"Using the Plugin","text":"<p>With your API key and secret, you'll need to pass them with the <code>DMEKey</code> parameter and the <code>DMESecret</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>DMESecuretInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    DMEKey = 'xxxxxxxxxxxx'\n    DMESecret = (Read-Host 'DME Secret' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin DMEasy -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/DNSPod/","title":"How To Use the DNSPod DNS Plugin","text":"<p>This plugin works against the DNSPod provider. It is assumed that you have already setup an account and created the domain you will be working against.</p> <p>Warning</p> <p>DNSPod is now integrated with Tencent Cloud and will eventually be disabling the legacy DNSPod Token authentication this plugin uses. It is recommended to switch to the TencentDNS plugin instead.</p>"},{"location":"Plugins/DNSPod/#setup","title":"Setup","text":"<p>As of November 13, 2020, DNSPod was integrated with Tencent Cloud and slightly changed how their API works. Instead of authenticating with your normal website login credentials, you must create an API token to use instead.</p> <p>Login to the console and go to the Key Management section. Create a new key and make a note of its ID and Token values.</p>"},{"location":"Plugins/DNSPod/#using-the-plugin","title":"Using the Plugin","text":"<p>The API key ID is used with the <code>DNSPodKeyId</code> string parameter. The key token is used with <code>DNSPodKeyToken</code> as a SecureString.</p> <p>Warning</p> <p>The <code>DNSPodKeyTokenInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <p>There is also a <code>DNSPodApiRoot</code> optional parameter that defaults to the API root for dnspod.com. If you are using dnspod.cn, you may specify <code>https://dnsapi.cn</code> instead for this parameter.</p> <pre><code>$pArgs = @{\n    DNSPodKeyID = '111'\n    DNSPodKeyToken = (Read-Host 'Enter Token' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin DNSPod -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/DNSimple/","title":"How To Use the DNSimple DNS Plugin","text":"<p>This plugin works against the DNSimple DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p> <p>Note</p> <p>The link above is an affiliate link which reduces my out of pocket cost to maintain this plugin. I'd be most grateful if you use it when signing up for a new account.</p>"},{"location":"Plugins/DNSimple/#setup","title":"Setup","text":"<p>This plugin works with both User and Account access tokens. Access tokens are generally preferred because User tokens may have access to multiple accounts. User tokens would only be necessary if the cert you're generating includes names from zones that span multiple accounts.</p> <p>Login to the User Settings section of the dashboard. For Account tokens:</p> <ul> <li>Scroll to the Accounts section</li> <li>Click the appropriate account link</li> <li>Click <code>Access Tokens</code></li> <li>Click <code>Add</code></li> </ul> <p>For User tokens:</p> <ul> <li>Scroll to the User access tokens section</li> <li>Click <code>Add</code></li> </ul> <p>After giving the token a name, it will show you the token string. Be sure to save it as you can't look it up if you forget later. You can only generate a new one.</p>"},{"location":"Plugins/DNSimple/#using-the-plugin","title":"Using the Plugin","text":"<p>With your token value, you'll need to set the <code>DSToken</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>DSTokenInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    DSToken = (Read-Host \"DNSimple Token\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin DNSimple -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/DOcean/","title":"How To Use the DOcean DNS Plugin","text":"<p>This plugin works against the Digital Ocean DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p> <p>Note</p> <p>The link above is an affiliate link which reduces my out of pocket cost to maintain this plugin. I'd be most grateful if you use it when signing up for a new account.</p>"},{"location":"Plugins/DOcean/#setup","title":"Setup","text":"<p>You need to create a Personal Access Token so the plugin can access Digital Ocean's API.</p> <ul> <li>Click <code>Generate New Token</code></li> <li>Name: Posh-ACME</li> <li>Check the <code>Write (optional)</code> box</li> <li>Click <code>Generate Token</code></li> <li>Copy the resulting token string somewhere safe. There's no way to retrieve it once you leave this page. You would have to delete the old one and create a new one.</li> </ul>"},{"location":"Plugins/DOcean/#using-the-plugin","title":"Using the Plugin","text":"<p>Use the <code>DOTokenSecure</code> SecureString parameter with the token value you created earlier.</p> <p>Warning</p> <p>The <code>DOToken</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    DOTokenSecure = (Read-Host 'Access Token' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin DOcean -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/DeSEC/","title":"How To Use the deSEC DNS Plugin","text":"<p>This plugin works against the deSEC DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/DeSEC/#setup","title":"Setup","text":"<p>You may already have an API token from your original registration email. If not, go to the Token Management page and create a new one. The value will only be shown once towards the bottom of the screen. It is not the ID value in the list of tokens.</p>"},{"location":"Plugins/DeSEC/#using-the-plugin","title":"Using the Plugin","text":"<p>You will need to provide the API token as a SecureString value to <code>DSCToken</code>. There is an optional <code>DSCTTL</code> parameter to use as the TTL of new <code>TXT</code> record. It defaults to 3600 which seems to be the minimum value allowed by the API.</p> <p>Warning</p> <p>The <code>DSToken</code>, <code>DSTokenInsecure</code>, and <code>DSTTL</code> parameters have been deprecated because they conflicted with another Posh-ACME plugin. If you are using them, please migrate to the newer parameters as they will be removed in the next major version of the module.</p> <pre><code>$pArgs = @{\n    DSCToken = (Read-Host \"deSEC Token\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin DeSEC -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/DomainOffensive/","title":"How To Use the Domain Offensive DNS Plugin","text":"<p>This plugin works against the Domain Offensive DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/DomainOffensive/#setup","title":"Setup","text":"<p>We need to retrieve an secret API token for the account that will be used to update DNS records. Further information can be found at the (german) developer docs.</p>"},{"location":"Plugins/DomainOffensive/#using-the-plugin","title":"Using the Plugin","text":"<p>Your personal API token is specified using the <code>DomOffToken</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>DomOffTokenInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    DomOffToken = (Read-Host -Prompt \"Token\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin DomainOffensive -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Domeneshop/","title":"How To Use the Domeneshop DNS Plugin","text":"<p>This plugin works against the Domeneshop DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p> <p>Warning</p> <p>The API is currently (May 2019) a beta (\"version 0\"). The interface may change before it is released and those changes may break this plugin. Domeneshop recommends not relying on the API for mission critical services until it has been released.</p>"},{"location":"Plugins/Domeneshop/#setup","title":"Setup","text":"<p>We need to retrieve an API token and secret for the account that will be used to update DNS records. Login to Domeneshop using the account that will be used to update DNS.</p>"},{"location":"Plugins/Domeneshop/#using-the-plugin","title":"Using the Plugin","text":"<p>The API token is specified using the <code>DomeneshopToken</code> string parameter. The secret is specified with the <code>DomeneshopSecret</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>DomeneshopSecretInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    DomeneshopToken = 'xxxxxxxxxxxx'\n    DomeneshopSecret = (Read-Host \"Secret\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Domeneshop -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Dreamhost/","title":"How To Use the Dreamhost DNS Plugin","text":"<p>This plugin works against the Dreamhost API. It is assumed that you already have web hosting through Dreamhost and are using Dreamhost to manage DNS for your domain(s).</p>"},{"location":"Plugins/Dreamhost/#setup","title":"Setup","text":"<p>We need to generate the API key that will be used to update DNS records. Open the Web Panel API page, and generate a new API key with dns-add_record, and dns-remove_record permissions. It is recommended to name this API key something memorable like \"Posh-ACME\" by entering this in the \"Comment for this key\" field. Take note of your new API key.</p>"},{"location":"Plugins/Dreamhost/#using-the-plugin","title":"Using the Plugin","text":"<p>You will use the previously generated API key with the <code>DreamhostApiKeySecure</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>DreamhostApiKey</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    DreamhostApiKeySecure = (Read-Host 'Key' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Dreamhost -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/DuckDNS/","title":"How To Use the DuckDNS Plugin","text":"<p>This plugin works against the Duck DNS provider. It is assumed that you have already setup an account and created the domain(s) you will be working against.</p>"},{"location":"Plugins/DuckDNS/#setup","title":"Setup","text":"<p>Look for a <code>token</code> value listed on the Duck DNS homepage after you login. You'll need to supply this value as one of the plugin parameters. You will also need the domain subname for each domain that matches one of the names in the certificate you request.</p> <p>So if you're requesting a cert for <code>www.mydomain.duckdns.org</code> and <code>www.myotherdomain.duckdns.org</code>, you would need both <code>mydomain</code> and <code>myotherdomain</code>.</p>"},{"location":"Plugins/DuckDNS/#using-the-plugin","title":"Using the Plugin","text":"<p>Duck DNS has a rather annoying limitation that there can only ever be a single TXT record associated with all domains on your account. This means that if you request a certificate with multiple names, each name must be validated separately instead of just creating all of the TXT records at once and validating them together. This can make the entire process take a lot longer depending on how many names are in the certificate. In order for Posh-ACME to process the validations in serial rather than parallel, you must specify the <code>UseSerialValidation</code> switch in your call to <code>New-PACertificate</code>.</p> <p>Your API token is specified using the <code>DuckToken</code> SecureString parameter. You also need to specify the domain subnames using the <code>DuckDomain</code> parameter.</p> <p>Warning</p> <p>The <code>DuckTokenInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    DuckToken = (Read-Host -Prompt \"Token\" -AsSecureString)\n    DuckDomain = 'mydomain1'\n}\n$certNames = 'mydomain1.duckdns.org','www.mydomain1.duckdns.org'\nNew-PACertificate $certNames -UseSerialValidation -Plugin DuckDNS -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Dynu/","title":"How To Use the Dynu DNS Plugin","text":"<p>This plugin works against the Dynu DNS provider. It is assumed that you have already setup an account configured at least one DDNS domain to work against.</p> <p>Warning</p> <p>Dynu imposes some limitations on non-paid accounts. The most significant is a limit of 4 DNS records per domain which effectively means you can only create a cert with up to 4 names in it from the same domain (and only if you have no other DNS records counting against your limit). Additionally, if you are using one of Dynu's provided domain names, their official policy (as of 03/2019) is that you can't create TXT records until the domain is 30 days old. Though currently, that limitation only seems to apply to the web GUI.</p>"},{"location":"Plugins/Dynu/#setup","title":"Setup","text":"<p>You will need to retrieve the Client ID and Secret that will be used to update DNS records. You can find these on your Dynu Control Panel.</p>"},{"location":"Plugins/Dynu/#using-the-plugin","title":"Using the Plugin","text":"<p>The Client ID is used with the <code>DynuClientID</code> string parameter and the secret is used with the <code>DynuSecretSecure</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>DynuSecret</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    DynuClientID = 'xxxxxxxx'\n    DynuSecretSecure = (Read-Host 'Secret' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Dynu -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Dynu/#quota-exception-error","title":"\"Quota Exception\" error","text":"<p>If you get this message it likely means you're on a free account and you've added too many names from the same domain to a certificate. See the note at the top of this guide for details.</p>"},{"location":"Plugins/EasyDNS/","title":"How To Use the EasyDNS Plugin","text":"<p>This plugin works against the EasyDNS provider. It is assumed that you have already setup an account with a domain registered.</p> <p>Warning</p> <p>The EasyDNS REST API is currently (August 2019) in BETA status and has been for quite a while. Beta APIs may change prior to release and potentially break this plugin. Please don't rely on it for mission critical things.</p>"},{"location":"Plugins/EasyDNS/#setup","title":"Setup","text":"<p>Documentation, including signup instructions, is available at http://docs.sandbox.rest.easydns.net/. When you first receive an API Token and Key, they will be for the sandbox environment, not the live environment. In the sandbox environment, publishing and unpublishing challenge records will work but they will not be hosted as public DNS records and thus can't be used to get a certificate. To move to the live environment, you will need to email the API support team with the request.</p>"},{"location":"Plugins/EasyDNS/#using-the-plugin","title":"Using the Plugin","text":"<p>The API Token is used with the <code>EDToken</code> string parameter. The API Key is used with the <code>EDKeySecure</code> SecureString parameter. If you are testing against the sandbox environment, you must also include <code>EDUseSandbox = $true</code>.</p> <p>Warning</p> <p>The <code>EDKey</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    EDToken = 'xxxxxxxxxxxxxxxx'\n    EDKeySecure = (Read-Host 'Key' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin EasyDNS -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Easyname/","title":"How To Use the Easyname Plugin","text":"<p>This plugin works against the Easyname hosting provider. It is assumed that you have already setup an account and have at least one domain registered.</p> <p>Warning</p> <p>As of April 2021, Easyname's REST API is extremely limited in functionality and doesn't allow for DNS record manipulation. So this plugin utilizes web scraping to accomplish the task. That also means it is more likely to break if the site owner ever changes their HTML markup. So be wary of depending on this for critical projects.</p>"},{"location":"Plugins/Easyname/#setup","title":"Setup","text":"<p>Because the plugin uses web scraping to manipulate DNS records, all that is needed is your standard login credentials which should include an email address and password.</p>"},{"location":"Plugins/Easyname/#using-the-plugin","title":"Using the Plugin","text":"<p>Your login credentials should be used with the <code>EasynameCredential</code> parameter which is a PSCredential object.</p> <pre><code>$pArgs = @{\n    EasynameCredential = (Get-Credential)\n}\nNew-PACertificate example.com -Plugin Easyname -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/EuroDNSReseller/","title":"How To Use the EuroDNSReseller DNS Plugin","text":"<p>This plugin works with the EuroDNS DNS provider. While it is possible to purchase domains directly from EuroDNS, their APIs are currently only available to Reseller Partners. Some of those partners such as EBrand can provide EuroDNS API access to their customers. So in order to use this plugin, you will need to be using a reseller that will create API credentials for you.</p> <p>Note</p> <p>As of November 2024, EuroDNS support has indicated the API (or perhaps a new API) will eventually be available for all direct customers. However, they would not provide an estimate for when that might be available.</p>"},{"location":"Plugins/EuroDNSReseller/#setup","title":"Setup","text":"<p>Setup involves getting API credentials from your reseller which will vary depending on the reseller. The values you need are known as <code>X-APP-ID</code> and <code>X-API-KEY</code>.</p>"},{"location":"Plugins/EuroDNSReseller/#using-the-plugin","title":"Using the Plugin","text":"<p>The <code>X-APP-ID</code> and <code>X-API-KEY</code> will be used as the username and password in a PSCredential object called <code>EuroDNSReseller_Creds</code>.</p> <p>Here are two examples on how you can use them:</p> <pre><code># Prompt for the credentials where username is X-APP-ID\n# and password is X-API-KEY\n$pArgs = @{EuroDNSReseller_Creds = Get-Credential}\n\nNew-PACertificate example.com -Plugin EuroDNSReseller -PluginArgs $pArgs\n</code></pre> <p>For a more automated approach (This method assumes you understand the risks and methods to secure the below credentials):</p> <pre><code>$username = \"My_X-APP-ID_Value\"\n$password = \"My_X-API-Key_Value\" | ConvertTo-SecureString -AsPlainText -Force\n$cred = [pscredential]::new($username, $password)\n$pArgs = @{EuroDNSReseller_Creds = $cred}\n\nNew-PACertificate example.com -Plugin EuroDNSReseller -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/FreeDNS/","title":"How To Use the FreeDNS Plugin","text":"<p>This plugin works against Free DNS. It is assumed that you have an existing account. Free and Premium accounts are both supported, but there are limitations on Free accounts unless the domain you're using is actually owned by you. There are also limitations on Premium accounts if you do not own the domain you're using.</p>"},{"location":"Plugins/FreeDNS/#setup","title":"Setup","text":"<p>The only setup needed aside from knowing your account credentials is manually adding at least one subdomain/record to the domain you're going to be working against. The plugin grabs a list of available domains from the Subdomains page. So anything not showing on that page won't be found by the plugin.</p>"},{"location":"Plugins/FreeDNS/#limitations","title":"Limitations","text":""},{"location":"Plugins/FreeDNS/#free-accounts","title":"Free Accounts","text":"<p>Solving a CAPTCHA is required in order to create any records on domains you don't own. This makes it impossible to automate with the plugin. Make sure you own the domains you're working against.</p>"},{"location":"Plugins/FreeDNS/#free-and-premium-accounts","title":"Free and Premium Accounts","text":"<p>Regardless of your account status, Free DNS does not currently allow you to create records beginning with an underscore (<code>_</code>) unless you own the underlying domain you're creating the records on. Because Let's Encrypt DNS challenges require creating a TXT record that starts with <code>_acme-challenge</code>, you will be unable to generate a certificate for a Free DNS hosted domain unless you own it.</p> <p>The only thing you can use a non-owned domain for are challenge aliases. But due to the CAPTCHA limitation on Free accounts, only Premium accounts can do this. If using challenge aliases, make sure your CNAME points to a record that does not start with <code>_</code>.</p>"},{"location":"Plugins/FreeDNS/#using-the-plugin","title":"Using the Plugin","text":"<p>Your account credentials will be used with the <code>FDCredential</code> parameter which is a PSCredential object.</p> <p>Warning</p> <p>The <code>FDUsername</code> and <code>FDPassword</code> parameters are deprecated and will be removed in the next major module version. If you are using them, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    FDCredential = (Get-Credential)\n}\nNew-PACertificate example.com -Plugin FreeDNS -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/GCloud/","title":"How To Use the GCloud DNS Plugin","text":"<p>This plugin works against the Google Cloud DNS provider. It is assumed that you have already setup a project, billing, and created the DNS zone(s) you will be working against. If not, check the Cloud DNS Quickstart.</p>"},{"location":"Plugins/GCloud/#setup","title":"Setup","text":"<p>We need to create a service account and give it permission to add TXT records to the zone(s) we'll be issuing certificates for.</p>"},{"location":"Plugins/GCloud/#create-a-custom-role","title":"Create a Custom Role","text":"<p>It's always a good idea to limit a service account's access to only what is needed to perform its function. So rather than giving it the default <code>DNS Administrator</code> role, we'll create a custom one that is less dangerous. Start by going to the IAM Roles page and make sure the project containing your DNS zone is selected.</p> <ul> <li>Filter the Roles for \"dns\" and find the <code>DNS Administrator</code> role</li> <li>Open the context menu for the role and click <code>Create role from this role</code></li> <li>Title: <code>DNS Zone Editor</code></li> <li>Description: <code>List/Read Zones and Write Zone data</code></li> <li>ID: <code>DNSZoneEditor</code></li> <li>Role launch stage: <code>General Availability</code></li> <li>In the list of permissions, uncheck all except the following:</li> <li><code>dns.changes.create</code></li> <li><code>dns.changes.get</code></li> <li><code>dns.changes.list</code></li> <li><code>dns.managedZones.get</code></li> <li><code>dns.managedZones.list</code></li> <li><code>dns.resourceRecordSets.create</code></li> <li><code>dns.resourceRecordSets.delete</code></li> <li><code>dns.resourceRecordSets.get</code></li> <li><code>dns.resourceRecordSets.list</code></li> <li><code>dns.resourceRecordSets.update</code></li> <li>Click <code>Create</code></li> </ul> <p>This will give the account it is applied to the ability to edit all record types for all existing zones in the current project. Unfortunately, the current Google APIs don't allow us to further restrict this role so that the account can only modify TXT records or only specific zones.</p>"},{"location":"Plugins/GCloud/#create-a-service-account","title":"Create a Service Account","text":"<p>Start by going to the Service accounts page and make sure the correct project is selected.</p> <ul> <li>Click <code>Create service account</code></li> <li>Service account name: <code>posh-acme</code></li> <li>Role: <code>DNS Zone Editor</code></li> <li>Check <code>Furnish a new private key</code></li> <li>Key type: <code>JSON</code></li> <li>Click <code>Create</code></li> <li>A JSON file should be automatically downloaded. Don't lose it.</li> </ul> <p>If you have multiple projects with DNS zones that this account will need to modify, you can grant cross-project access by creating the same <code>DNS Zone Editor</code> role in the other projects and then granting the role to this service account by referencing its Principal ID which usually looks like <code>&lt;id&gt;@&lt;project&gt;.iam.gserviceaccount.com</code>.</p>"},{"location":"Plugins/GCloud/#using-the-plugin","title":"Using the Plugin","text":"<p>If all of your DNS zones are in the same project as your service account, the only plugin argument you need is <code>GCKeyFile</code> which is the path to the JSON account file you downloaded. The plugin will cache the contents of this file on each use in case the original gets deleted or moved. But as long as it still exists, the real file will take precedence over the cached copy so you can update it in the future if necessary.</p> <pre><code>$pArgs = @{\n  GCKeyFile = '&lt;path to json&gt;'\n}\nNew-PACertificate example.com -Plugin GCloud -PluginArgs $pArgs\n</code></pre> <p>If your DNS zones are in a different project than your service account or if you have zones that span multiple projects, you will also need to supply the <code>GCProjectId</code> parameter with all of the project IDs that contain your DNS zones (including the one associated with the service account).</p> <pre><code>$pArgs = @{\n  GCKeyFile = '&lt;path to json&gt;'\n  GCProjectId = 'project1','project2'\n}\nNew-PACertificate example.com -Plugin GCloud -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/GCloud/#app-engine-compatibility-note","title":"App Engine Compatibility Note","text":"<p>If you're planning on uploading your certificate to Google App Engine, it has been reported that it only supports RSA based certificates. So don't use an ECC key option. It also requires the private key to be in PKCS#1 format and the module currently outputs the key as PKCS#8. You can convert it with openssl using the following command:</p> <pre><code>openssl rsa -in cert.key -out cert-pkcs1.key\n</code></pre>"},{"location":"Plugins/Gandi/","title":"How To Use the Gandi DNS Plugin","text":"<p>This plugin works against the Gandi DNS provider. It is assumed that you have already setup an account and have a registered domain with an associated DNS zone you will be working against.</p>"},{"location":"Plugins/Gandi/#setup","title":"Setup","text":"<p>First, login to your account page and go to the <code>Authentication Options</code> section. Down at the bottom in the <code>Developer access</code> section, there are options for <code>Personal Access Token (PAT)</code> and <code>API Key (Deprecated)</code>.</p> <p>It is no longer recommended to use the API Key option since it has been deprecated. But it should continue to work with the plugin as long as they allow it to. The main benefit over the PAT option is that it doesn't expire.</p> <p>In the PAT section, click the link for <code>See my personal access tokens</code>. Then click the <code>Create a token</code> button.</p> <ul> <li>Select the appropriate organization</li> <li>Give it a cosmetic name</li> <li>Set the expiration time (1 year is currently the max)</li> <li>Choose whether to limit the PAT to a specific set of domains</li> <li>Select the option for <code>Manage domain name technical configurations</code> which will force the selection of <code>See and renew domain names</code>.</li> <li>Click <code>Create</code>.</li> </ul> <p>Record the token value and set a reminder to create a new PAT before the old one expires.</p>"},{"location":"Plugins/Gandi/#using-the-plugin","title":"Using the Plugin","text":"<p>The Personal Access Token (PAT) is used with the <code>GandiPAT</code> SecureString parameter. If you are using the Legacy API Key option, use the <code>GandiToken</code> SecureString parameter instead.</p> <p>Warning</p> <p>The <code>GandiTokenInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to one of the Secure parameter sets.</p>"},{"location":"Plugins/Gandi/#example-for-personal-access-token","title":"Example for Personal Access Token","text":"<pre><code>$pArgs = @{\n    GandiPAT = (Read-Host \"Personal Access Token\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Gandi -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Gandi/#example-for-legacy-api-key","title":"Example for Legacy API Key","text":"<pre><code>$pArgs = @{\n    GandiToken = (Read-Host \"Legacy API Key\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Gandi -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/GoDaddy/","title":"How To Use the GoDaddy DNS Plugin","text":"<p>This plugin works against the GoDaddy DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against. </p> <p>Warning</p> <p>From April 2024 GoDaddy have introduced API account limits which prevent DNS API access for customers with less than 10 domains on their account. Existing accounts that don't meet the new requirements will now receive an Access Denied error when communicating with the API.</p>"},{"location":"Plugins/GoDaddy/#setup","title":"Setup","text":"<p>We need to generate an API key for the production GoDaddy environment.</p> <ul> <li>Click <code>Create New API Key</code></li> <li>Name: Posh-ACME</li> <li>Environment: Production</li> <li>Click <code>Next</code></li> <li>Copy the resulting key and secret strings somewhere safe. There's no way to retrieve the secret once you leave this page. You would have to delete the old one and create a new one.</li> </ul>"},{"location":"Plugins/GoDaddy/#using-the-plugin","title":"Using the Plugin","text":"<p>The Key is used with the <code>GDKey</code> string parameter and the Secret is used with the <code>GDSecretSecure</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>GDSecret</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    GDKey = 'xxxxxxxxxxxxxxxx'\n    GDSecret = (Read-Host 'Secret' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin GoDaddy -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/GoogleDomains/","title":"How To Use the Google Domains Plugin","text":"<p>This plugin is for domains registered with Google Domains and using its native DNS service. Do not confuse it with Google Cloud DNS which should use the GCloud plugin instead.</p>"},{"location":"Plugins/GoogleDomains/#setup","title":"Setup","text":"<p>With your domain selected in the Google Domains interface, browse to the Security section and choose Create Token under <code>DNS ACME API</code>. Save the secret token value that is generated. You will provide it to the plugin along with the root domain.</p>"},{"location":"Plugins/GoogleDomains/#using-the-plugin","title":"Using the Plugin","text":"<p>To generate a certificate that is comprised of names all within a single domain, you will pass the root domain and the access token as a PSCredential object to the <code>GDomCredential</code> parameter where the username is the root domain and the password is the access token.</p> <pre><code>$pArgs = @{\n    GDomCredential = Get-Credential -Username example.com\n}\nNew-PACertificate 'example.com','www.example.com' -Plugin GoogleDomains -PluginArgs $pArgs\n</code></pre> <p>If you are generating a certificate that uses names from multiple domains, make sure you have an access token for each domain and provide an array of PSCredential objects to the <code>GDomCredential</code> parameter for each unique domain in your cert.</p> <pre><code>$pArgs = @{\n    GDomCredential = @(\n        (Get-Credential -Username example.com)\n        (Get-Credential -Username example.net)\n    )\n}\nNew-PACertificate 'www.example.com','www.example.net' -Plugin GoogleDomains -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Hetzner/","title":"How To Use the Hetzner DNS Plugin","text":"<p>This plugin works against the Hetzner DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/Hetzner/#setup","title":"Setup","text":"<p>You will need to generate an API Token if you haven't already done so. Go to Manage API tokens after logging in to the DNS Console. Give the token a name and click <code>Create access token</code>. Make a note of the token value as you'll need it later and won't be able to retrieve it after this point.</p>"},{"location":"Plugins/Hetzner/#using-the-plugin","title":"Using the Plugin","text":"<p>You will need to provide the API Token as a SecureString value to <code>HetznerToken</code>.</p> <p>Warning</p> <p>The <code>HetznerTokenInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    HetznerToken = (Read-Host 'Hetzner Token' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Hetzner -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/HostingDe/","title":"How To Use the HostingDe Plugin","text":"<p>This plugin works against the Hosting.de provider. It is assumed that you already have an account and at least one managed zone already configured.</p>"},{"location":"Plugins/HostingDe/#setup","title":"Setup","text":"<p>On your account profile page, click <code>Create new API key</code>. Give it a name, and uncheck all permissions except \"Display\" and \"Edit\" within DNS Service - Zones. Record the value to use later. You won't be able to go back and look it up after leaving the page.</p>"},{"location":"Plugins/HostingDe/#using-the-plugin","title":"Using the Plugin","text":"<p>The API key will used with the <code>HDEToken</code> parameter as a SecureString value.</p> <pre><code>$pArgs = @{\n    HDEToken = (Read-Host 'API Token' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin HostingDe -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/HurricaneElectric/","title":"How To Use the HurricaneElectric Plugin","text":"<p>This plugin works against Hurricane Electric DNS. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p> <p>Note</p> <p>Hurricane Electric can be configured as a secondary to your primary zones hosted elsewhere. This plugin will not work for secondary zones. You must use a plugin that is able to modify the primary nameservers.</p>"},{"location":"Plugins/HurricaneElectric/#setup","title":"Setup","text":"<p>There's not really any setup aside from knowing your account credentials. Hurricane Electric doesn't currently support an API for manipulating DNS records. So this plugin utilizes web scraping to accomplish the task. That also means it is more likely to break if the site owner ever changes their HTML markup. So be wary of depending on this for critical projects.</p>"},{"location":"Plugins/HurricaneElectric/#using-the-plugin","title":"Using the Plugin","text":"<p>Your account credentials will be used with the <code>HECredential</code> parameter as a PSCredential object.</p> <p>Warning</p> <p>The <code>HEUsername</code> and <code>HEPassword</code> parameters are deprecated and will be removed in the next major module version. If you are using them, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    HECredential = (Get-Credential)\n}\nNew-PACertificate example.com -Plugin HurricaneElectric -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/HurricaneElectricDyn/","title":"How To Use the HurricaneElectricDyn Plugin","text":"<p>This plugin works against Hurricane Electric DNS. It uses HE's DynDNS API instead of web scraping like the normal <code>HurricaneElectric</code> plugin. It less risky to use because it doesn't require supplying your HE account username and password. It is also less likely to break over time as a supported API. However, it is also more tedious to setup and use. You should already have an account and created the DNS zone(s) you will be working against.</p> <p>Note</p> <p>Hurricane Electric can be configured as a secondary to your primary zones hosted elsewhere. This plugin will not work for secondary zones. You must use a plugin that is able to modify the primary nameservers.</p>"},{"location":"Plugins/HurricaneElectricDyn/#setup","title":"Setup","text":"<p>Due to limitations in how HE's DynDNS API authentication works, you must pre-create all of the DNS TXT records that will be necessary for the cert you are requesting. Each record must be created with dynamic DNS enabled and then a key/password either set or generated for that record.</p> <p>For each DNS name in your certificate, you will need to create a TXT record called <code>_acme-challenge.&lt;DNS name&gt;</code> in the zone. So if your domain is <code>example.com</code>, and you want to create a certificate for both the domain root and <code>www.example.com</code>, you would need two TXT records: <code>_acme-challenge.example.com</code> and <code>_acme-challenge.www.example.com</code>. Wildcard names such as <code>*.example.com</code> should have records created as if the wildcard portion wasn't there like <code>_acme-challenge.example.com</code>.</p> <p>Login to https://dns.he.net/ and go into the Edit Zone page for the zone you will be creating records in.</p> <ul> <li>Click the <code>New TXT</code> button</li> <li>Add the required <code>Name</code> value</li> <li>Check the box for <code>Enable entry for dynamic dns</code></li> <li>Click <code>Submit</code></li> <li>Back in the Zone Edit page, click the icon in the <code>DDNS</code> column next to the record</li> <li>Set an appropriate password for click the <code>Generate a key</code> button to use a randomly generated password</li> <li>Click <code>Submit</code></li> </ul> <p>You will need to supply both the record name and DDNS password to the plugin for each record you created.</p>"},{"location":"Plugins/HurricaneElectricDyn/#using-the-plugin","title":"Using the Plugin","text":"<p>Your record name(s) and DDNS password(s) are used with the <code>HEDynCredential</code> parameter as an array of PSCredential objects. If you only have one name in the cert, you only need to supply one credential.</p> <pre><code>$rootPass = Read-Host 'Root Domain' -AsSecureString\n$wwwPass = Read-Host 'www' -AsSecureString\n\n$pArgs = @{\n    HEDynCredential = @(\n        [pscredential]::new('_acme-challenge.example.com',$rootPass)\n        [pscredential]::new('_acme-challenge.www.example.com',$wwwPass)\n    )\n}\nNew-PACertificate 'example.com','www.example.com' -Plugin HurricaneElectricDyn -PluginArgs $pArgs\n</code></pre> <p>If you are getting a wildcard cert that also includes the root domain, you will need to use the <code>-UseSerialValidation</code> parameter.</p> <pre><code>$rootPass = Read-Host 'Root Domain' -AsSecureString\n\n$pArgs = @{\n    HEDynCredential = [pscredential]::new('_acme-challenge.example.com',$rootPass)\n}\nNew-PACertificate 'example.com','*.example.com' -Plugin HurricaneElectricDyn -PluginArgs $pArgs -UseSerialValidation\n</code></pre>"},{"location":"Plugins/IBMSoftLayer/","title":"How To Use the IBMSoftlayer DNS Plugin","text":"<p>This plugin works against the IBM Cloud DNS provider (formerly known as SoftLayer). It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/IBMSoftLayer/#setup","title":"Setup","text":"<p>If you don't already have an API Key setup, login to your account and go to the Users page. There should be a <code>Generate</code> link in the \"API KEY\" column. When you click it, you will briefly see a dialog that shows your new API username and key. If you miss it, there should now be a <code>View</code> link where the Generate link was before. Click that and make a note of your API username and key values.</p>"},{"location":"Plugins/IBMSoftLayer/#using-the-plugin","title":"Using the Plugin","text":"<p>The API username and key are used with the <code>IBMCredential</code> parameter as a PSCredential object where the key is the password.</p> <p>Warning</p> <p>The <code>IBMUser</code> and <code>IBMKey</code> parameters are deprecated and will be removed in the next major module version. If you are using them, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    IBMCredential = (Get-Credential)\n}\nNew-PACertificate example.com -Plugin IBMSoftLayer -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/INWX/","title":"How To Use the INWX DNS Plugin","text":"<p>This plugin works against the INWX DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/INWX/#setup","title":"Setup","text":"<p>There is no special setup required, as INWX uses a username and password for API authentication. However, it is recommended to set up a dedicated API sub-user for automation purposes, with only the \"DNS Management\" role assigned. This way, if your API credentials are compromised, only your DNS settings are at risk\u2014your domain ownership and other user accounts will remain secure.</p>"},{"location":"Plugins/INWX/#using-the-plugin","title":"Using the Plugin","text":"<p>You will need to provide the username as String to <code>INWXUsername</code> and the password associated with the username as a SecureString value to <code>INWXPassword</code>.</p> <pre><code>$pArgs = @{\n    INWXUsername = (Read-Host \"INWX API username\")\n    INWXPassword = (Read-Host \"INWX API password\" -AsSecureString)\n}\nNew-PACertificate \"example.com\" -Plugin \"INWX\" -PluginArgs $pArgs\n</code></pre> <p>For a more automated approach (assuming you understand the risks and methods to secure the below credentials):</p> <pre><code>$pArgs = @{\n    INWXUsername = \"username\"\n    INWXPassword = ConvertTo-SecureString -String \"password belonging to username\" -AsPlainText -Force\n}\nNew-PACertificate \"example.com\" -Plugin \"INWX\" -PluginArgs $pArgs\n</code></pre> <p>This plugin also supports mobile TAN-enabled accounts. If your account is secured by mobile TAN (\"2FA\", \"two-factor authentication\"), you must define the shared secret (usually presented below the QR code during mobile TAN setup) as a SecureString to <code>INWXSharedSecret</code>. This allows the plugin to generate OTP codes. The shared secret is NOT not the 6-digit code you need to enter when logging in. If you are not using 2FA, leave this parameter undefined or set it to <code>$null</code>:</p> <pre><code>$pArgs = @{\n    INWXUsername = \"username\"\n    INWXPassword = ConvertTo-SecureString -String \"password belonging to username\" -AsPlainText -Force\n    INWXSharedSecret = ConvertTo-SecureString -String \"2FA_SHARED_SECRET_32CHARS\" -AsPlainText -Force\n}\nNew-PACertificate \"example.com\" -Plugin \"INWX\" -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/IONOS/","title":"How To Use the IONOS DNS Plugin","text":"<p>This plugin works against the IONOS.de/IONOS.com DNS provider. It is assumed that you have already setup an account and one or more domains you will be working against.</p>"},{"location":"Plugins/IONOS/#setup","title":"Setup","text":"<p>You will need to generate an API Token if you haven't already done so. Follow the guide provided by IONOS here (DE) or here (EN).</p>"},{"location":"Plugins/IONOS/#using-the-plugin","title":"Using the Plugin","text":"<p>You will need to provide the API Public Prefix to <code>IONOSKeyPrefix</code> and the API Secret to <code>IONOSKeySecret</code>.</p> <pre><code>$pArgs = @{\n    IONOSKeyPrefix = (Read-Host 'API Public Prefix')\n    IONOSKeySecret = (Read-Host 'API Secret' -AsSecureString)\n}\n\nNew-PACertificate example.com -Plugin IONOS -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/ISPConfig/","title":"How To Use the ISPConfig DNS Plugin","text":"<p>This plugin works against the ISPConfig hosting control panel. It is assumed that you have an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/ISPConfig/#setup","title":"Setup","text":"<p>As an admin account, go to <code>System - Remote Users</code> and create a new remote user with the following permissions:</p> <ul> <li>Remote Access</li> <li>(Optional) Remote Access IPs</li> <li>Client functions</li> <li>DNZ zone functions</li> <li>DNS txt functions</li> </ul> <p>In addition to the credentials for the remote user, you will need to know the URL for the JSON REST endpoint. You should be able to derive it by using the URL of the control panel home page. Just replace <code>index.php</code> with <code>remote/json/php</code>. For example:</p> <ul> <li>Homepage: https://ispc.example.com:8080/index.php</li> <li>JSON Endpoint: https://ispc.example.com:8080/remote/json.php</li> </ul>"},{"location":"Plugins/ISPConfig/#using-the-plugin","title":"Using the Plugin","text":"<p>The remote access username and password are used the the <code>ISPConfigCredential</code> parameter as a PSCredential object. The JSON endpoint is used with the <code>ISPConfigEndpoint</code> parameter. If your control panel is currently using a self-signed certificate, you may also need to use <code>ISPConfigIgnoreCert=$true</code>.</p> <pre><code>$pArgs = @{\n    ISPConfigCredential = (Get-Credential)\n    ISPConfigEndpoint = 'https://ispc.example.com:8080/remote/json.php'\n    ISPConfigIgnoreCert = $true\n}\nNew-PACertificate example.com -Plugin ISPConfig -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Infoblox/","title":"How To Use the Infoblox DNS Plugin","text":"<p>This plugin works against Infoblox DDI. It is assumed that you have a set of credentials and permissions to modify TXT records for the zone(s) you will be working against.</p>"},{"location":"Plugins/Infoblox/#setup","title":"Setup","text":"<p>The Infoblox WAPI (REST API) takes a standard username/password combo for authentication. There is no setup aside from knowing those credentials and making sure you have enough permissions. If your organization is using split-brain DNS using DNS Views, you should also know which DNS View to write against that is internet-facing. The DNS View name is case-sensitive.</p>"},{"location":"Plugins/Infoblox/#using-the-plugin","title":"Using the Plugin","text":"<p>Your username and password are used with the <code>IBCred</code> parameter as a PSCredential object. You need to set the <code>IBServer</code> parameter which is usually the grid master. By default, the DNS View is set to <code>default</code>. You can use the <code>IBView</code> parameter to specify a different one. If your grid still uses the default self-signed certificate, you'll also want to set <code>IBIgnoreCert=$true</code>.</p> <p>Warning</p> <p>The <code>IBUsername</code> and <code>IBPassword</code> parameters are deprecated and will be removed in the next major module version. If you are using them, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    IBServer = 'gridmaster.example.com'\n    IBView = 'External'\n    IBCred = (Get-Credential)\n    IBIgnoreCert = $true\n}\nNew-PACertificate example.com -Plugin Infoblox -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Infomaniak/","title":"How To Use the Infomaniak DNS Plugin","text":"<p>This plugin works against the Infomaniak DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/Infomaniak/#setup","title":"Setup","text":"<p>You will need to generate an API Token if you haven't already done so. Go to Manage API tokens after logging in to the Management Console. Create a new token with the scope <code>Domain</code>. Set the expiration time to your preference. Make a note of the token value as you'll need it later and won't be able to retrieve it after this point.</p> <p>Note</p> <p>If the token gets invalidated before a renewal is submitted, a new token has to be created and the order has to be updated.</p>"},{"location":"Plugins/Infomaniak/#using-the-plugin","title":"Using the Plugin","text":"<p>You will need to provide the API Token as a SecureString value to <code>InfomaniakToken</code>.</p> <p>Warning</p> <p>The <code>InfomaniakTokenInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    InfomaniakToken = (Read-Host \"Infomaniak Token\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Infomaniak -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/LeaseWeb/","title":"How To Use the LeaseWeb DNS Plugin","text":"<p>This plugin works against the LeaseWeb DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/LeaseWeb/#setup","title":"Setup","text":"<p>Create your API key from the Customer Portal and make a note of it for later.</p>"},{"location":"Plugins/LeaseWeb/#using-the-plugin","title":"Using the Plugin","text":"<p>The API key is used with the <code>LSWApiKey</code> SecureString parameter.</p> <pre><code>$pArgs = @{\n    LSWApiKey = (Read-Host -Prompt 'API Key' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin LeaseWeb -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Linode/","title":"How To Use the Linode DNS Plugin","text":"<p>This plugin works against the Linode DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p> <p>Note</p> <p>The link above is an affiliate link which reduces my out of pocket cost to maintain this plugin. I'd be most grateful if you use it when signing up for a new account.</p>"},{"location":"Plugins/Linode/#setup","title":"Setup","text":"<p>This plugin works against v4 of the Linode API which is not compatible with \"legacy\" pre-paid accounts. In order to use it and generate the appropriate API Token, your account must be a newer style \"hourly billed\" account which it should automatically be if you created it after late 2014.</p> <p>Login to your account and go to the API Tokens section of your profile. Generate a Personal Access Token and give it Read/Write access to Domains. Record the value to use later. You can't retrieve it if you forget it. You can only delete and re-create.</p>"},{"location":"Plugins/Linode/#using-the-plugin","title":"Using the Plugin","text":"<p>The token you created is used with the <code>LIToken</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>LITokenInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <p>Linode also has an unusually long delay between when a record is set and when it propagates to their public name servers. There's a note at the bottom of the DNS Manager web GUI that reads, \"Changes made to a master zone will take effect in our nameservers every quarter hour.\" So you need to set <code>DnsSleep</code> parameter in <code>New-PACertificate</code> to at least 15 minutes. But in testing, 17 minutes (1020 seconds) seemed to be the minimum to reliably satisfy the challenges.</p> <pre><code>$pArgs = @{\n    LIToken = (Read-Host -Prompt 'Token' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Linode -PluginArgs $pArgs -DnsSleep 1020\n</code></pre>"},{"location":"Plugins/Loopia/","title":"How to use the Loopia Plugin","text":"<p>This plugin works against the Loopia DNS provider. It presumes that you have already set up an account and registered or transferred the domain(s) you are targeting. You will also need to be subscribed to their Advanced DNS product.</p>"},{"location":"Plugins/Loopia/#setup","title":"Setup","text":"<p>From the customer zone, click <code>API user</code> and then <code>Create API User</code>. Configure an appropriate Username and Password and select <code>Advanced privileges</code>. When complete, open the details for the user you created and select the following privileges:</p> <ul> <li>addSubdomain</li> <li>addZoneRecord</li> <li>getDomains</li> <li>getSubdomains</li> <li>getZoneRecords</li> <li>removeSubdomain</li> <li>removeZoneRecord</li> </ul> <p>Keep in mind, the username you selected will end with <code>@loopiaapi</code> and you will need to include the full <code>username@loopiaapi</code> value in the plugin parameters later.</p>"},{"location":"Plugins/Loopia/#using-the-plugin","title":"Using the Plugin","text":"<p>The username is used with the <code>LoopiaUser</code> parameter and the password is used with the <code>LoopiaPass</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>LoopiaPassInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    LoopiaUser = 'username@loopiaapi'\n    LoopiaPass = (Read-Host 'Password' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Loopia -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/LuaDns/","title":"How To Use the LuaDns DNS Plugin","text":"<p>This plugin works against the LuaDns DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/LuaDns/#setup","title":"Setup","text":"<p>First, go to the Account Settings page and make sure the <code>Enable API Access</code> box is checked. Then click <code>Show Token</code> to see the API token for your account. You'll also need the email address associated with the account.</p>"},{"location":"Plugins/LuaDns/#using-the-plugin","title":"Using the Plugin","text":"<p>The account email address and API token should be used to create a PSCredential object that you'll pass to the <code>LuaCredential</code> parameter.</p> <p>Warning</p> <p>The <code>LuaUsername</code> and <code>LuaPassword</code> parameters are deprecated and will be removed in the next major module version. If you are using them, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    LuaCredential = (Get-Credential)\n}\nNew-PACertificate example.com -Plugin LuaDns -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/NS1/","title":"How To Use the NS1 DNS Plugin","text":"<p>This plugin works against the NS1 DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/NS1/#setup","title":"Setup","text":"<p>First, go to the API Keys page and click <code>Add Key</code>. Give it an app name like <code>Posh-ACME</code> and uncheck all of the permissions except the ones in the DNS section. You can also optionally add IP whitelist entries to further protect the use of the key. When finished, click <code>Create Key</code> and then unhide and record the key value for later.</p>"},{"location":"Plugins/NS1/#using-the-plugin","title":"Using the Plugin","text":"<p>The API key will be used with the <code>NS1Key</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>NS1KeyInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    NS1Key = (Read-Host -Prompt \"API Key\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin NS1 -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/NameCom/","title":"How To Use the NameCom DNS Plugin","text":"<p>This plugin works against the name.com domain registrar and DNS provider. It is assumed that you have already setup an account and purchased domain you will be working against. You must also be using name.com's own DNS hosting.</p>"},{"location":"Plugins/NameCom/#setup","title":"Setup","text":"<p>First, go to the Account API Settings page and create a new API token for your account. Make a note of both the token value and the username associated with the token. If the username is blank immediately following the token creation, try refreshing the page.</p> <p>Warning</p> <p>If you have two-step verification enabled on your account, there is an additional step to allow the API token to be used. Go to the Security Settings page and scroll to the bottom. There is a section called <code>Name.com API Access</code> with a slider that need to be set to the \"on\" position which is to the right. It should be green when set properly. Without it, the API will generate errors about two-step verification not being supported by the API.</p>"},{"location":"Plugins/NameCom/#using-the-plugin","title":"Using the Plugin","text":"<p>The username is used with the <code>NameComUsername</code> parameter and the token is used with the <code>NameComTokenSecure</code> SecureString parameter. If you are using name.com's API testing environment, you'll also need to include <code>NameComUseTestEnv=$true</code> in your plugin arguments.</p> <p>Warning</p> <p>The <code>NameComeToken</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pargs = @{\n    NameComUsername = 'username'\n    NameComTokenSecure = (Read-Host 'Token' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin NameCom -PluginArgs $pargs\n</code></pre>"},{"location":"Plugins/NameSilo/","title":"How To Use the NameSilo DNS Plugin","text":"<p>This plugin works against the NameSilo domain registrar. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/NameSilo/#setup","title":"Setup","text":"<p>For authentication against the NameSilo API, an API key is required. Open the api manager page to generate the key. Read the note and understand that you can only retrieve the generated key once. If you have previously generated a key, use that one, otherwise by generating a new key you will invalidate the old key. Accept the API terms of use and click generate. Save the generated key in a secure location.</p>"},{"location":"Plugins/NameSilo/#using-the-plugin","title":"Using the Plugin","text":"<p>The API key is used with the <code>NameSiloKey</code> SecureString parameter. NameSilo only updates DNS records every 15 minutes. So you should also provide a <code>-DnsSleep</code> parameter of 900 or more.</p> <p>Warning</p> <p>The <code>NameSiloKeyInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    NameSiloKey = (Read-Host \"NameSilo Key\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin NameSilo -PluginArgs $pArgs -DnsSleep 900\n</code></pre>"},{"location":"Plugins/Namecheap/","title":"How To Use the Namecheap DNS Plugin","text":"<p>This plugin works against the Namecheap FreeDNS provider. It is assumed that you have already setup an account and registered the domains you will be working against. The domains must not be using custom DNS servers.</p>"},{"location":"Plugins/Namecheap/#setup","title":"Setup","text":"<p>First, login to your account and go to the Profile - Tools page. In the \"Business &amp; Dev Tools\" section, API Access must be turned on. Namecheap seems to require a certain amount of activity (registered domains or money spent) in order to enable API Access. Turning it on requires Namecheap support to authorize and actually enable which can take a couple days.</p> <p>Once API Access is turned on, click the Manage button and record your <code>API Key</code> value and your Namecheap username. You will also need to whitelist the public IP address of each machine you will be running Posh-ACME from. whatsmyip.com can help here if you're behind a NAT router.</p>"},{"location":"Plugins/Namecheap/#using-the-plugin","title":"Using the Plugin","text":"<p>The username is used with the <code>NCUsername</code> parameter and the API key is used with the <code>NCApiKey</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>NCApiKeyInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    NCUsername = 'myusername'\n    NCApiKey = (Read-Host 'API Key' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Namecheap -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/OVH/","title":"How To Use the OVH DNS Plugin","text":"<p>This plugin works against the OVH DNS provider. It is assumed that you have already setup an account and created the domain(s) you will be working against.</p>"},{"location":"Plugins/OVH/#setup","title":"Setup","text":"<p>OVH has a variety of supported regions each with their own API endpoint and sets of credentials. In order to set things up properly, you must know which region your account is in. The table below lists the available regions, the region code, and a link to create an Application Credential.</p> Region Code API App Creation OVH Europe ovh-eu Create App OVH US ovh-us Create App OVH North-America ovh-ca Create App So you Start Europe soyoustart-eu Create App So you Start North America soyoustart-ca Create App Kimsufi Europe kimsufi-eu Create App Kimsufi North America kimsufi-ca Create App RunAbove runabove-ca Create App"},{"location":"Plugins/OVH/#create-application-credentials","title":"Create Application Credentials","text":"<p>Select the region that matches your account and use the appropriate \"Create App\" link to create an application credential for your account. Set the App Name and Description to whatever you want and click <code>Create Keys</code>. You will be presented with an <code>Application Key</code> and <code>Application Secret</code> which you should save for later.</p>"},{"location":"Plugins/OVH/#generate-consumer-key","title":"Generate Consumer Key","text":"<p>Now we need to generate a Consumer Key for these App credentials that is associated with a set of permissions on your account. There are generally three different ways to configure permissions for the Consumer Key. </p> <ul> <li>Write access to all DNS zones on your account. This is useful if you want a single instance of Posh-ACME to be able to generate certs for any name in any domain you might host on OVH.</li> <li>Write access to only a specific set of DNS zones on your account. This lets you keep some zones inaccessible, but still lets you generate certs for any name within allowed set of domains.</li> <li>Write access only to specific pre-created TXT records. This is the most complicated to setup, but also provides the least risk in case the key is compromised.</li> </ul> <p>There is a helper function built-into the plugin file that can make setting up these permissions easier. In order to use it, run the following to add the function to your current PowerShell session. Then follow the instructions in the next section for the option you will be using.</p> <pre><code>Import-Module Posh-ACME\n. (Join-Path (Get-Module Posh-ACME).ModuleBase \"Plugins\\OVH.ps1\")\n</code></pre>"},{"location":"Plugins/OVH/#write-to-all-zones","title":"Write to All Zones","text":"<p>Using the appropriate region code from the table above and the Application Key you previously created, run the following PowerShell and follow the instructions it gives. It will generate a URL you must open in a browser, verify the requested permissions, set the Validity to \"Unlimited\", and click <code>Log In</code>.</p> <pre><code>Invoke-OVHSetup -AppKey 'xxxxxxxxxxxx' -OVHRegion 'ovh-eu'\n</code></pre>"},{"location":"Plugins/OVH/#write-to-specific-zones","title":"Write to Specific Zones","text":"<p>Define the set of zones you wish to grant access to.</p> <pre><code>$zones = 'example.com','example.net','example.org'\n</code></pre> <p>Using the appropriate region code from the table above and the Application Key you previously created, run the following PowerShell and follow the instructions it gives. It will generate a URL you must open in a browser, verify the requested permissions, set the Validity to \"Unlimited\", and click <code>Log In</code>.</p> <pre><code>Invoke-OVHSetup -AppKey 'xxxxxxxxxxxx' -OVHRegion 'ovh-eu' -Zone $zones\n</code></pre>"},{"location":"Plugins/OVH/#write-to-specific-records","title":"Write to Specific Records","text":"<p>In order to use this method, you have to pre-create every TXT record the ACME server is going to need in order to validate the names in the certs you will be requesting. For non-wildcard names, prepend <code>_acme-challenge.</code> to the name. For wildcard names, replace the <code>*</code> with <code>_acme-challenge</code>.</p> <p>For a cert that contains <code>example.com</code>, <code>www.example.com</code>, and <code>support.example.com</code>, you would need to create the following three records.</p> <ul> <li>Sub-domain: <code>_acme-challenge</code> .example.com</li> <li>Sub-domain: <code>_acme-challenge.www</code> .example.com</li> <li>Sub-domain: <code>_acme-challenge.support</code> .example.com</li> </ul> <p>For a typical wildcard cert that contains <code>example.com</code> and <code>*.example.com</code>, you would need to create two copies of the same record.</p> <ul> <li>Sub-domain: <code>_acme-challenge</code> .example.com</li> <li>Sub-domain: <code>_acme-challenge</code> .example.com</li> </ul> <p>Once your records are created, you need to identify the record ID for each one. Unfortunately, we haven't found an easy way to find these from OVH's web based DNS editor. The closest alternative is the API Console. Login and expand the <code>GET /domain/zone/{zoneName}/record</code> entry. Add the appropriate record details to lookup and press <code>Execute</code>. The result should be one or more record ID numbers.</p> <p>Using the record ID(s) and associated zone name(s), create an array of permission objects. It should contain a <code>GET /domain/zone/&lt;zone name&gt;/record*</code> and <code>POST /domain/zone/&lt;zone name&gt;/refresh</code> entry for each domain plus a <code>PUT /domain/zone/&lt;zone name&gt;/record/&lt;id&gt;</code> entry for each record. So the typical wildcard cert example might look like this:</p> <pre><code>$rules = @(\n    @{ method = 'GET';  path = '/domain/zone/example.com/record*' }\n    @{ method = 'POST'; path = '/domain/zone/example.com/refresh' }\n    @{ method = 'PUT';  path = '/domain/zone/example.com/record/1111111111' }\n    @{ method = 'PUT';  path = '/domain/zone/example.com/record/2222222222' }\n)\n</code></pre> <p>Using the appropriate region code from the table above and the Application Key you previously created, run the following PowerShell and follow the instructions it gives. It will generate a URL you must open in a browser, verify the requested permissions, set the Validity to \"Unlimited\", and click <code>Log In</code>.</p> <pre><code>Invoke-OVHSetup -AppKey 'xxxxxxxxxxxx' -OVHRegion 'ovh-eu' -AccessRules $rules\n</code></pre>"},{"location":"Plugins/OVH/#save-the-resulting-consumer-key","title":"Save the Resulting Consumer Key","text":"<p>After logging in successfully, you should be redirected to a success page on the Posh-ACME wiki. Press Enter in the PowerShell Window to be presented with your Consumer Key value which you should save for later.</p>"},{"location":"Plugins/OVH/#using-the-plugin","title":"Using the Plugin","text":"<p>The App Key value will be used with the <code>OVHAppKey</code> parameter. The App Secret and Consumer Key values will be used with the <code>OVHAppSecret</code> and <code>OVHConsumerKey</code> SecureString parameters.</p> <p>Warning</p> <p>The OVH API is very sensitive to the Date/Time configuration on your system. Make sure your computer is synchronized with a reliable time source. A few seconds of time skew can cause HTTP 400 errors with the error code <code>QUERY_TIME_OUT</code>.</p> <p>Warning</p> <p>The <code>OVHAppSecretInsecure</code> and <code>OVHConsumerKeyInsecure</code> parameters are deprecated and will be removed in the next major module version. If you are using them, please migrate to the Secure parameter set.</p> <p>Warning</p> <p>If the permissions on your consumer key only allow write access to specific records, you must add <code>OVHUseModify = $true</code> to your plugin arguments. This instructs the plugin to modify existing records instead of trying to create new ones from scratch which will fail.</p> <pre><code>$pArgs = @{\n    OVHAppKey = 'xxxxxxxxxxx'\n    OVHAppSecret = (Read-Host -Prompt \"App Secret\" -AsSecureString)\n    OVHConsumerKey = (Read-Host -Prompt \"Consumer Key\" -AsSecureString)\n    OVHRegion = 'ovh-eu'\n}\nNew-PACertificate example.com -Plugin OVH -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/OnlineNet/","title":"How To Use the OnlineNet DNS Plugin","text":"<p>This plugin works against the Online.net DNS provider which is now known as Scaleway. However, this plugin only works against the legacy online.net v1 API. It is assumed that you have already setup an account and purchased the domain you will be working with that can be managed from the legacy console.online.net dashboard.</p>"},{"location":"Plugins/OnlineNet/#setup","title":"Setup","text":"<p>Login to API Access and record your \"private access token\". You can also generate a new one at will and record that instead. But only the last generated token will work.</p>"},{"location":"Plugins/OnlineNet/#using-the-plugin","title":"Using the Plugin","text":"<p>Use your token value with the <code>ONToken</code> SecureString parameter.</p> <pre><code>$pArgs = @{\n    ONToken = (Read-Host \"Online.net Token\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin OnlineNet -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Plugin-Development-Guide/","title":"Plugin Development Guide","text":""},{"location":"Plugins/Plugin-Development-Guide/#introduction","title":"Introduction","text":"<p>A validation plugin for Posh-ACME is a standard PowerShell PS1 script file located in the module's <code>Plugins</code> folder. It can also be in a folder outside the module and referenced using the <code>POSHACME_PLUGINS</code> environment variable. The file name is what users will use to reference it when specifying a plugin, so it should be related to the provider it is publishing against.</p> <p>All plugins must contain a function called <code>Get-CurrentPluginType</code> which returns a string indicating the type of ACME challenge they support. Posh-ACME currently supports the <code>dns-01</code> and <code>http-01</code> challenge types.</p> <p>DNS plugins must contain the following additional functions:</p> <ul> <li><code>Add-DnsTxt</code></li> <li><code>Remove-DnsTxt</code></li> <li><code>Save-DnsTxt</code></li> </ul> <p>HTTP plugins must contain the following additional functions:</p> <ul> <li><code>Add-HttpChallenge</code></li> <li><code>Remove-HttpChallenge</code></li> <li><code>Save-HttpChallenge</code></li> </ul> <p>The easiest way to get started is to make a copy of <code>_Example-DNS.ps1</code> or <code>_Example-HTTP.ps1</code> depending on the type of plugin you are making and rename it for your purposes.</p> <p>Pull Requests for new plugins are quite welcome.</p>"},{"location":"Plugins/Plugin-Development-Guide/#function-details","title":"Function Details","text":""},{"location":"Plugins/Plugin-Development-Guide/#add-dnstxt-and-remove-dnstxt","title":"<code>Add-DnsTxt</code> and <code>Remove-DnsTxt</code>","text":"<p>These are responsible for adding/removing TXT records to/from a DNS server/provider. There are two mandatory and positional string parameters, <code>$RecordName</code> and <code>$TxtValue</code>. RecordName is the fully qualified domain name (FQDN) of the record we will be adding a TXT value for. TxtValue is the actual value that will be set in the TXT record. Do not modify or remove these first two parameters.</p> <p>Additional parameters should be added as necessary for the specific DNS provider such as credentials or API keys. In addition to standard PowerShell naming standards, their names must also not conflict with any other plugin's parameters. A good way to do that is to use a unique prefix on all of the parameters. It doesn't have to match the plugin name exactly as long as it's unique and reasonably related to the plugin. Common parameters that can be shared between this plugin's functions should be named the same as each other.</p> <p>The last parameter should always be <code>$ExtraParams</code> with the <code>ValueFromRemainingArguments</code> parameter attribute. This allows callers to splat the combined collection of plugin parameters to each plugin without errors for parameters that don't exist.</p> <p>Many DNS providers will only need the Add and Remove functions. In those cases, remember to remove all but the <code>$ExtraParams</code> parameter in the Save function and just leave the function body empty. For other providers, it is may be more efficient to stage changes in bulk and then perform what is effectively a Save or Commit operation on those changes. In those cases, implement the Save function as described below.</p>"},{"location":"Plugins/Plugin-Development-Guide/#add-httpchallenge-and-remove-httpchallenge","title":"<code>Add-HttpChallenge</code> and <code>Remove-HttpChallenge</code>","text":"<p>These are responsible for publishing/unpublishing the ACME challenge body text at a specific HTTP URL. There are three mandatory and positional string parameters, <code>$Domain</code>, <code>$Token</code>, and <code>$Body</code>. Domain and Token are what the validation server will use to build the URL it will check against (<code>http://&lt;Domain&gt;/.well-known/acme-challenge/&lt;Token&gt;</code>). Body is the text value it expects to get in response to that query. Do not modify or remove these first three parameters.</p> <p>Additional parameters should be added as necessary for the specific HTTP provider such as filesystem paths, credentials, or API keys. In addition to standard PowerShell naming standards, their names must also not conflict with any other plugin's parameters. A good way to do that is to use a unique prefix on all of the parameters. It doesn't have to match the plugin name exactly as long as it's unique and reasonably related to the plugin. Common parameters that can be shared between this plugin's functions should be named the same as each other.</p> <p>The last parameter should always be <code>$ExtraParams</code> with the <code>ValueFromRemainingArguments</code> parameter attribute. This allows callers to splat the combined collection of plugin parameters to each plugin without errors for parameters that don't exist.</p> <p>Many HTTP providers will only need the Add and Remove functions. In those cases, remember to remove all but the <code>$ExtraParams</code> parameter in the Save function and just leave the function body empty. For other providers, it is may be more efficient to stage changes in bulk and then perform what is effectively a Save or Commit operation on those changes. In those cases, implement the Save function as described below.</p>"},{"location":"Plugins/Plugin-Development-Guide/#save-dnstxt-and-save-httpchallenge","title":"<code>Save-DnsTxt</code> and <code>Save-HttpChallenge</code>","text":"<p>These functions are optional for DNS/HTTP plugins where it is more efficient to stage changes in bulk before Saving or Committing the changes. There are no required parameters except <code>$ExtraParams</code> which should always be last and have the <code>ValueFromRemainingArguments</code> parameter attribute.</p>"},{"location":"Plugins/Plugin-Development-Guide/#parameter-types","title":"Parameter Types","text":"<p>Try to limit parameters to simple data types like <code>[string]</code>, <code>[int]</code>, and <code>[switch]</code>. Arrays and Hashtables are fine as long as the contents are also simple types. Hashtables in particular should not be nested. The parameters should be able to convert nicely back and forth using <code>Convert-ToJson</code> and <code>Convert-FromJson</code>.</p> <p>Secrets such as passwords and API keys/tokens should use <code>[SecureString]</code> or <code>[PSCredential]</code> parameters even if you ultimately need them in plain text within the plugin. This ensures the values are encrypted when saved to disk for later renewals. Here are some examples for how to convert them back to plain text in the plugin code.</p> <pre><code># get the username and password from a PSCredential called $cred\n$username = $cred.Username\n$password = $cred.GetNetworkCredential().Password\n\n# get the plain text from a SecureString called $secString\n$plainText = [pscredential]::new('a',$secString).GetNetworkCredential().Password\n</code></pre>"},{"location":"Plugins/Plugin-Development-Guide/#usage-guides","title":"Usage Guides","text":"<p>In addition to the native function help, it can be very helpful to new users to have a plugin specific readme. It should be a Markdown formatted file in the docs/Plugins folder called <code>&lt;PluginName&gt;.md</code>. It's usually easiest to copy an existing guide and modify it. The <code>title:</code> field at the top of the file should match the name of the plugin including capitalization.</p> <p>Note</p> <p>You may notice there are some Markdown files for other plugins in the main Plugins folder called <code>&lt;PluginName&gt;-Readme.md</code>. These exist for legacy reasons before the docs website was around and are not necessary for new plugins.</p> <p>For people who may be setting up automation against their provider for the first time, it can be helpful to add guidance on creating service accounts, limited access roles, or any prerequisite setup that the plugin requires to work properly. It should also have a section with an example on how to use the plugin with <code>New-PACertificate</code>.</p>"},{"location":"Plugins/Plugin-Development-Guide/#general-development-tips-and-tricks","title":"General Development Tips and Tricks","text":""},{"location":"Plugins/Plugin-Development-Guide/#no-write-host","title":"No Write-Host","text":"<p>Unless your plugin requires interactive user input which should be rare, do not use <code>Write-Host</code> to display informational messages or debug output. Use <code>Write-Verbose</code> for messages you would want a potential user to see. Use <code>Write-Debug</code> for things only the plugin developer would likely care about or a user trying to troubleshoot a plugin that is not working.</p> <p>When testing your module, use <code>-Verbose</code> to see your verbose messages. And run <code>$DebugPreference = 'Continue'</code> to make the debug messages show up without prompting for confirmation (which happens if you use <code>-Debug</code>).</p>"},{"location":"Plugins/Plugin-Development-Guide/#no-pipeline-output","title":"No Pipeline Output","text":"<p>Do not output any objects to the pipeline from your plugin. This will interfere with scripts and workflows that use the normal output of public functions. You can use <code>Out-Null</code> on internal calls that would normally output to the pipeline when you don't care about that data.</p>"},{"location":"Plugins/Plugin-Development-Guide/#usebasicparsing","title":"UseBasicParsing","text":"<p>Any time you call <code>Invoke-WebRequest</code> or <code>Invoke-RestMethod</code>, you should always add <code>@script:UseBasic</code> to the end.</p> <p>By default in PowerShell 5.1, those two functions use Internet Explorer's DOM parser to process the response body which can cause errors in cases where IE is not installed or hasn't gone through its first-run sequence yet. Both functions have a <code>-UseBasicParsing</code> parameter that switches the parser to a PowerShell native parser and is the new default functionality in PowerShell 6+. The parameter is also deprecated because they don't plan on bringing back IE DOM parsing in future PowerShell versions. So the module creates a variable when it is first loaded that checks whether <code>-UseBasicParsing</code> is still available or not and adds it to the <code>$script:UseBasic</code> hashtable. That way, you can just splat it on all your calls to those two functions which will future proof your plugin.</p>"},{"location":"Plugins/Plugin-Development-Guide/#testing-plugins","title":"Testing Plugins","text":"<p>If the module is already loaded in the session, you will need to re-import it using <code>Import-Module -Force</code>. There is a helper script called <code>instdev.ps1</code> in the root of the git repository that can make this process a lot easier as you are developing the plugin.</p> <p>First make sure any existing copies of the module are uninstalled (or at least don't reside in your <code>$env:PSModulePath</code>). Clone the git repository (or your fork) to a folder on your local system and add your plugin file to the <code>Posh-Acme\\Plugins</code> folder if it's not already there. Open a new PowerShell session to the repository root folder and run <code>.\\instdev.ps1</code> which will do the following:</p> <ul> <li>Copy the module files to the current user's default PowerShell modules folder.</li> <li>Run <code>Import-Module Posh-ACME -Force</code></li> <li>Display the available module commands</li> </ul> <p>If there are no problems, your plugin should now be listed in the output of <code>Get-PAPlugin</code>.</p> <p>Testing a plugin can be done without requesting a new certificate. All you need is an existing ACME account created with <code>New-PAAccount</code> and the <code>Publish-Challenge</code>, <code>Unpublish-Challenge</code>, and <code>Save-Challenge</code> functions. They call the Add, Remove, and Save functions from the plugin. Here are some examples of how I generally call them while testing.</p> <pre><code>$DebugPreference = 'Continue'\n$pArgs = @{MyParam1='asdf';MyParam2='qwer'}\n\n# multiple calls to publish/unpublish are generally more useful for DNS plugins\nPublish-Challenge example.com (Get-PAAccount) test1 MyPlugin $pArgs -Verbose\nPublish-Challenge example.com (Get-PAAccount) test2 MyPlugin $pArgs -Verbose\nPublish-Challenge example.com (Get-PAAccount) test3 MyPlugin $pArgs -Verbose\n\n# save is only necessary if your plugin implements it\nSave-Challenge MyPlugin $pArgs -Verbose\n\nUnpublish-Challenge example.com (Get-PAAccount) test1 MyPlugin $pArgs -Verbose\nUnpublish-Challenge example.com (Get-PAAccount) test2 MyPlugin $pArgs -Verbose\nUnpublish-Challenge example.com (Get-PAAccount) test3 MyPlugin $pArgs -Verbose\n\n# save is only necessary if your plugin implements it\nSave-Challenge MyPlugin $pArgs -Verbose\n</code></pre> <p>Alternatively, you can dot source the plugin file and call the functions directly. But this can be difficult if the functions depend on module-scoped variables like <code>$script:UseBasic</code> or internal module functions. Also, remember to dot source again each time you make a change to the plugin.</p>"},{"location":"Plugins/Plugin-Development-Guide/#dns-specific-tips-and-tricks","title":"DNS Specific Tips and Tricks","text":""},{"location":"Plugins/Plugin-Development-Guide/#multiple-txt-values-per-record","title":"Multiple TXT Values Per Record","text":"<p>It is both supported and expected that a given TXT record may have multiple values. It's most common with wildcard certificates that contain both the wildcard name (<code>*.example.com</code>) and the root domain (<code>example.com</code>). Both names require TXT records be added for the same FQDN (<code>_acme-challenge.example.com</code>). This can also happen if the user is using CNAME challenge aliases.</p> <p>The Add/Remove functions need to support all potential states of the particular TXT record. But how the record is represented by a given provider seems to vary. Some represent it as a single record with multiple values that you need to add to or remove from. Others have distinct records for each value that can be created/deleted individually. So make sure you can both create a new record that doesn't exist and add a value to a record that already does.</p>"},{"location":"Plugins/Plugin-Development-Guide/#remove-only-specific-txtvalue","title":"Remove Only Specific TxtValue","text":"<p>Related to having multiple TXT values per record, the remove function must not blindly delete any record that matches <code>$RecordName</code>. It should be able to remove only the <code>$TxtValue</code> on a record that may have multiple values. But if the record only contains a single value, the record should be deleted entirely.</p>"},{"location":"Plugins/Plugin-Development-Guide/#zone-matching","title":"Zone Matching","text":"<p>A particular DNS provider may be hosting both domain apex zones (<code>example.com</code>) and sub-zones (<code>sub1.example.com</code>). One of the first things a plugin usually has to do is figure out which zone <code>$RecordName</code> needs to be added to. This should be the deepest sub-zone that would still contain <code>$RecordName</code>. Here are some examples assuming only the two previously mentioned zones exist.</p> <code>$RecordName</code> Matching Zone _acme-challenge.example.com example.com _acme-challenge.site1.example.com example.com _acme-challenge.sub1.example.com sub1.example.com _acme-challenge.site1.sub1.example.com sub1.example.com _acme-challenge.site1.sub3.sub2.sub1.example.com sub1.example.com <p>Many of the existing plugins have a helper function to handle this. Copy and modify their code where it makes sense but make sure helper function names are unique.</p>"},{"location":"Plugins/Plugin-Development-Guide/#relative-record-names","title":"Relative Record Names","text":"<p>Many providers will end up needing you to provide a record's relative/short name such as <code>_acme-challenge</code> or <code>_acme-challenge.www</code> rather than the fully-qualified domain provided by <code>$RecordName</code>. To do this properly, you must first know the zone name that would contain the record. Once you have it, use the following method to separate the relative name from the zone name.</p> <pre><code># assumes $zoneName contains the zone name containing the record\n$recShort = $RecordName -ireplace \"\\.?$([regex]::Escape($zoneName.TrimEnd('.')))$\",''\n</code></pre> <p>Keep in mind that there are cases where <code>$RecordName</code> and <code>$zoneName</code> can be identical. The code above will set <code>$recShort</code> to an empty string. Depending on the provider, this may not be the proper way to reference zone apex records. Some providers expect you to use <code>@</code>, others may want the full zone name like <code>example.com</code>. So if your provider expects something other than an empty string, make sure you account for it. Here's an example:</p> <pre><code>if ($recShort -eq [string]::Empty) {\n    $recShort = '@'\n}\n</code></pre>"},{"location":"Plugins/Plugin-Development-Guide/#dns-aliases-and-domain-apex","title":"DNS Aliases and Domain Apex","text":"<p>Don't forget to test your functions against the domain apex which can happen when users are using DNS challenge aliases.</p> <pre><code># The my.cname.tld record doesn't actually need to exist for the test to work.\n# The plugin will only be writing to example.com\n$publishParams = @{\n    Domain = 'my.cname.tld'\n    Account = (Get-PAAccount)\n    Token = 'fake-token'\n    Plugin = 'MyPlugin'\n    PluginArgs = $pArgs\n    DnsAlias = 'example.com'\n    Verbose = $true\n}\nPublish-Challenge @publishParams\nUnpublish-Challenge @publishParams\n</code></pre>"},{"location":"Plugins/Plugin-Development-Guide/#deriving-object-ids","title":"Deriving Object IDs","text":"<p>Many providers assign ID values to object types like zones and records that you need to use to manipulate those objects. A user should ideally not have to know or provide any zone, record, or object IDs in order to use the plugin. All of that should be discovered by the plugin code and the only thing the user should need to provide is whatever credentials or tokens the API requires for authentication.</p> <p>In the rare cases that you do need the user to provide something like a zone ID, make sure you allow for multiple values. A single certificate can contain names from many different zones and the plugin parameters that get passed to the plugin are the same for each TXT record that needs to be created.</p>"},{"location":"Plugins/Plugin-Development-Guide/#trailing-dots","title":"Trailing Dots","text":"<p>Be aware how your particular DNS provider represents zone and record names. Some include the trailing dot (<code>example.com.</code>). Others don't. This can affect string matching when finding zones and existing records.</p>"},{"location":"Plugins/Plugin-Development-Guide/#internationalized-domain-name-idn","title":"Internationalized Domain Name (IDN)","text":"<p>Many DNS providers and registrars support IDN domains which contain non-ascii unicode characters (or even emojis). When using IDN domains with ACME, the IDN names must be specified as Punycode. But the DNS providers may still send or receive the unicode version of the name. Particularly if your provider is not US-based, be aware of and try to account for how the provider handles IDN names.</p> <p>The .NET System.Globalization.IdnMapping class can help convert back and for between IDN and punycode names like this:</p> <pre><code># create an instance of the class\n$idn = [System.Globalization.IdnMapping]::new()\n\n# convert an IDN name to punycode\n$idn.GetAscii('b\u00fccher.example')\n\n# convert a punycode name back to IDN\n$idn.GetUnicode('xn--bcher-kva.example')\n</code></pre>"},{"location":"Plugins/Plugin-Development-Guide/#http-specific-tips-and-tricks","title":"HTTP Specific Tips and Tricks","text":""},{"location":"Plugins/Plugin-Development-Guide/#validation-timing","title":"Validation Timing","text":"<p>When DNS plugins are used, there's a user customizable sleep timer between when the TXT records are published and the module asks the ACME server to validate those records because records are not typically available instantaneously worldwide. However, that sleep timer does not exist when an order is only using HTTP plugins because HTTP resources are typically available instantly.</p> <p>If your particular HTTP provider requires a delay between when the challenges are published and when they are validated, you should add that delay in the <code>Save-HttpChallenge</code> function of your plugin.</p>"},{"location":"Plugins/Plugin-Development-Guide/#migrating-dns-plugins-from-3x-to-4x","title":"Migrating DNS Plugins from 3.x to 4.x","text":"<p>In case you have been using your own private DNS plugin in 3.x, here's how to migrate it to the 4.x format.</p> <ul> <li>Add <code>function Get-CurrentPluginType { 'dns-01' }</code> to the top of the file.</li> <li>Replace instances of <code>Add-DnsTxt&lt;Name&gt;</code> with <code>Add-DnsTxt</code></li> <li>Replace instances of <code>Remove-DnsTxt&lt;Name&gt;</code> with <code>Remove-DnsTxt</code></li> <li>Replace instances of <code>Save-DnsTxt&lt;Name&gt;</code> with <code>Save-DnsTxt</code></li> <li>Replace instances of <code>-DnsPlugin</code> with <code>-Plugin</code> in usage guides.</li> </ul>"},{"location":"Plugins/PointDNS/","title":"How to use the PointDNS Plugin","text":"<p>This plugin works against the PointDNS DNS provider. It presumes that you have already set up an account and created the DNS zone(s) that you are targeting.</p>"},{"location":"Plugins/PointDNS/#setup","title":"Setup","text":"<p>Login to your account. Go to <code>Account</code> and copy your API key. Click the key icon if you need to generate a new key.</p>"},{"location":"Plugins/PointDNS/#using-the-plugin","title":"Using the Plugin","text":"<p>The <code>PDUser</code> parameter should be set to the email address associatedw ith your account. The API key is used with the <code>PDKey</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>PDKeyInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    PDUser = 'email@example.com'\n    PDKey = (Read-Host 'API Key' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin PointDNS -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Porkbun/","title":"How To Use the Porkbun DNS Plugin","text":"<p>This plugin works with the Porkbun DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be using.</p>"},{"location":"Plugins/Porkbun/#setup","title":"Setup","text":"<p>You will need to generate an API key/secret pair if you haven't already done so. Go to API Access after logging in. Give the key a name and click <code>Create API Key</code>. Copy both the key and secret (the name you entered is not needed). Note that you won't be able to retrieve the secret in the future.</p> <p>For each domain that you'd like to manage with the API, you must ensure that <code>API Access</code> is enabled under the Domain Settings (in the Details dropdown)</p>"},{"location":"Plugins/Porkbun/#using-the-plugin","title":"Using the Plugin","text":"<p>You will need to provide the API Key and Secret as <code>SecureString</code>s to <code>PorkbunAPIKey</code> and <code>PorkbunSecret</code> respectively. An example is shown below:</p> <pre><code>$PorkbunArgs = @{\n    PorkbunAPIKey = (Read-Host 'Porkbun API Key' -AsSecureString);\n    PorkbunSecret = (Read-Host 'Porkbun API Secret' -AsSecureString);\n}\nNew-PACertificate example.com -Plugin Porkbun -PluginArgs $PorkbunArgs\n</code></pre>"},{"location":"Plugins/PortsManagement/","title":"How To Use the Ports Management DNS Plugin","text":"<p>This plugin works against the Ports Management provider. It is assumed that you already have an account and at least one DNS zone you will be working against.</p>"},{"location":"Plugins/PortsManagement/#setup","title":"Setup","text":"<p>Acquiring a API key for the production API is initiated through your Ports Group representative. As specified in Ports own API docs: \"To get access to the production environment contact your Ports Group representative.</p> <p>You will receive instructions on how to retrieve your API key from the Ports Management web user interface in a secure way. Note that you will be able to see the API key only once.</p> <p>You will also be able to configure the privileges of the API access key. That is read-only or read-write access, what part of the organization or what zones the API access key can work with and so forth. It is also possible to get more than one API key with different privileges if required.</p> <p>In addition, you will need to supply your IP addresses/ranges to be accept listed by Ports Group firewalls. Only accept listed IPs can access the Ports Management API servers.\"</p> <p>If you have been given access to the demo environment, you should be able to find a demo API key in the Ports Management Demo API guide. The demo environment is only suitable for testing, as you will not be able to validate any certificates using it.</p>"},{"location":"Plugins/PortsManagement/#using-the-plugin","title":"Using the Plugin","text":"<p>With your API key, pass it to the plugin using the <code>PortsApiKey</code> parameter as a SecureString.</p> <pre><code>$pArgs = @{\n    PortsApiKey = (Read-Host -Prompt 'Ports API key' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin PortsManagement -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/PortsManagement/#testing-the-ports-managment-demo-environment","title":"Testing the Ports Managment demo environment","text":"<p>For testing against the Demo environment, set the parameter <code>PortsEnvironment</code> to 'Demo' <pre><code>Set-PAServer -Name LE_STAGE\nNew-PAAccount -Contact 'yourname@example.com' -AcceptTOS\n$pluginArgs = @{\n    PortsApiKey = (Read-Host 'Ports API key' -AsSecureString)\n    PortsEnvironment = 'Demo'\n}\n\n$challengeArgs = @{\n    Domain = 'example.com'\n    Account = (Get-PAAccount)\n    Token = 'test1'\n    Plugin = 'PortsManagement'\n    PluginArgs = $pluginArgs\n}\n\nPublish-Challenge @challengeArgs\n# You can now verify in the Ports Management portal that a record for _acme-challenge has been added to your zone, or use the Get-PortsDnsRecord helper function.\n\n# Clean up\nUnpublish-Challenge @challengeArgs\n</code></pre></p>"},{"location":"Plugins/PowerDNS/","title":"How To Use the PowerDNS Plugin","text":"<p>This plugin works against the PowerDNS Authoritative Server. It is assumed that the server is already running with the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/PowerDNS/#setup","title":"Setup","text":"<p>You'll need to enable the API if it hasn't been already. You'll also need the value of the <code>api-key</code> setting from the config file.</p> <p>While PowerDNS doesn't directly support using HTTPS against the API, it's possible to do so by running a reverse proxy in front of it which has the certificate and terminates the TLS connections. Make sure you know the hostname or IP and port number of your server as well as whether you need to use HTTP or HTTPS with the API.</p>"},{"location":"Plugins/PowerDNS/#using-the-plugin","title":"Using the Plugin","text":"<p>The minimum parameters you need to provide to the plugin are the hostname or IP address using <code>PowerDNSApiHost</code> and the API Key as a SecureString parameter using <code>PowerDNSApiKey</code>. This will use an API Url assuming default values for server name (<code>localhost</code>), port (<code>8081</code>), and use HTTP rather than HTTPS.</p> <pre><code>$pArgs = @{\n    PowerDNSApiHost = 'pdns.example.com'\n    PowerDNSApiKey = (Read-Host \"API Key\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin PowerDNS -PluginArgs $pArgs\n</code></pre> <p>When using an HTTPS reverse proxy in front of the server, you would add <code>PowerDNSUseTLS</code>, <code>PowerDNSPort</code>, and possibly <code>PowerDNSServerName</code> parameters like this:</p> <pre><code>$pArgs = @{\n    PowerDNSApiHost = 'pdns.example.com'\n    PowerDNSApiKey = (Read-Host \"API Key\" -AsSecureString)\n    PowerDNSUseTLS = $true\n    PowerDNSPort = 443\n    PowerDNSServerName = 'localhost'\n}\nNew-PACertificate example.com -Plugin PowerDNS -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/RFC2136/","title":"How to use the RFC2136 Plugin","text":"<p>This plugin works against any DNS provider that supports dynamic updates using the protocol specified in RFC 2136. Both unauthenticated and TSIG authenticated updates are supported.</p>"},{"location":"Plugins/RFC2136/#setup","title":"Setup","text":"<p>It is beyond the scope of this guide to explain how to configure your DNS server to accept dynamic updates or generate a TSIG key to use for authentication. But if you're using BIND, the Dynamic Update Policies section of the official docs is a good place to start. There are also a variety of tutorials available with a quick web search.</p> <p>The plugin does not currently support Kerberos (GSS-TSIG) based updates. You must either use unauthenticated updates with an IP allow list or TSIG authenticated updates using a key type supported by your DNS server and the <code>nsupdate</code> utility. As of this writing, the current stable version of BIND is 9.16.20 and supports key types using the following algorithms:</p> <ul> <li><code>hmac-md5</code></li> <li><code>hmac-sha1</code></li> <li><code>hmac-sha224</code></li> <li><code>hmac-sha256</code></li> <li><code>hmac-sha384</code></li> <li><code>hmac-sha512</code></li> </ul> <p>When using a TSIG key, you will typically have 3 values; a key name, a key type from the list above, and a Base64 encoded key value. You will need to supply all three as plugin parameters.</p>"},{"location":"Plugins/RFC2136/#plugin-dependencies","title":"Plugin Dependencies","text":"<p>Due to the inexplicable lack of good native DNS libraries within PowerShell/.NET, this plugin relies on the <code>nsupdate</code> utility which is part of the ISC BIND distribution. Most modern Linux distributions will have this installed by default, but double check to be sure. On Windows, you will need to download and install the utility. However, ISC has discontinued support for BIND (and its utilities) Windows since version 9.18. The last official build was 9.17.15 and is still available from their website here, https://downloads.isc.org/isc/bind9/9.17.15/BIND9.17.15.x64.zip. It may also be possible to use the Linux version from Windows via WSL (Windows Subsystem for Linux).</p> <p>For the Windows version, you don't technically need to run the BIND installer. It is usually sufficient to simply unzip the archive and either add the folder to your <code>PATH</code> environment variable or specify the full path to <code>nsupdate.exe</code> in the plugin arguments. (Adding the folder to your PATH also gives you easy access to the <code>dig</code> utility which many DNS admins prefer over nslookup)</p> <p>Note</p> <p>Some users have reported needing to install Visual C++ Redistributable libraries in order for the unzip-and-run method to work. Many systems will already have these installed. But if not, among the files unzipped should be a <code>vcredist_x64.exe</code> installer you can use. You can test by running <code>nsupdate -V</code> to check the version.</p>"},{"location":"Plugins/RFC2136/#using-the-plugin","title":"Using the Plugin","text":"<p>When using unauthenticated updates, there are no required parameters as long as the nameserver in the domain's SOA record can directly accept the dynamic updates. You can optionally supply <code>DDNSNameserver</code> to override the value in returned in the SOA record. There is also a <code>DDNSPort</code> parameter if your nameserver is not listening on the standard port 53, but the parameter is ignored unless <code>DDNSNameserver</code> is also supplied.</p> <p>When using TSIG authenticated updates, in addition to the previous parameters you must also supply <code>DDNSKeyName</code>, <code>DDNSKeyType</code>, and <code>DDNSKeyValue</code> which is a SecureString object.</p> <p>Warning</p> <p>The <code>DDNSKeyValueInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <p>If the <code>nsupdate</code> utility is not in your PATH environment variable, you must also supply the full path to it using the <code>DDNSExePath</code> parameter.</p> <p>There is an optional <code>DDNSZone</code> parameter which allows you to specify the zone(s) the records will be added to. But this shouldn't normally be necessary. See issue #307 for more info.</p> <p>Here are a few examples using different combinations of parameters.</p>"},{"location":"Plugins/RFC2136/#tsig-and-explicit-nsupdate-path","title":"TSIG and explicit nsupdate path","text":"<pre><code>$pArgs = @{\n    DDNSKeyName = 'mykey'\n    DDNSKeyType = 'hmac-sha256'\n    DDNSKeyValue = (Read-Host 'TSIG Key Value' -AsSecureString)\n    DDNSExePath = 'C:\\BIND\\nsupdate.exe'\n}\nNew-PACertificate example.com -Plugin RFC2136 -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/RFC2136/#unauthenticated-with-nsupdate-in-path-and-alternate-port","title":"Unauthenticated with nsupdate in PATH and alternate port","text":"<pre><code>$pArgs = @{\n    DDNSNameserver = 'ns.example.com'\n    DDNSPort = 54\n}\nNew-PACertificate example.com -Plugin RFC2136 -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Rackspace/","title":"How To Use the Rackspace DNS Plugin","text":"<p>This plugin works against the Rackspace Cloud DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/Rackspace/#setup","title":"Setup","text":"<p>First, go to the Profile page for your account and record the <code>Rackspace API Key</code> value from the Security section. You'll also need your account username.</p>"},{"location":"Plugins/Rackspace/#using-the-plugin","title":"Using the Plugin","text":"<p>Your account username is used with the <code>RSUsername</code> paraemter. The API key is used with the <code>RSApiKey</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>RSApiKeyInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    RSUsername = 'myusername'\n    RSApiKey = (Read-Host \"API Key\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Rackspace -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Regru/","title":"How To Use the Reg.ru Plugin","text":"<p>This plugin works against the Reg.ru and Reg.com provider. It is assumed that you have already setup an account and registered the domain you will be working against.</p>"},{"location":"Plugins/Regru/#setup","title":"Setup","text":"<p>API Access is not allowed without adding your client machine's IP or subnet to a whitelist. You may also set a separate API password that is different than your primary account password. But it is not required. Both settings are configured from the API Settings page.</p> <ul> <li>Reg.ru API Settings</li> <li>Reg.com API Settings</li> </ul>"},{"location":"Plugins/Regru/#using-the-plugin","title":"Using the Plugin","text":"<p>Your account username and either the account password or API password are used with the <code>RegRuCredential</code> parameter as a PSCredential object. It has been reported that the typical DNS propagation time for this provider is close to 1 hour. So be sure to set the DNSSleep parameter longer than 3600.</p> <p>Warning</p> <p>The <code>RegRuLogin</code> and <code>RegRuPwdInsecure</code> parameters are deprecated and will be removed in the next major module version. If you are using them, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    RegRuCredential = (Get-Credential)\n}\nNew-PACertificate example.com -Plugin Regru -PluginArgs $pArgs -DNSSleep 4000\n</code></pre>"},{"location":"Plugins/Route53/","title":"How To Use the Route53 DNS Plugin","text":"<p>This plugin works against the AWS Route53 DNS provider. It is assumed that you already have an AWS account with at least one DNS zone. The setup portion of this guide also assumes you have access to create IAM users/roles. If you have been given access credentials by your AWS admin, you may need the admin to create the IAM policies necessary for you to edit the zone TXT records.</p> <p>Note</p> <p>You may use this plugin without the AWS PowerShell module installed unless you use the profile name authentication method. In that case, you will either need the Aws.Tools.Route53 or the older AWSPowerShell or AWSPowerShell.NetCore module depending on your environment. More details can be found in the AWS PowerShell documentation.</p>"},{"location":"Plugins/Route53/#setup","title":"Setup","text":"<p>There are generally two different ways to use this plugin depending on whether you are running it from outside AWS or inside from something like an EC2 instance. When outside, you need to specify explicit credentials for an IAM account that has permissions to modify a zone. When inside, you may instead choose to authenticate using an IAM Role. When using explicit credentials, a personal high-level account will work, but it's a better idea to create a dedicated user with the minimum necessary privileges to create the TXT records necessary for ACME challenges.</p> <p>If you already have your policies, users, groups, and roles setup, skip the rest of this section. Otherwise, read on for examples.</p> <p>Note</p> <p>These examples require either the AWS.Tools.IdentityManagement module or the older AWSPowerShell or AWSPowerShell.NetCore module depending on your environment.</p>"},{"location":"Plugins/Route53/#setup-admin-credentials","title":"Setup Admin Credentials","text":"<p>You'll need to create an Access key and associated secret for your account to use with the AWS module. Once you have those, use the following commands to save them to a local profile and set it as the default credential. If you have previously configured your AWS credentials into a profile via <code>Set-AWSCredentials</code>, skip that command below and replace references to the profile name in the <code>Initialize-AWSDefaultConfiguration</code> command with your own.</p> <pre><code>Set-AWSCredential -StoreAs 'dnsadmin' -AccessKey 'xxxxxxxx' -SecretKey 'xxxxxxxx'\nInitialize-AWSDefaultConfiguration -ProfileName 'dnsadmin'\n</code></pre>"},{"location":"Plugins/Route53/#create-iam-policy","title":"Create IAM Policy","text":"<p>Create the policy that allows modifications to hosted zones.</p> <pre><code>$policyDef = @{\n    Version='2012-10-17';\n    Statement=@(\n        @{\n            Effect='Allow';\n            Action=@('route53:ListHostedZones');\n            Resource='*';\n        },\n        @{\n            Effect='Allow';\n            Action=@(\n                'route53:GetHostedZone',\n                'route53:ListResourceRecordSets',\n                'route53:ChangeResourceRecordSets'\n            );\n            Resource='arn:aws:route53:::hostedzone/*';\n        }\n    )\n} | ConvertTo-Json -Depth 5; $policyDef\n\n$policy = New-IAMPolicy \"R53_Zone_Editor\" -PolicyDocument $policyDef -Description \"Allow write access to hosted zones.\"\n</code></pre>"},{"location":"Plugins/Route53/#if-using-explicit-credentials","title":"If Using Explicit Credentials","text":""},{"location":"Plugins/Route53/#create-iam-group-and-associate-to-policy","title":"Create IAM Group and Associate to Policy","text":"<p>Rather than associating the policy to a service account directly, it is wise to associate it to a group instead. That way you can easily add or replace additional users later as necessary.</p> <pre><code>$group = New-IAMGroup -GroupName 'HostedZoneEditors'\nRegister-IAMGroupPolicy $group.GroupName $policy.Arn\n</code></pre>"},{"location":"Plugins/Route53/#create-iam-user-and-add-to-group","title":"Create IAM User and Add to Group","text":"<p>Finally, we'll create the service account and add it to the group we created. We'll also create the access key to use with the plugin.</p> <pre><code>$user = New-IAMUser -UserName 'posh-acme'\nAdd-IAMUserToGroup $group.GroupName $user.UserName\n$key = New-IAMAccessKey $user.UserName\n$key\n</code></pre> <p>The <code>$key</code> variable output should contains <code>AccessKeyId</code> and <code>SecretAccessKey</code> which are what you ultimately use with the plugin.</p>"},{"location":"Plugins/Route53/#if-using-iam-role","title":"If Using IAM Role","text":""},{"location":"Plugins/Route53/#create-iam-role-and-associate-to-policy","title":"Create IAM Role and Associate to Policy","text":"<p>If your server that is using Posh-ACME lives within AWS (such as an EC2 instance), you can create an IAM Role and associate it to the instance which then avoids the need to use and store explicit credential for Route53. Here's how you might create the role and associate it with the policy created earlier.</p> <pre><code>$roleTrust = @{\n    Version='2012-10-17'\n    Statement=@(\n        @{\n            Effect='Allow'\n            Action='sts:AssumeRole'\n            Principal=@{\n                Service='ec2.amazonaws.com'\n            }\n        }\n    )\n} | ConvertTo-Json -Depth 5; $roleTrust\n\n$role = New-IAMRole -RoleName 'R53_Zone_Editor_Role' -AssumeRolePolicyDocument $roleTrust -Description 'Allows associated EC2 instances to modify Route53 zones for certificate validation purposes.'\n\nRegister-IAMRolePolicy $role.RoleName $policy.Arn\n</code></pre> <p>Now you'd need to attach the role with your EC2 instance or launch a new instance with the role pre-attached. More details on that can be found here.</p>"},{"location":"Plugins/Route53/#using-the-plugin","title":"Using the Plugin","text":"<p>If you are using explicit credentials, you may send them directly to the plugin via <code>R53AccessKey</code> and <code>R53SecretKey</code> parameters. A SecureString value is required for <code>R53SecretKey</code>. If you lost the keys, you can re-generate them from the AWS IAM console. But there's no way to retrieve an existing secret key value.</p> <p>Warning</p> <p>The <code>R53SecretKeyInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p>"},{"location":"Plugins/Route53/#explicit-credentials","title":"Explicit Credentials","text":"<pre><code>$pArgs = @{\n    R53AccessKey = 'xxxxxxxx'\n    R53SecretKey = (Read-Host \"Secret Key\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Route53 -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Route53/#aws-powershell-module-profile","title":"AWS Powershell Module Profile","text":"<p>You may also use the <code>R53ProfileName</code> parameter to specify the profile name of an existing credential stored with <code>Set-AwsCredential</code> from an AWS powershell module. Remember that the module must remain installed for renewals when using this method.</p> <pre><code># store the access/secret key in a profile called 'poshacme'\nSet-AWSCredential -StoreAs 'poshacme' -AccessKey 'xxxxxxxx' -SecretKey 'yyyyyyyy'\n\n# set the params and generate the cert\n$pArgs = @{R53ProfileName='poshacme'}\nNew-PACertificate example.com -Plugin Route53 -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Route53/#iam-role","title":"IAM Role","text":"<p>When using an IAM Role, the only thing you need to specify is a switch called <code>R53UseIAMRole</code>.</p> <pre><code>New-PACertificate example.com -Plugin Route53 -PluginArgs @{R53UseIAMRole=$true}\n</code></pre>"},{"location":"Plugins/SSHProxy/","title":"How to use the SSHProxy plugin","text":"<p>This plugin works by delegating the update via SSH to another server which is already able to do dynamic updates against your chosen DNS provider(s). It is designed to use SSH keypairs rather than relying on negiotiating username/password authentication so as to allow the SSH server administrator greater control over what can be run on behalf of Posh-ACME.</p>"},{"location":"Plugins/SSHProxy/#setup","title":"Setup","text":""},{"location":"Plugins/SSHProxy/#plugin-dependencies","title":"Plugin dependencies","text":"<p>You will need (Open)SSH client software installed on your Posh-ACME client. On Linux and MacOS, this comes pre-installed. For Windows, the OpenSSH client can be downloaded from Microsoft (https://learn.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse?tabs=gui) or the upstream version from https://github.com/PowerShell/Win32-OpenSSH. Note that PuTTY isn't sufficient, though plink.exe (from the PuTTY suite) would work.</p> <p>You will also need an SSH server where you can install your Posh-ACME public key and run your update script from.</p>"},{"location":"Plugins/SSHProxy/#posh-acme-client-ssh-setup","title":"Posh-ACME Client SSH setup","text":"<p>To allow the Posh-ACME client to connect to your chosen SSH server, you will need to generate an SSH keypair and ensure this on both the Posh-ACME client and the server. The current best-practice recommends ed_25519 keys. To generate these, run the following on your Posh-ACME client device.</p> <pre><code>ssh-keygen -q -N '' -t ed25519 -f $HOME/poshacme\n</code></pre> <p>This will create two files in your home directory</p> <ul> <li>poshacme - your private key</li> <li>poshacme.pub - your public key</li> </ul> <p>You will need to reference the first in your Posh-ACME SSHProxy configuration and use the contents of second on the SSH server.</p> <p>(thoughout this document, i'll be using $HOME/poshacme - you can replace this with a filename of your choosing).</p>"},{"location":"Plugins/SSHProxy/#ssh-proxy-server-setup","title":"SSH (proxy) server setup","text":"<p>On the SSH server, for the account chosen to proxy your Posh-ACME DNS updates, edit the users' $HOME/.ssh/authorized_keys file and add (all one line) </p> <pre><code>from=\"1.2.3.4\",restrict,command=\"/usr/local/bin/dnsupdate\" &lt;contents of generated poshacme.pub file&gt;\n</code></pre> <p>replacing 1.2.3.4 with the IP address of the Posh-ACME device and /usr/local/bin/dnsupdate with the name of the script that will run your DDNS update and append the contents of the poshacme.pub file generated earlier by ssh-keygen.</p> <p>Whilst it is beyond the scope of this guide to explain how to configure the actual DDNS update that will be undertaken on your behalf by the SSH server, The following example using nsupdate should suffice.</p> <p>Example /usr/local/bin/dnsupdate command</p> <pre><code>#!/bin/bash\n\n# grab args given to when connecting\nset -- $SSH_ORIGINAL_COMMAND\n\n# belt and braces validatation\nif [ \"$#\" -ne 3 ]; then\n    echo \"usage: $0 [add|delete] _acme-challenge.some.name token\"\n    exit 1\nfi\n\nif [ \"$1\" = \"add\" ]; then\n    :\nelif [ \"$1\" = \"delete\" ]; then\n    :\nelse\n    echo \"usage: $0 [add|delete] _acme-challenge.some.name token\"\nfi\n\n# in particular, we want $2 to start _acme-challenge - we could do more\n# fancy validation if wanted.\n\nif ! [[ \"$2\" =~ ^_acme-challenge.* ]]; then\n    echo \"usage: $0 [add|delete] _acme-challenge.some.name token\"\n    exit 1\nfi\n\n# do the update\nprintf \"update $1 $2. 60 TXT $3\\nsend\\n\" | nsupdate -y all:myupdatekey\n</code></pre> <p>It should also be noted that this isn't restricted to SSH connections to a Linux server. This will work against any OpenSSH server running on Linux, Windows or Mac.</p>"},{"location":"Plugins/SSHProxy/#using-the-plugin","title":"Using the Plugin","text":"<p>For most, using the following should suffice:</p> <pre><code>$pArgs=@{\n    SSHServer = \"ssh.example.com\"\n    SSHUser = \"nsupdate\" \n    SSHIdentityFile = \"$HOME/poshacme\"\n}\nPublish-Challenge example.com -Plugin SSHProxy -PluginArgs $pArgs\n</code></pre> <p>Additionally, you can specify <code>SSHConfigFile</code> if you need specify an alternative to the default ssh configuration file. You'll know if you need to do this as you will be doing other fancy SSH things from your Posh-ACME client! Similarly, you can specify <code>SSHRemoteCommand</code> if your SSH server config isn't using a forced command - this is considerably less secure...</p>"},{"location":"Plugins/Selectel/","title":"How To Use the Selectel DNS Plugin","text":"<p>This plugin works against the Selectel provider. It is assumed that you have already setup an account and delegated the domain you will be working against.</p>"},{"location":"Plugins/Selectel/#setup","title":"Setup","text":"<p>If you haven't done it already, generate API key and record it for later.</p>"},{"location":"Plugins/Selectel/#using-the-plugin","title":"Using the Plugin","text":"<p>The API Key is used with the <code>SelectelAdminToken</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>SelectelAdminTokenInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    SelectelAdminToken = (Read-Host 'API key' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Selectel -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/SimpleDNSPlus/","title":"How To Use the Simple DNS Plus Plugin","text":"<p>This plugin works with Simple DNS Plus which is a self-hosted DNS server for Windows. It is assumed you have already setup your server(s) and are properly serving the necessary Internet facing DNS zones for the certificates you will request.</p>"},{"location":"Plugins/SimpleDNSPlus/#setup","title":"Setup","text":"<p>Enable the HTTP API in the server options dialog</p> <ul> <li>In the main window</li> <li>Click <code>Tools</code></li> <li>Click <code>Options</code></li> <li>On the left, Scroll down and click <code>HTTP API</code></li> <li>Make sure <code>Enable HTTP API</code> is checked</li> <li>Leave the URL prefix as default or set a custom one (e.g. https://dns.example.com:443/api).</li> <li>If you use HTTPS for the URL prefix, make sure to follow this guide to setup the certificate properly: How to bind an SSL certificate to the HTTP API</li> <li>Select your desired Authentication method.</li> <li>Anonymous is supported, but not recommended from a security standpoint.</li> <li>Basic is recommended and fully supported on all platforms. It is highly recommended to configure HTTPS when using Basic authentication. You can either use embedded credentials or Windows account credentials.</li> <li>Digest authentication is not officially supported, but can work in some environments.</li> <li>NTLM\\Kerberos is not officially supported, but can work in some environments.</li> <li>Make a note of the credentials for later.</li> <li>The CORS setting is irrelevant for using the plugin. But enabling it can be useful for general HTTP API testing.</li> <li>You don't need to enable the HTTP API v.1 check box. But if you do, remember to add a <code>/v2</code> to your <code>SdnsApiRoot</code> property later.</li> <li>Click <code>OK</code></li> </ul>"},{"location":"Plugins/SimpleDNSPlus/#using-the-plugin","title":"Using the Plugin","text":"<p>The primary parameter you need with this plugin is <code>SdnsApiRoot</code> which is the root URL for the HTTP API such as <code>http://dns.example.com:8053</code>. Remember to add a <code>/v2</code> if you enabled the API v.1 check box. If you're using HTTPS and a self-signed certificate, you'll also need to add the <code>SdnsIgnoreCert</code> parameter.</p> <p>If you're not using anonymous authentication, you'll also need to specify credentials as a PSCredential object with <code>SdnsCred</code>.</p> <p>Warning</p> <p>The <code>SdnsUser</code> and <code>SdnsPassword</code> parameters are deprecated and will be removed in the next major module version. If you are using them, please migrate to the Secure parameter set.</p>"},{"location":"Plugins/SimpleDNSPlus/#anonymous-authentication","title":"Anonymous Authentication","text":"<pre><code>$pArgs = @{\n    SdnsApiRoot = 'http://dns.example.com:8053'\n    SdnsIgnoreCert = $true\n}\nNew-PACertificate example.com -Plugin SimpleDNSPlus -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/SimpleDNSPlus/#credential-authentication","title":"Credential Authentication","text":"<pre><code>$pArgs = @{\n    SdnsApiRoot = 'http://dns.example.com:8053'\n    SdnsIgnoreCert = $true\n    SdnsCred = (Get-Credential)\n}\nNew-PACertificate example.com -Plugin SimpleDNSPlus -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Simply/","title":"How To Use the Simply.com DNS Plugin","text":"<p>This plugin works against the Simply.com DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p> <p>Warning</p> <p>The provider has requested this plugin be renamed to <code>SimplyCom</code>. So a clone was created called <code>SimplyCom</code> that should be used instead. This version will be removed from the module in the next major release of the module.</p>"},{"location":"Plugins/Simply/#setup","title":"Setup","text":"<p>Using the Simply.com API requires only your account name or account number and API Key which can be found in your Control Panel on the Account page.</p>"},{"location":"Plugins/Simply/#using-the-plugin","title":"Using the Plugin","text":"<p>Your account name/number is used with the <code>SimplyAccount</code> parameter. The API key is used with the <code>SimplyAPIKey</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>SimplyAPIKeyInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    SimplyAccount = 'S123456'\n    SimplyAPIKey = (Read-Host 'Enter Key' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Simply -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/SimplyCom/","title":"How To Use the Simply.com DNS Plugin","text":"<p>This plugin works against the Simply.com DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/SimplyCom/#setup","title":"Setup","text":"<p>Using the Simply.com API requires only your account name or account number and API Key which can be found in your Control Panel on the Account page.</p>"},{"location":"Plugins/SimplyCom/#using-the-plugin","title":"Using the Plugin","text":"<p>Your account name/number is used with the <code>SimplyAccount</code> parameter. The API key is used with the <code>SimplyAPIKey</code> SecureString parameter.</p> <p>Warning</p> <p>The <code>SimplyAPIKeyInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    SimplyAccount = 'S123456'\n    SimplyAPIKey = (Read-Host 'Enter Key' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Simply -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/TencentDNS/","title":"How To Use the TencentDNS Plugin","text":"<p>This plugin works against DNSPod which is now part of the Tencent Cloud using their v3 API. It is assumed that you have already setup an account and created the domain you will be working against.</p>"},{"location":"Plugins/TencentDNS/#setup","title":"Setup","text":"<p>This plugin works with Tencent Cloud API Keys which is a change from the old DNSPod native plugin that used DNSPod Tokens. Despite what the console says, you cannot use old DNSPod Tokens with this plugin. You will need to generate a new Tencent Cloud API Key if you haven't already.</p> <p>Login to the console and go to the Tencent Cloud API Keys section. Create a new key and make a note of its ID and Secret values.</p>"},{"location":"Plugins/TencentDNS/#using-the-plugin","title":"Using the Plugin","text":"<p>The Secret ID is used with the <code>TencentKeyId</code> string parameter. The Secret value is used with <code>TencentSecret</code> as a SecureString.</p> <pre><code>$pArgs = @{\n    TencentKeyId = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'\n    TencentSecret = (Read-Host 'Enter Secret' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin TencentDNS -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/TotalUptime/","title":"How To Use the TotalUptime Cloud DNS Plugin","text":"<p>This plugin works against the TotalUptime Cloud DNS Service. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/TotalUptime/#setup","title":"Setup","text":"<p>In order to use the TotalUptime Cloud DNS Plugin you will need an to create an API Account with a Role permitting access to DNS</p>"},{"location":"Plugins/TotalUptime/#create-role","title":"Create role","text":"<ul> <li>In account settings go to the <code>Roles &amp; Security</code> tab</li> <li>Add a role with <code>DNS</code> Enabled, <code>DNS/Information</code> Read, and <code>DNS/Domains</code> Full</li> </ul> <p>For further information refer to the documentation at: Add a Role</p>"},{"location":"Plugins/TotalUptime/#create-api-account","title":"Create API Account","text":"<ul> <li>In account settings go to the <code>Users</code> tab</li> <li>Add a User checking the <code>API Account</code> box with the role you created earlier</li> </ul> <p>For further information refer to the documentation at: Add a User</p>"},{"location":"Plugins/TotalUptime/#using-the-plugin","title":"Using the Plugin","text":"<p>You will need to specify the API account username and password in a PSCredentials object in <code>TotalUptimeCredential</code></p> <pre><code>$pArgs = @{\n    TotalUptimeCredential = (Get-Credential)\n}\nNew-PACertificate example.com -Plugin TotalUptime -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/UKFast/","title":"How To Use the UKFast SafeDNS Plugin","text":"<p>This plugin works against the UKFast provider. It is assumed that you have already setup an account and created the zone in SafeDNS you will be working against.</p>"},{"location":"Plugins/UKFast/#setup","title":"Setup","text":"<p>Authentication against the UKFast SafeDNS API requires an <code>API Application Key</code>, which can be obtained from the API Applications portal. Additionally the key must be given <code>READ/WRITE</code> permission for the SafeDNS service.</p> <p>For further documentation on working with API keys, please visit the UKFast Developer Centre.</p>"},{"location":"Plugins/UKFast/#using-the-plugin","title":"Using the Plugin","text":"<p>The API key will be used with the <code>UKFastApiKey</code> SecureString parameter.</p> <pre><code>$pArgs = @{\n    UKFastApiKey = (Read-Host \"Enter API Key\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin UKFast -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/WEDOS/","title":"How To Use the WEDOS DNS Plugin","text":"<p>This plugin works against the WEDOS DNS provider. It is assumed that you have already setup an account and added or registered the DNS domain(s) you will be working against.</p>"},{"location":"Plugins/WEDOS/#setup","title":"Setup","text":"<p>The WAPI (Web API) needs to be explicitly enabled on your account before you can use it. If you haven't already, follow the instructions here.</p> <p>First it will have you agree to the ToS. Then double check that the IP address you will be connecting from is in the <code>Allowed IP addresses</code> field and the preferred protocol is <code>JSON</code>. You'll also need to set a password specifically for API access (which should be different than your primary account password).</p>"},{"location":"Plugins/WEDOS/#using-the-plugin","title":"Using the Plugin","text":"<p>You will need to provide your account username/email and API password as a PSCredential object to the <code>WedosCredential</code> plugin parameter.</p> <p>Warning</p> <p>WEDOS seems to have an unusually long propagation time between when your DNS changes are committed and when they are reflected on their authoritative nameservers. The GUI warns that changes could take up to 60 minutes. But testing has show the average time is around 4-8 minutes. Be sure to use the <code>-DnsSleep</code> parameter with an appropriately long timeout to avoid validation failures.</p> <pre><code>$pArgs = @{\n    WedosCredential = (Get-Credential)\n}\nNew-PACertificate example.com -Plugin WEDOS -PluginArgs $pArgs -DnsSleep 600\n</code></pre>"},{"location":"Plugins/WebRoot/","title":"How To Use the WebRoot Plugin","text":"<p>This is an HTTP challenge plugin that works by writing challenge files to the local filesystem or a network share. It is generally used when you have an existing web server hosting the content for your domain and you would prefer not to stop it during the certificate issuance process.</p>"},{"location":"Plugins/WebRoot/#setup","title":"Setup","text":"<p>The ACME server will be validating challenges using a standard HTTP GET query on port 80 to <code>http://&lt;domain&gt;/.well-known/acme-challenge/&lt;token&gt;</code>. You will need to know the filesystem path to the root folder that corresponds to your site. For example, the <code>Default Web Site</code> in IIS has its web root located at <code>C:\\inetpub\\wwwroot</code>. </p> <p>By default, the plugin will write the challenge files to <code>\\.well-known\\acme-challenge\\</code> off of the specified root folder. But in some cases, you may have the <code>http://&lt;domain&gt;/.well-known/acme-challenge/</code> URL mapped to a specific location on the filesystem and don't want the plugin to add the <code>\\.well-known\\acme-challenge</code> sub-folders. There is a switch described in the next section that will prevent those sub-folders from being created in the specified web root.</p> <p>If you are using a network share as the web root, make sure PowerShell is running as a user with permissions to write to that share. There is currently no way to specify explicit credentials.</p>"},{"location":"Plugins/WebRoot/#using-the-plugin","title":"Using the Plugin","text":"<p>The web root is specified using the <code>WRPath</code> parameter. If you don't want the plugin to put the files in a <code>\\.well-known\\acme-challenge</code> sub-folder, you must also specify <code>WRExactPath = $true</code> in your plugin args.</p> <p>Note</p> <p><code>WRPath</code> can be set to an array of paths instead of just one. This can be useful with multiple web servers running behind a load balancer.</p>"},{"location":"Plugins/WebRoot/#default-functionality","title":"Default functionality","text":"<pre><code>$pArgs = @{\n    WRPath = 'C:\\inetpub\\wwwroot'\n}\nNew-PACertificate example.com -Plugin WebRoot -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/WebRoot/#no-sub-folder-example","title":"No sub-folder example","text":"<pre><code>$pArgs = @{\n    WRPath = 'C:\\inetpub\\wwwroot\\.well-known\\acme-challenge'\n    WRExactPath = $true\n}\nNew-PACertificate example.com -Plugin WebRoot -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/WebSelfHost/","title":"How To Use the WebSelfHost Plugin","text":"<p>This is an HTTP challenge plugin that works by temporarily running an HTTP listener to directly respond to challenge requests from the ACME server. It is commonly used when your certificate will not be used with an existing web server or the server is not listening on port 80. It can also be used with an existing web server if you are willing to temporarily stop the server during the certificate issuance process, but this requires additional scripting. The plugin will not automatically stop and restart the other web server.</p>"},{"location":"Plugins/WebSelfHost/#setup","title":"Setup","text":""},{"location":"Plugins/WebSelfHost/#windows-only-prerequisites","title":"Windows Only Prerequisites","text":"<p>When running on Windows, the HttpListener class depends on a kernel mode web server called http.sys. Because it's a system-level service, non-administrator users can't use it without an explicit URL reservation that gives them permission. Open an elevated PowerShell session and run the following to see the current list of URL reservations.</p> <pre><code>netsh http show urlacl\n</code></pre> <p>Modern Windows versions will have a bunch of these even in a default install for various system components and services. We need to add one that matches what the plugin will be trying to use. By default, it will use <code>http://+:80/.well-known/acme-challenge/</code>. The easiest thing to do is create the reservation and give permissions to \"Everyone\". It's perfectly reasonable to only grant permissions to the user or group who will need it as well. But you will need to adjust the command line appropriately with the target user/group instead of an sddl string.</p> <pre><code>netsh http add urlacl url=http://+:80/.well-known/acme-challenge/ sddl=D:(A;;GX;;;S-1-1-0)\n</code></pre> <p>If you will be running the listener on an alternate port, make sure your reservation also uses the alternate port. Also keep in mind that the ACME validation server will always request challenges on port 80. So if you're using an alternate port, make sure there's an appropriate port forward if it's behind NAT or an HTTP redirect if another server is in front of it.</p>"},{"location":"Plugins/WebSelfHost/#additional-considerations","title":"Additional Considerations","text":"<p>Regardless of the underlying OS, you need to make sure the listener won't conflict with other software running on the system. If port 80 is in use, you will need to run the listener on an alternate port. But keep in mind, the ACME challenge validations must be served from port 80 on the internet-facing side of things. Often, there will be port forwarding or a reverse proxy in place that maps the internet-facing port 80 to an internal alternate port.</p>"},{"location":"Plugins/WebSelfHost/#using-the-plugin","title":"Using the Plugin","text":"<p>No plugin args are required if you will be using the default port 80 and 120 second timeout. Otherwise, you may use <code>WSHPort</code> and <code>WSHTimeout</code> respectively.</p> <p>There is also a <code>WSHDelayAfterStart</code> arg that can be used to add a delay between when the listener starts and when the plugin returns control to the module to validate the challenges. This can be useful if it seems like the listener isn't starting up fast enough to answer the challenge requests.</p>"},{"location":"Plugins/WebSelfHost/#default-functionality","title":"Default functionality","text":"<pre><code>New-PACertificate example.com -Plugin WebSelfHost -PluginArgs @{}\n</code></pre>"},{"location":"Plugins/WebSelfHost/#non-standard-port","title":"Non-standard port","text":"<pre><code>$pArgs = @{\n    WSHPort = 8000\n}\nNew-PACertificate example.com -Plugin WebSelfHost -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/WebsupportSK/","title":"How To Use the WebsupportSK DNS Plugin","text":"<p>This plugin works against the Websupport.sk provider. Former users of Active24 may have been migrated to this provider for DNS API purposes. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/WebsupportSK/#setup","title":"Setup","text":"<p>Login to the web portal and go to the <code>Security and login</code> portion of your Personal settings. Near the bottom, there should be an <code>API Authentication</code> section.</p> <ul> <li>Click <code>Generate new API access</code></li> <li>Type: Standard</li> </ul> <p>Record the Identifier and Secret values for the generated key.</p>"},{"location":"Plugins/WebsupportSK/#using-the-plugin","title":"Using the Plugin","text":"<p>The API Identifier and Secret values will be used as the username and password in a PSCredential object called <code>WskCredential</code>.</p> <p>Warning</p> <p>Websupport.sk advertises that DNS changes take 5 minutes apply to all nameservers. When using the plugin, you should override the default sleep value with <code>-DnsSleep 300</code> or more.</p> <pre><code>$pArgs = @{\n    WskCredential = Get-Credential\n}\nNew-PACertificate example.com -Plugin WebsupportSk -PluginArgs $pArgs -DnsSleep 300\n</code></pre>"},{"location":"Plugins/Windows/","title":"How To Use the Windows DNS Plugin","text":"<p>This plugin works against the Microsoft Windows DNS server. It doesn't matter whether it's hosted on-premises or in the cloud, physical or virtual, domain joined or standalone. As long as it can be managed via the standard DnsServer PowerShell module, it should be supported. This does not work against Azure DNS. Use the Azure plugin for that.</p> <p>Warning</p> <p>The DnsServer module is not available on Windows versions prior to Windows 8 and Windows Server 2012. So this plugin will only work on those OSes or newer. Using Zone Scopes requires the Windows 10 or Windows Server 2016 version of the module or newer.</p> <p>Warning</p> <p>This plugin currently does not work on non-Windows OSes in PowerShell Core. On Windows, it requires at least PowerShell 7.</p>"},{"location":"Plugins/Windows/#setup","title":"Setup","text":""},{"location":"Plugins/Windows/#dnsserver-module","title":"DnsServer module","text":"<p>The client machine running Posh-ACME must have the <code>DnsServer</code> PowerShell module installed. On Windows Server OSes, this can be installed from Server Manager or via PowerShell as follows.</p> <pre><code>Install-WindowsFeature RSAT-DNS-Server\n</code></pre> <p>On Windows client OSes, you will need to download and install the appropriate Remote Server Administration Tools (RSAT) for your OS. The installers are historically OS specific. Here are links for Windows 10, Windows 8.1, Windows 8, and Windows 7.</p> <p>Warning</p> <p>The vast majority of testing for this plugin was done on Windows 10 and Windows Server 2016. Please submit issues if you run into problems on downlevel OSes.</p>"},{"location":"Plugins/Windows/#psremoting-and-new-cimsession","title":"PSRemoting and New-CimSession","text":"<p>The DnsServer module relies on PowerShell remoting via <code>New-CimSession</code> to establish a remote connection to the DNS server. Depending on your environment, PSRemoting might already be enabled. If not, you need to make sure it is working between your client and DNS server before trying to use Posh-ACME.</p> <p>Typically, the easiest environment to get things working has both client and server domain joined to the same Active Directory or different domains where the client's domain credentials are trusted by the server's AD. In this case, you can try the following to test from the client machine.</p> <pre><code># test in the context of the current process (current user)\n$cs = New-CimSession -ComputerName dnsserver.example.com\n\n# test in the context of a different user\n$cs = New-CimSession -ComputerName dnsserver.example.com -Credential (Get-Credential)\n</code></pre> <p>In environments where one or both of the client and server are not domain joined, you may need to explicitly connect via HTTPS. This may involve extra steps during setup to enable an HTTPS listener on the server. Here is a decent guide on getting things setup with a self-signed certificate, though a trusted certificate would work as well. And here is how to test from the client machine.</p> <pre><code>$so = New-CimSessionOption -UseSsl\n$cs = New-CimSession -ComputerName dnsserver.example.com -Credential (Get-Credential) -SessionOptions $so\n</code></pre> <p>Do not proceed until you can successfully establish a CimSession from the client to the DNS server.</p>"},{"location":"Plugins/Windows/#permissions","title":"Permissions","text":"<p>Setting permissions on Windows DNS depends on whether the DNS zones are integrated with Active Directory or not. Standalone non-domain joined DNS servers don't really have granular permissions as far as I can tell. The user must be local administrator. AD integrated servers can usually set more granular permissions on a per-zone level or better. Suffice it to say, the account being used to connect must have adequate permissions to add and delete TXT records in the associated zone(s).</p>"},{"location":"Plugins/Windows/#using-the-plugin","title":"Using the Plugin","text":"<p>In a domain joined environment, the only required parameter is the hostname or IP of the DNS server unless you want the module to use different credentials than what PowerShell is running as. In that case, you would specify credentials and optionally the <code>-WinUseSSL</code> switch. Both of those tend to be required for non-domain joined servers.</p> <pre><code># domain joined environment, no credentials or SSL needed\nNew-PACertificate example.com -Plugin Windows -PluginArgs @{WinServer='dns1.example.com'}\n\n# standalone environment, adding credentials and SSL flag\n$pArgs = @{\n    WinServer = 'dns1.example.com'\n    WinCred = (Get-Credential)\n    WinUseSSL=$true\n}\nNew-PACertificate example.com -Plugin Windows -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Windows/#advanced-features","title":"Advanced Features","text":"<p>Zone Scopes were added in the Windows Server 2016 version of the DNS server and are now supported in the plugin with the <code>WinZoneScope</code> parameter. This is useful if you have a split-brain DNS setup and your external zone is in the non-default scope. Using the parameter requires that your client be running the Windows 10/2016 version of the DnsServer module.</p> <pre><code># using zone scope in domain joined environment\n$pArgs = @{\n    WinServer = 'dns1.example.com'\n    WinZoneScope = 'external'\n}\nNew-PACertificate example.com -Plugin Windows -PluginArgs $pArgs\n</code></pre> <p>VirtualizationInstances are not currently supported. If you use that features and need it supported, please submit an issue describing your environment.</p>"},{"location":"Plugins/Yandex/","title":"How To Use the Yandex DNS Plugin","text":"<p>This plugin works against the Yandex DNS provider. It is assumed that you have already setup an account and delegated and confirmed the domain you will be working against.</p>"},{"location":"Plugins/Yandex/#setup","title":"Setup","text":"<p>If you haven't done it already, generate an administrator token and record it for later. It is also known as a \"PDD\" admin token.</p>"},{"location":"Plugins/Yandex/#using-the-plugin","title":"Using the Plugin","text":"<p>The PDD admin token is used with the <code>YDAdminToken</code> SecureString parameter. Users have reported DNS replication delays of up to 15 minutes. So you may also have to override the default <code>DNSSleep</code> parameter with something longer like 1000.</p> <p>Warning</p> <p>The <code>YDAdminTokenInsecure</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p> <pre><code>$pArgs = @{\n    YDAdminToken = (Read-Host \"Yandex token\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Yandex -PluginArgs $pArgs -DNSSleep 1000\n</code></pre>"},{"location":"Plugins/Zilore/","title":"How To Use the Zilore DNS Plugin","text":"<p>This plugin works against the Zilore DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p> <p>Note: Zilore does not currently offer API access to free accounts. You must be on a paid plan to use this plugin.</p>"},{"location":"Plugins/Zilore/#setup","title":"Setup","text":"<p>You will need to retrieve your API key from the API Settings page.</p>"},{"location":"Plugins/Zilore/#using-the-plugin","title":"Using the Plugin","text":"<p>The API key is specified using the <code>ZiloreKey</code> parameter which is a SecureString value.</p> <pre><code>$pArgs = @{\n    ZiloreKey = (Read-Host \"API Key\" -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Zilore -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/ZoneEdit/","title":"How To Use the ZoneEdit Plugin","text":"<p>This plugin works against ZoneEdit. You should already have an account and created the DNS zone(s) you will be working against.</p>"},{"location":"Plugins/ZoneEdit/#setup","title":"Setup","text":"<p>The plugin works using a variation on the standard Dynamic DNS service. Each domain you will be using the plugin with must have a Dynamic Authentication Token created for it.</p> <ul> <li>Login to the Domains control panel</li> <li>Open the DNS settings for the domain</li> <li>Click the wrench icon in the <code>DYN records</code> section</li> <li>At the bottom in the <code>dynamic authentication</code> section, click <code>enable</code> if is not already</li> <li>Then click <code>view</code> to view the current token</li> <li>Make a note of the token value and the domain it is associated with.</li> </ul>"},{"location":"Plugins/ZoneEdit/#using-the-plugin","title":"Using the Plugin","text":"<p>You will always provide your account username in the <code>ZEUsername</code> string parameter. If the names in your certificate are all part of the same domain, you will need to provide a PSCredential object to the <code>ZEDynCredential</code> parameter where the domain name is the username and the token is the password.</p> <pre><code>$domainToken = Read-Host 'example.com' -AsSecureString\n\n$pArgs = @{\n    ZEUsername = 'myuser'\n    ZEDynCredential = [pscredential]::new('example.com',$domainToken)\n}\nNew-PACertificate 'example.com','www.example.com' -Plugin ZoneEdit -PluginArgs $pArgs\n</code></pre> <p>If the names in your cert are part of different domains, you'll need to provide an array of PSCredential objects for each domain/token combination that the names cover.</p> <pre><code>$token1 = Read-Host 'example.com' -AsSecureString\n$token2 = Read-Host 'example.net' -AsSecureString\n\n$pArgs = @{\n    ZEUsername = 'myuser'\n    ZEDynCredential = @(\n        [pscredential]::new('example.com',$token1)\n        [pscredential]::new('example.net',$token2)\n    )\n}\nNew-PACertificate 'example.com','example.net' -Plugin ZoneEdit -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Zonomi/","title":"How To Use the Zonomi DNS Plugin","text":"<p>This plugin works against the Zonomi DNS provider. It is assumed that you have already setup an account and created the DNS zone(s) you will be working against.</p> <p>Note</p> <p>The API Zonomi uses is also used by other providers such as RimuHosting. This plugin is compatible with those as well.</p>"},{"location":"Plugins/Zonomi/#setup","title":"Setup","text":"<p>Generate an API key from the API Keys page using the \"DNS\" type. Click the the green plus icon to generate a new key if one is not already displayed.</p> <p>If you use a different compatible provider, there should be an equivalent control panel page for API Keys available.</p>"},{"location":"Plugins/Zonomi/#using-the-plugin","title":"Using the Plugin","text":"<p>The API key is used with the <code>ZonomiKey</code> SecureString parameter. Users on other Zonomi compatible providers will also need to supply the API URL for that provider to the <code>ZonomiApiUrl</code> parameter.</p> <p>Warning</p> <p>The <code>ZonomiApiKey</code> parameter is deprecated and will be removed in the next major module version. If you are using it, please migrate to the Secure parameter set.</p>"},{"location":"Plugins/Zonomi/#using-zonomi","title":"Using Zonomi","text":"<pre><code>$pArgs = @{\n    ZonomiKey = (Read-Host 'API Key' -AsSecureString)\n}\nNew-PACertificate example.com -Plugin Zonomi -PluginArgs $pArgs\n</code></pre>"},{"location":"Plugins/Zonomi/#using-rimuhosting","title":"Using RimuHosting","text":"<pre><code>$pArgs = @{\n    ZonomiKey = (Read-Host 'API Key' -AsSecureString)\n    ZonomiApiUrl = 'https://rimuhosting.com/dns/dyndns.jsp'\n}\nNew-PACertificate example.com -Plugin Zonomi -PluginArgs $pArgs\n</code></pre>"},{"location":"Tutorial/","title":"Tutorial","text":""},{"location":"Tutorial/#picking-a-server","title":"Picking a Server","text":"<p>Before we begin, let's configure our ACME server to be the Let's Encrypt Staging server. This will let us figure out all of the commands and parameters without likely running into the production server's rate limits. </p> <pre><code>Set-PAServer LE_STAGE\n</code></pre> <p>Note</p> <p><code>LE_STAGE</code> is a shortcut for the Let's Encrypt Staging server's directory URL. You could do the same thing by specifying the actual URL which is <code>https://acme-staging-v02.api.letsencrypt.org/directory</code> and this module should work with any ACME compliant directory URL. Other currently supported shortcuts include <code>LE_PROD</code>, <code>BUYPASS_PROD</code>, <code>BUYPASS_TEST</code>, and <code>ZEROSSL_PROD</code>.</p> <p>Once you set a server, the module will continue to perform future actions against that server until you change it with another call to <code>Set-PAServer</code>. The first time you connect to a server, a link to its Terms of Service will be displayed. You should review it before continuing.</p>"},{"location":"Tutorial/#your-first-certificate","title":"Your First Certificate","text":"<p>The bare minimum you need to request a certificate is just the domain name.</p> <pre><code>New-PACertificate example.com\n</code></pre> <p>Since you haven't created an ACME account on this server yet, the command will attempt to create one for you using default settings and you'll get an error about having not agreed to the Terms of Service. Assuming you've reviewed the TOS link from before, add <code>-AcceptTOS</code> to the original command to proceed. You only need to do this once when creating a new account. You also probably want to associate an email address with this account so you can receive certificate expiration notifications. So let's do that even though it's not required.</p> <pre><code>New-PACertificate example.com -AcceptTOS -Contact 'admin@example.com'\n</code></pre> <p>Note</p> <p>Multiple email addresses per account are supported. Just pass it an array of addresses.</p> <p>Because you didn't specify a plugin, it will default to using the <code>Manual</code> DNS plugin. That manual plugin will also be prompting you to create a DNS TXT record to answer the ACME server's validation challenge for the domain.</p> <p>At this point, you can either press <code>Ctrl+C</code> to cancel the process and modify your command or go ahead and create the requested TXT record and hit any key to continue. We'll cover plugins next, so for now create the record manually and press a key to continue. If you run into problems creating the TXT record, check out Troubleshooting DNS Validation.</p> <p>The command will sleep for 2 minutes by default to allow the DNS changes to propagate. Then if the ACME server is able to properly validate the TXT record, the final certificate files are generated and the command should output the details of your new certificate. Only a subset of the details are displayed by default. To see them all, run <code>Get-PACertificate | fl</code>. The files generated in the output folder should contain the following:</p> <ul> <li>cert.cer (Base64 encoded PEM certificate)</li> <li>cert.key (Base64 encoded PEM private key)</li> <li>cert.pfx (PKCS12 container with cert+key)</li> <li>chain.cer (Base64 encoded PEM with the issuing CA chain)</li> <li>chainX.cer (Base64 encoded PEM with alternate issuing CA chains)</li> <li>fullchain.cer (Base64 encoded PEM with cert+chain)</li> <li>fullchain.pfx (PKCS12 container with cert+key+chain)</li> </ul> <p>Posh-ACME is only designed to obtain certificates, not deploy them to your web server or service. The certificate details are written to the pipeline so you can either save them to a variable or pipe the output to another command. Posh-ACME.Deploy is a sister module containing some example deployment functions for common services to get you started. But ultimately, it's up to you how you want to deploy your certificates.</p> <p>The password on the PFX files is <code>poshacme</code> because we didn't override the default with <code>-PfxPass</code> or <code>-PfxPassSecure</code>. If you're running PowerShell with elevated privileges on Windows, you can also add the <code>-Install</code> switch to automatically import the certificate into the local computer's certificate store.</p> <p>So now you have a certificate and that's great! But Let's Encrypt certificates expire relatively quickly (90 days). And you won't be able to renew this certificate without going through the manual DNS TXT record hassle again. So let's add a validation plugin to the process.</p>"},{"location":"Tutorial/#plugins","title":"Plugins","text":"<p>The ACME protocol currently supports three types of challenges to prove you control the domain you're requesting a certificate for: <code>dns-01</code>, <code>http-01</code>, and <code>tls-alpn-01</code>. We are going to focus on <code>dns-01</code> because it is the only one that can be used to request wildcard (*.example.com) certificates and the majority of Posh-ACME plugins are for DNS providers.</p> <p>The ability to use a DNS plugin is going to depend on whether your DNS provider has a supported plugin in the current version of the module. If not, please submit an issue requesting support. If you have PowerShell development skills, you might also try writing a plugin yourself. Instructions can be found in the Plugins README. Pull requests for new plugins are both welcome and appreciated. It's also possible to redirect ACME DNS validations using a CNAME record in your primary zone pointing to another DNS server that is supported. More on that later.</p> <p>The first thing to do is figure out which DNS plugin to use and how to use it. Start by listing the available plugins.</p> <pre><code>Get-PAPlugin\n</code></pre> <p>Most plugins have a detailed usage guide here. In these examples, we'll use the AWS Route53 plugin. Here's a quick shortcut to get to the usage guide. This will open the default browser to the page on Windows and just display the URL on non-Windows.</p> <pre><code>Get-PAPlugin Route53 -Guide\n</code></pre> <p>Using a plugin will almost always require creating a hashtable with required plugin parameters. To see a quick reference of the available parameter sets try this:</p> <pre><code>PS&gt; Get-PAPlugin Route53 -Params\n\n    Set Name: Keys (Default)\n\nParameter    Type         IsMandatory\n---------    ----         -----------\nR53AccessKey String       True\nR53SecretKey SecureString True\n\n    Set Name: KeysInsecure\n\nParameter            Type   IsMandatory\n---------            ----   -----------\nR53AccessKey         String True\nR53SecretKeyInsecure String True\n\n    Set Name: Profile\n\nParameter      Type   IsMandatory\n---------      ----   -----------\nR53ProfileName String True\n\n    Set Name: IAMRole\n\nParameter     Type            IsMandatory\n---------     ----            -----------\nR53UseIAMRole SwitchParameter True\n</code></pre> <p>We can see there are four different parameter sets we can use: <code>Keys</code>, <code>KeysInsecure</code>, <code>Profile</code>, and <code>IAMRole</code>. The <code>Keys</code> set requires <code>R53AccessKey</code> and <code>R53SecretKey</code>. These are API credentials for AWS and presumably as an AWS user, you already know how to generate them. The access key is just a normal String variable. But the secret key is a <code>SecureString</code> which takes a bit more effort to setup. So let's create the hashtable we need.</p> <pre><code>$r53Secret = Read-Host 'Enter Secret' -AsSecureString\n$pArgs = @{R53AccessKey='ABCD1234'; R53SecretKey=$r53Secret}\n</code></pre> <p>This <code>$pArgs</code> variable is what we'll pass to the <code>-PluginArgs</code> parameter on functions that use it.</p> <p>Now we know what plugin we're using and we have our plugin arguments in a hashtable. If this is the first time using a particular plugin, it's usually wise to test it before actually trying to use it for a new certificate. So let's do that. The command has no output unless we add the <code>-Verbose</code> switch to show what's going on under the hood.</p> <pre><code># get a reference to the current account\n$acct = Get-PAAccount\n\nPublish-Challenge example.com -Account $acct -Token faketoken -Plugin Route53 -PluginArgs $pArgs -Verbose\n</code></pre> <p>Assuming there was no error, you should be able to validate that the TXT record was created in the Route53 management console. If so, go ahead and unpublish the record. Otherwise, troubleshoot why it failed and get it working before moving on.</p> <pre><code>Unpublish-Challenge example.com -Account $acct -Token faketoken -Plugin Route53 -PluginArgs $pArgs -Verbose\n</code></pre> <p>All we have left to do is add the necessary plugin parameters to our original certificate request command. But let's get crazy and change it up a bit by making the cert a wildcard cert with the root domain as a subject alternative name (SAN).</p> <pre><code>New-PACertificate '*.example.com','example.com' -AcceptTOS -Contact 'admin@example.com' -Plugin Route53 `\n    -PluginArgs $pArgs -Verbose\n</code></pre> <p>Warning</p> <p>According to current Let's Encrypt rate limits, a single certificate can have up to 100 names. The only caveat is that wildcard certs may not contain any SANs that would overlap with the wildcard entry. So you'll get an error if you try to put <code>*.example.com</code> and <code>www.example.com</code> in the same cert. But <code>*.example.com</code> and <code>example.com</code> or <code>www.sub.example.com</code> are just fine.</p> <p>We included the <code>-Verbose</code> switch again so we can see what's going on. But normally, that wouldn't be necessary. Assuming everything went well, you should now have a fresh new wildcard cert that required no user interaction. Keep in mind, HTTP plugins work the exactly the same way as DNS plugins. They just can't be used to validate wildcard names in certs from Let's Encrypt.</p>"},{"location":"Tutorial/#renewals-and-deployment","title":"Renewals and Deployment","text":"<p>Now that you have a cert order that can successfully answer DNS challenges via a plugin, it's even easier to renew it.</p> <pre><code>Submit-Renewal\n</code></pre> <p>Note</p> <p>Be aware that renewals don\u2019t count against your Certificates per Registered Domain limit, but they are subject to a Duplicate Certificate limit of 5 per week.</p> <p>The module saves all of the parameters associated with an order and re-uses the same values to renew it. It will throw a warning right now because the cert hasn't reached the suggested renewal window. But you can use <code>-Force</code> to do it anyway if you want to try it. Let's Encrypt currently caches authorizations for roughly 30 days, so the forced renewal won't need to go through validating the challenges again. But you can de-authorize your existing challenges using the following command if you want to test the validation process again.</p> <pre><code>Get-PAOrder | Revoke-PAAuthorization\n</code></pre> <p>If you have multiple orders on an account or even multiple accounts, there are flags to renew all of those as well.</p> <pre><code># renew all orders on the current account\nSubmit-Renewal -AllOrders\n\n# renew all orders across all accounts in the current profile\nSubmit-Renewal -AllAccounts\n</code></pre> <p>Note</p> <p>The <code>-Force</code> parameter works with these as well.</p>"},{"location":"Tutorial/#task-scheduler-cron","title":"Task Scheduler / Cron","text":"<p>Because PowerShell has no native way to run recurring tasks, you'll need to set something up using whatever job scheduling utility your OS provides like Task Scheduler on Windows or cron on Linux. It is suggested to run the job once or twice a day at ideally randomized times. At the very least, try not to run them directly on any hour marks to avoid potential load spikes on the ACME server. Generally, the task must run as the same user you're currently logged in as because the Posh-ACME config is stored in your local user profile. However, it's possible to change the default config location.</p> <p>As mentioned earlier, Posh-ACME doesn't handle certificate deployment. So you'll likely want to create a script to both renew the cert and deploy it to your service/application. All the details you should need to deploy the cert are in the PACertificate object that is returned by <code>Submit-Renewal</code>. It's also the same object returned by <code>New-PACertificate</code> and <code>Get-PACertificate</code>; the latter being useful to test deployment scripts with.</p> <p><code>Submit-Renewal</code> will only return PACertificate objects for certs that were actually renewed successfully. So the typical template for a renew/deploy script might look something like this.</p> <pre><code>Set-PAOrder example.com\nif ($cert = Submit-Renewal) {\n    # do stuff with $cert to deploy it\n}\n</code></pre> <p>For a job that is renewing multiple certificates, it might look more like this.</p> <pre><code>Submit-Renewal -AllOrders | ForEach-Object {\n    $cert = $_\n    if ('example.com' -in $cert.AllSANs) {\n        # deploy for example.com\n    } elseif ('example.net' -in $cert.AllSANs) {\n        # deploy for example.net\n    } else {\n        # deploy for everything else\n    }\n}\n</code></pre>"},{"location":"Tutorial/#updating-plugin-parameters-on-renewal","title":"Updating Plugin Parameters on Renewal","text":"<p>Credentials and Tokens can change over time and some plugins can be used with purposefully short-lived access tokens. In these cases, you can specify the new plugin parameters using the <code>-PluginArgs</code> parameter on either <code>Set-PAOrder</code> or <code>Submit-Renewal</code>. The full set of plugin arguments must be specified.</p> <p>As an example, consider the case for the Azure DNS plugin:</p> <pre><code># renew specifying new plugin arguments\nSubmit-Renewal -PluginArgs @{AZSubscriptionId='mysubscriptionid';AZAccessToken='myaccesstoken'}\n</code></pre>"},{"location":"Tutorial/#going-into-production","title":"Going Into Production","text":"<p>Now that you've got everything working against the Let's Encrypt staging server, all you have to do is switch over to the production server and re-run your <code>New-PACertificate</code> command to get your shiny new publicly trusted certificate.</p> <pre><code>Set-PAServer LE_PROD\n\nNew-PACertificate '*.example.com','example.com' -AcceptTOS -Contact 'admin@example.com' `\n    -Plugin Route53 -PluginArgs $pArgs -Verbose\n</code></pre>"},{"location":"Tutorial/#modifying-certificate-names","title":"Modifying Certificate Names","text":"<p>You may eventually need to add or remove names from your certificate to accommodate changes in the services you're hosting. But certificates can't be modified after they're generated. So you need to request a new certificate with the updated set of names.</p> <p>While you could just re-run your <code>New-PACertificate</code> command with a modified domain list and all the other original parameters and plugin details, that can be a hassle if it has been a while since you originally setup the certificate and don't remember exactly what you ran. However, all you really need is the modified domain list and the order name.</p> <p>Grab the the order details for the order you'll be modifying and create a hashtable for splatting with the <code>Name</code> and <code>Domain</code> parameters.</p> <pre><code>$o = Get-PAOrder -Name example.com\n$newCertParams = @{ Name = $o.Name; Domain = @($o.MainDomain)+@($o.SANs) }\n</code></pre> <p>Now modify the Domain parameter in the hashtable however you need to. Here are a couple examples.</p> <pre><code># add a new name\n$newCertParams.Domain += 'blog.example.com'\n\n# remove an existing name\n$newCertParams.Domain = $newCertParams.Domain | ?{ $_ -ne 'oldsite.example.com' }\n</code></pre> <p>Finally, run <code>New-PACertificate</code> and splat your updated parameters.</p> <pre><code>New-PACertificate @newCertParams -Verbose\n</code></pre> <p>The function should pick up all the old parameters from the previous order (finding it via the <code>Name</code> parameter) and create a new order/cert that overwrites the old one.</p>"}]}